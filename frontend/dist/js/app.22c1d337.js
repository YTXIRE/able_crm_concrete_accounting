(function(e){function t(t){for(var l,r,n=t[0],c=t[1],s=t[2],b=0,u=[];b<n.length;b++)r=n[b],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&u.push(o[r][0]),o[r]=0;for(l in c)Object.prototype.hasOwnProperty.call(c,l)&&(e[l]=c[l]);d&&d(t);while(u.length)u.shift()();return i.push.apply(i,s||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],l=!0,n=1;n<a.length;n++){var c=a[n];0!==o[c]&&(l=!1)}l&&(i.splice(t--,1),e=r(r.s=a[0]))}return e}var l={},o={app:0},i=[];function r(t){if(l[t])return l[t].exports;var a=l[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=l,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)r.d(a,l,function(t){return e[t]}.bind(null,l));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],c=n.push.bind(n);n.push=t,n=n.slice();for(var s=0;s<n.length;s++)t(n[s]);var d=c;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0052":function(e,t,a){"use strict";a("0a5e")},"0277":function(e,t,a){},"0349":function(e,t,a){},"0465":function(e,t,a){},"0896":function(e,t,a){},"0a5e":function(e,t,a){},"0cb0":function(e,t,a){"use strict";a("8192")},"116e":function(e,t,a){},1333:function(e,t,a){},"16fc":function(e,t,a){"use strict";a("7ff6")},"17a3":function(e,t,a){"use strict";a("b633")},1821:function(e,t,a){"use strict";a("914b")},"18e6":function(e,t,a){"use strict";a("4be1")},"19d8":function(e,t,a){},"1ad6":function(e,t,a){"use strict";a("efca")},"1d39":function(e,t,a){"use strict";a("ab11")},"1f7c":function(e,t,a){"use strict";a("c5a0")},"204a":function(e,t,a){},"20fb":function(e,t,a){"use strict";a("fd0e")},"26d6":function(e,t,a){"use strict";a("f1f4")},2859:function(e,t,a){"use strict";a("34f2")},"2da7":function(e,t,a){},"2ea4":function(e,t,a){"use strict";a("bdb4")},"34f2":function(e,t,a){},3752:function(e,t,a){"use strict";a("bda2")},"3a71":function(e,t,a){},"46a3":function(e,t,a){},"4be1":function(e,t,a){},"4c17":function(e,t,a){"use strict";a("d407")},"4c8b":function(e,t,a){"use strict";a("0277")},5190:function(e,t,a){"use strict";a("c47c")},5289:function(e,t,a){"use strict";a("65da")},"56d7":function(e,t,a){"use strict";a.r(t);var l=a("7a23");const o={id:"nav"};function i(e,t,a,i,r,n){const c=Object(l["resolveComponent"])("router-view"),s=Object(l["resolveComponent"])("Wrapper"),d=Object(l["resolveComponent"])("router-link");return Object(l["openBlock"])(),Object(l["createElementBlock"])(l["Fragment"],null,[Object(l["createVNode"])(s,null,{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(c)]),_:1}),Object(l["createElementVNode"])("div",o,[Object(l["createVNode"])(d,{to:"/"}),Object(l["createVNode"])(d,{to:"/dashboard"}),Object(l["createVNode"])(d,{to:"/vendors"}),Object(l["createVNode"])(d,{to:"/payments"}),Object(l["createVNode"])(d,{to:"/settings"}),Object(l["createVNode"])(d,{to:"/user_settings"}),Object(l["createVNode"])(d,{to:"/materials"}),Object(l["createVNode"])(d,{to:"/material_types"}),Object(l["createVNode"])(d,{to:"/legal_entities"}),Object(l["createVNode"])(d,{to:"/history"}),Object(l["createVNode"])(d,{to:"/reports"})])],64)}const r={class:"common-layout"};function n(e,t,a,o,i,n){const c=Object(l["resolveComponent"])("Header"),s=Object(l["resolveComponent"])("el-header"),d=Object(l["resolveComponent"])("Menu"),b=Object(l["resolveComponent"])("el-aside"),u=Object(l["resolveComponent"])("Main"),m=Object(l["resolveComponent"])("el-container");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",r,[Object(l["createVNode"])(m,null,{default:Object(l["withCtx"])(()=>[e.getIsAuth?(Object(l["openBlock"])(),Object(l["createBlock"])(s,{key:0},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(c)]),_:1})):Object(l["createCommentVNode"])("",!0),Object(l["createVNode"])(m,null,{default:Object(l["withCtx"])(()=>[e.getIsAuth?(Object(l["openBlock"])(),Object(l["createBlock"])(b,{key:0},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d)]),_:1})):Object(l["createCommentVNode"])("",!0),Object(l["createVNode"])(u,null,{default:Object(l["withCtx"])(()=>[Object(l["renderSlot"])(e.$slots,"default")]),_:3})]),_:3})]),_:3})])}const c=e=>(Object(l["pushScopeId"])("data-v-35c4565f"),e=e(),Object(l["popScopeId"])(),e),s={class:"parent"},d=c(()=>Object(l["createElementVNode"])("div",{class:"logo"},"Able CRM",-1)),b={class:"time"},u={class:"exit"},m={class:"login"},p={class:"login_text"};function j(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("ChangeTimezone"),c=Object(l["resolveComponent"])("el-avatar"),j=Object(l["resolveComponent"])("el-button"),O=Object(l["resolveComponent"])("font-awesome-icon");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",s,[d,Object(l["createElementVNode"])("div",b,[Object(l["createVNode"])(n,{time:i.time},null,8,["time"])]),Object(l["createElementVNode"])("div",u,[Object(l["createVNode"])(j,{class:Object(l["normalizeClass"])({activeMenu:e.getActiveUserSettings}),type:"text",onClick:r.user_settings},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("div",m,[Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(c,{src:i.avatar,icon:"el-icon-user-solid",size:"small"},null,8,["src"])]),Object(l["createElementVNode"])("div",p,Object(l["toDisplayString"])(e.getLogin),1)])]),_:1},8,["class","onClick"]),Object(l["createVNode"])(j,{class:Object(l["normalizeClass"])({activeMenu:e.getActiveSettings}),type:"text",onClick:r.settings},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(O,{class:"icon",icon:"cogs"})]),_:1},8,["class","onClick"]),Object(l["createVNode"])(j,{type:"text",onClick:r.logout_system},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(O,{class:"icon",icon:"sign-out-alt"})]),_:1},8,["onClick"])])])}var O=a("bc3a"),h=a.n(O),_=a("5a30"),g=a.n(_),f=a("7068");const v=(e,t,a)=>{Object(f["a"])({title:e,message:t,type:a,duration:5e3,dangerouslyUseHTMLString:!0})},y=e=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(e),V=e=>e.toLocaleString(),w=e=>e.toFixed(2),k=e=>document.evaluate(e,document,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),C=e=>{const t=[{origin:"тонна",volume:"тонну"}];for(let a in t)if(t[a].origin===e)return t[a].volume;return e},N=e=>{var t;const a=new Date(1e3*e);return a.toLocaleString("ru-RU",{timeZone:null===(t=JSON.parse(localStorage.getItem("user_data")))||void 0===t?void 0:t.timezone})},x=e=>{const t=[{origin:"тонна",volume:"тонн"},{origin:"кубический метр",volume:"кубов"},{origin:"метр",volume:"метров"},{origin:"километр",volume:"километров"},{origin:"дюйм",volume:"дюймов"},{origin:"квадратный крилометр",volume:"квадратных километров"},{origin:"ар",volume:"аров"},{origin:"гектар",volume:"гекратов"},{origin:"квадратный метр",volume:"квадратных метров"},{origin:"квадратный дециметр",volume:"квадратных дециметров"},{origin:"квадратный сантиметр",volume:"квадратных сантиметров"},{origin:"квадратный дюйм",volume:"квадратных дюймов"},{origin:"кубический метр",volume:"кубических метров"},{origin:"кубический дециметр",volume:"кубических дециметров"},{origin:"гектолитр",volume:"гектолитров"},{origin:"килограмм",volume:"килограмм"},{origin:"грамм",volume:"грамов"},{origin:"килловат-час",volume:"килловат-часов"},{origin:"килловат",volume:"килловатов"}];for(let a in t)if(t[a].origin===e)return t[a].volume;return e},B=async e=>{const t=new g.a;return t.append("login",e.login),t.append("password",e.password),await h.a.post("http://89.22.225.131:8020/api/auth/login",t).then(e=>{var t,a,l,o,i,r;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||null===(a=t.data)||void 0===a||!a.token)&&(localStorage.setItem("crm_token",null===e||void 0===e||null===(l=e.data)||void 0===l||null===(o=l.data)||void 0===o?void 0:o.token),localStorage.setItem("user_id",null===e||void 0===e||null===(i=e.data)||void 0===i||null===(r=i.data)||void 0===r?void 0:r.id),!0)}).catch(e=>{var t;return v("Авторизация",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1)},S=async e=>{const t=new g.a;return t.append("token",e),t.append("user_id",localStorage.getItem("user_id")),await h.a.post("http://89.22.225.131:8020/api/auth/logout",t).then(e=>{var t;return v("Выход из системы",null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message,"success"),localStorage.removeItem("crm_token"),localStorage.removeItem("user_data"),localStorage.removeItem("user_id"),localStorage.removeItem("currentMenu"),!0}).catch(e=>{var t;return v("Выход из системы",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1)};var I=a("5502");function E(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("el-button"),c=Object(l["resolveComponent"])("el-popconfirm");return Object(l["openBlock"])(),Object(l["createBlock"])(c,{title:`Ваш текущий часовой пояс ${this.currentTimezone}. Часовой пояс системы ${this.systemTimezone}. Сменить?`,"cancel-button-text":"Нет, оставить так","confirm-button-text":"Да, сменить",icon:"el-icon-info","icon-color":"red",onConfirm:r.confirmEvent},{reference:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{disabled:this.currentTimezone===this.systemTimezone,type:"text"},{default:Object(l["withCtx"])(()=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(a.time),1)]),_:1},8,["disabled"])]),_:1},8,["title","onConfirm"])}var M={props:{time:{require:!0,type:String}},data(){return{currentTimezone:null,systemTimezone:null}},methods:{...Object(I["b"])(["setUserTimezone","getTimezone"]),async confirmEvent(){var e;const t=localStorage.getItem("crm_token"),a=await this.getTimezone({token:t,timezone_name:this.currentTimezone});await this.setUserTimezone({timezone_id:a,token:t}),this.currentTimezone=Intl.DateTimeFormat().resolvedOptions().timeZone,this.systemTimezone=null===(e=JSON.parse(localStorage.getItem("user_data")))||void 0===e?void 0:e.timezone}},mounted(){var e;this.currentTimezone=Intl.DateTimeFormat().resolvedOptions().timeZone,this.systemTimezone=null===(e=JSON.parse(localStorage.getItem("user_data")))||void 0===e?void 0:e.timezone,setTimeout(()=>{this.currentTimezone!==this.systemTimezone&&document.querySelector(".el-button ").click()},3e3)}},D=(a("7907"),a("6b0d")),T=a.n(D);const U=T()(M,[["render",E],["__scopeId","data-v-ef5b7410"]]);var F=U,A={components:{ChangeTimezone:F},data(){var e;return{time:null,interval:null,user_data:null!==(e=JSON.parse(localStorage.getItem("user_data")))&&void 0!==e?e:null,avatar:null}},created(){this.interval=setInterval(this.getNow,1e3)},methods:{...Object(I["b"])(["setIsAuth","setActiveSettings","setIndexMenu","setActiveUserSettings"]),getNow:function(){var e;const t=new Date;this.time=t.toLocaleString("ru-RU",{timeZone:null===(e=JSON.parse(localStorage.getItem("user_data")))||void 0===e?void 0:e.timezone})},logout_system:function(){S(localStorage.getItem("crm_token"))&&(this.setIsAuth(!1),this.$router.push("/"))},saveCurrentMenu:function(e){localStorage.setItem("currentLink",e)},settings:function(){this.setIndexMenu("0"),this.setActiveSettings(!0),this.setActiveUserSettings(!1),localStorage.setItem("currentMenu","0"),this.saveCurrentMenu("/settings")},user_settings:function(){this.setIndexMenu("0"),this.setActiveSettings(!1),this.setActiveUserSettings(!0),localStorage.setItem("currentMenu","999"),this.$router.push("/user_settings"),this.saveCurrentMenu("/user_settings")}},mounted(){this.avatar=this.getAvatar},computed:{...Object(I["c"])(["getActiveSettings","getActiveUserSettings","getLogin","getAvatar"])},unmounted(){clearInterval(this.interval)},watch:{getAvatar:function(){this.avatar=this.getAvatar}}};a("edd1");const L=T()(A,[["render",j],["__scopeId","data-v-35c4565f"]]);var q=L;const $=e=>(Object(l["pushScopeId"])("data-v-5f8bc19d"),e=e(),Object(l["popScopeId"])(),e),z=$(()=>Object(l["createElementVNode"])("div",{class:"menu-text"},"Dashboard",-1)),P=$(()=>Object(l["createElementVNode"])("div",{class:"menu-text"},"История операций",-1)),H=$(()=>Object(l["createElementVNode"])("div",{class:"menu-text"},"Оплата",-1)),R=$(()=>Object(l["createElementVNode"])("div",{class:"menu-text"},"Поставщики",-1)),J=$(()=>Object(l["createElementVNode"])("div",{class:"menu-text"},"Объекты",-1)),Y=$(()=>Object(l["createElementVNode"])("div",{class:"menu-text"},"Материалы",-1)),W=$(()=>Object(l["createElementVNode"])("div",{class:"menu-text"},"Типы материалов",-1)),K=$(()=>Object(l["createElementVNode"])("div",{class:"menu-text"},"Юридические лица",-1)),Z=$(()=>Object(l["createElementVNode"])("div",{class:"menu-text"},"Отчеты",-1));function G(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("font-awesome-icon"),c=Object(l["resolveComponent"])("el-menu-item"),s=Object(l["resolveComponent"])("el-menu");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object(l["createVNode"])(s,{"default-active":String(i.index),class:"el-menu",mode:"vertical",onSelect:r.changeMenu},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(c,{class:Object(l["normalizeClass"])([{activeMenu:"1"===i.index},"menu-item"]),index:"1"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{class:"menu-icon",icon:"chart-line"}),z]),_:1},8,["class"]),Object(l["createVNode"])(c,{class:Object(l["normalizeClass"])([{activeMenu:"3"===i.index},"menu-item"]),index:"3"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{class:"menu-icon",icon:"history"}),P]),_:1},8,["class"]),Object(l["createVNode"])(c,{class:Object(l["normalizeClass"])([{activeMenu:"4"===i.index},"menu-item"]),index:"4"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{class:"menu-icon",icon:"money-bill-alt"}),H]),_:1},8,["class"]),Object(l["createVNode"])(c,{class:Object(l["normalizeClass"])([{activeMenu:"5"===i.index},"menu-item"]),index:"5"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{class:"menu-icon",icon:"truck-pickup"}),R]),_:1},8,["class"]),Object(l["createVNode"])(c,{class:Object(l["normalizeClass"])([{activeMenu:"6"===i.index},"menu-item"]),index:"6"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{class:"menu-icon",icon:"hard-hat"}),J]),_:1},8,["class"]),Object(l["createVNode"])(c,{class:Object(l["normalizeClass"])([{activeMenu:"7"===i.index},"menu-item"]),index:"7"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{class:"menu-icon",icon:"drafting-compass"}),Y]),_:1},8,["class"]),Object(l["createVNode"])(c,{class:Object(l["normalizeClass"])([{activeMenu:"8"===i.index},"menu-item"]),index:"8"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{class:"menu-icon",icon:"paint-roller"}),W]),_:1},8,["class"]),Object(l["createVNode"])(c,{class:Object(l["normalizeClass"])([{activeMenu:"9"===i.index},"menu-item"]),index:"9"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{class:"menu-icon",icon:"building"}),K]),_:1},8,["class"]),Object(l["createVNode"])(c,{class:Object(l["normalizeClass"])([{activeMenu:"10"===i.index},"menu-item"]),index:"10"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{class:"menu-icon",icon:"file-code"}),Z]),_:1},8,["class"])]),_:1},8,["default-active","onSelect"])])}var X={data(){return{index:1}},methods:{...Object(I["b"])(["setIndexMenu","setActiveSettings","setActiveUserSettings"]),saveCurrentMenu:function(e){localStorage.setItem("currentLink",e)},changeMenu:function(e){switch(this.setIndexMenu(e),this.setActiveSettings(!1),this.setActiveUserSettings(!1),localStorage.setItem("currentMenu",String(e)),e){case"1":this.$router.push("/dashboard"),this.saveCurrentMenu("/dashboard");break;case"3":this.$router.push("/history"),this.saveCurrentMenu("/history");break;case"4":this.$router.push("/payments"),this.saveCurrentMenu("/payments");break;case"5":this.$router.push("/vendors"),this.saveCurrentMenu("/vendors");break;case"6":this.$router.push("/objects"),this.saveCurrentMenu("/objects");break;case"7":this.$router.push("/materials"),this.saveCurrentMenu("/materials");break;case"8":this.$router.push("/material_types"),this.saveCurrentMenu("/material_types");break;case"9":this.$router.push("/legal_entities"),this.saveCurrentMenu("/legal_entities");break;case"10":this.$router.push("/reports"),this.saveCurrentMenu("/reports");break}}},computed:{...Object(I["c"])(["getIndexMenu"])},watch:{getIndexMenu:function(){this.index=this.getIndexMenu}},mounted(){var e;"#/"===window.location.hash&&null===localStorage.getItem("currentLink")&&(localStorage.setItem("currentMenu","1"),this.setActiveSettings(!1),this.setActiveUserSettings(!1)),this.index=null!==(e=localStorage.getItem("currentMenu"))&&void 0!==e?e:this.getIndexMenu}};a("c7e0");const Q=T()(X,[["render",G],["__scopeId","data-v-5f8bc19d"]]);var ee=Q;function te(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("el-main");return Object(l["openBlock"])(),Object(l["createBlock"])(n,null,{default:Object(l["withCtx"])(()=>[Object(l["renderSlot"])(e.$slots,"default")]),_:3})}var ae={name:"Main"};const le=T()(ae,[["render",te]]);var oe=le,ie={components:{Header:q,Menu:ee,Main:oe},computed:{...Object(I["c"])(["getIsAuth"])}};a("7969");const re=T()(ie,[["render",n]]);var ne=re,ce={components:{Wrapper:ne},data(){return{}},methods:{...Object(I["b"])(["setIndexMenu"])},mounted(){if(null===localStorage.getItem("crm_token"))this.$router.push("/");else{const e=localStorage.getItem("currentLink");null!==e?(this.$router.push(e),this.setIndexMenu(localStorage.getItem("currentMenu"))):this.$router.push("/dashboard")}}};a("79a7");const se=T()(ce,[["render",i]]);var de=se,be=a("6605");const ue=e=>(Object(l["pushScopeId"])("data-v-3de14e28"),e=e(),Object(l["popScopeId"])(),e),me=ue(()=>Object(l["createElementVNode"])("h2",{class:"text"},"Авторизация",-1)),pe=Object(l["createTextVNode"])("Войти ");function je(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("el-input"),c=Object(l["resolveComponent"])("el-form-item"),s=Object(l["resolveComponent"])("el-button"),d=Object(l["resolveComponent"])("el-form"),b=Object(l["resolveDirective"])("loading");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object(l["createVNode"])(d,{ref:"ruleForm",model:i.ruleForm,rules:i.rules,class:"able_auth","label-width":"120px","status-icon":""},{default:Object(l["withCtx"])(()=>[me,Object(l["createVNode"])(c,{prop:"login"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{modelValue:i.ruleForm.login,"onUpdate:modelValue":t[0]||(t[0]=e=>i.ruleForm.login=e),disabled:i.loading,autocomplete:"off",placeholder:"Логин",type:"text",onKeyup:t[1]||(t[1]=Object(l["withKeys"])(e=>r.submitForm("ruleForm"),["enter"]))},null,8,["modelValue","disabled"])]),_:1}),Object(l["createVNode"])(c,{prop:"pass"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{modelValue:i.ruleForm.pass,"onUpdate:modelValue":t[2]||(t[2]=e=>i.ruleForm.pass=e),disabled:i.loading,autocomplete:"off",placeholder:"Пароль",type:"password",onKeyup:t[3]||(t[3]=Object(l["withKeys"])(e=>r.submitForm("ruleForm"),["enter"]))},null,8,["modelValue","disabled"])]),_:1}),Object(l["createVNode"])(c,null,{default:Object(l["withCtx"])(()=>[Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createBlock"])(s,{disabled:i.loading,class:"btn-login",type:"primary",onClick:t[4]||(t[4]=e=>r.submitForm("ruleForm")),onKeyup:t[5]||(t[5]=Object(l["withKeys"])(e=>r.submitForm("ruleForm"),["enter"]))},{default:Object(l["withCtx"])(()=>[pe]),_:1},8,["disabled"])),[[b,i.loading]])]),_:1})]),_:1},8,["model","rules"])])}a("d9e2");var Oe={props:{title:{type:String,require:!0}},data(){const e=(e,t,a)=>{if(!t)return a(new Error("Пожалуйста, заполните поле логин"));""!==this.ruleForm.login&&this.$refs.ruleForm.validateField("login"),a()},t=(e,t,a)=>{""===t?a(new Error("Пожалуйста, заполните поле пароль")):(""!==this.ruleForm.pass&&this.$refs.ruleForm.validateField("pass"),a())};return{loading:!1,ruleForm:{pass:"",login:""},rules:{pass:[{validator:t,trigger:"blur"}],login:[{validator:e,trigger:"blur"}]}}},methods:{...Object(I["b"])(["setIsAuth","login"]),submitForm(e){this.$refs[e].validate(async e=>{if(!e)return this.loading=!1,!1;this.loading=!0,await this.login({login:this.ruleForm.login,password:this.ruleForm.pass})&&await this.$router.push("/dashboard"),this.loading=!1})}},beforeMount(){document.title=this.title}};a("1d39");const he=T()(Oe,[["render",je],["__scopeId","data-v-3de14e28"]]);var _e=he;const ge=e=>(Object(l["pushScopeId"])("data-v-fc23f6dc"),e=e(),Object(l["popScopeId"])(),e),fe=ge(()=>Object(l["createElementVNode"])("h2",null,"Dashboard",-1)),ve={class:"wrapper"};function ye(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("MainChart"),c=Object(l["resolveComponent"])("Main");return Object(l["openBlock"])(),Object(l["createBlock"])(c,null,{default:Object(l["withCtx"])(()=>[fe,Object(l["createElementVNode"])("div",ve,[Object(l["createVNode"])(n)])]),_:1})}const Ve=e=>(Object(l["pushScopeId"])("data-v-09725a65"),e=e(),Object(l["popScopeId"])(),e),we={key:0},ke=Ve(()=>Object(l["createElementVNode"])("p",null,[Object(l["createElementVNode"])("b",null,"Долги")],-1)),Ce={class:"data_text"},Ne={class:"green"},xe={class:"data_text"},Be={key:1},Se=Ve(()=>Object(l["createElementVNode"])("div",null,"Данных по долгам нет",-1)),Ie=Ve(()=>Object(l["createElementVNode"])("br",null,null,-1)),Ee={key:1},Me=Ve(()=>Object(l["createElementVNode"])("div",null,"Данных по операция нет",-1)),De=Ve(()=>Object(l["createElementVNode"])("br",null,null,-1)),Te={key:1},Ue=Ve(()=>Object(l["createElementVNode"])("div",null,"Нет данных",-1));function Fe(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("el-table-column"),c=Object(l["resolveComponent"])("el-table"),s=Object(l["resolveComponent"])("el-card"),d=Object(l["resolveComponent"])("el-col"),b=Object(l["resolveComponent"])("el-row"),u=Object(l["resolveComponent"])("OperationsWithDays"),m=Object(l["resolveDirective"])("loading");return Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object.keys(i.data.debts).length?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",we,[Object(l["createElementVNode"])("div",null,[Object.keys(i.data.debts).length?(Object(l["openBlock"])(),Object(l["createBlock"])(b,{key:0,gutter:24},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{span:24},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{shadow:"hover"},{default:Object(l["withCtx"])(()=>[ke,Object(l["createVNode"])(c,{data:Object.keys(i.data.debts),border:"",style:{width:"100%"}},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{label:"Поставщик"},{default:Object(l["withCtx"])(e=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.row),1)]),_:1}),Object(l["createVNode"])(n,{label:"Взяли"},{default:Object(l["withCtx"])(e=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(Object.keys(i.data.debts[e.row]["Взяли"]),t=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("table",{key:t,class:"debt_data"},[Object(l["createElementVNode"])("tr",null,[Object(l["createElementVNode"])("td",Ce,[Object(l["createTextVNode"])(Object(l["toDisplayString"])(t)+": ",1),Object(l["createElementVNode"])("span",Ne,Object(l["toDisplayString"])(r.format_price(i.data.debts[e.row]["Взяли"][t])),1)])])]))),128))]),_:1}),Object(l["createVNode"])(n,{label:"Долг"},{default:Object(l["withCtx"])(e=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(Object.keys(i.data.debts[e.row]["Долг"]),t=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("table",{key:t,class:"debt_data"},[Object(l["createElementVNode"])("tr",null,[Object(l["createElementVNode"])("td",xe,[Object(l["createTextVNode"])(Object(l["toDisplayString"])(t)+": ",1),Object(l["createElementVNode"])("span",{class:Object(l["normalizeClass"])([i.data.debts[e.row]["Долг"][t]>0?"red":i.data.debts[e.row]["Долг"][t]<0?"blue":""])},Object(l["toDisplayString"])(r.format_price(i.data.debts[e.row]["Долг"][t])),3)])])]))),128))]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})]),_:1})):(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",Be,[Object(l["createVNode"])(s,{shadow:"hover"},{default:Object(l["withCtx"])(()=>[Se]),_:1})]))]),Ie,Object(l["createElementVNode"])("div",null,[Object.keys(i.operationsByMonths).length?(Object(l["openBlock"])(),Object(l["createBlock"])(b,{key:0,gutter:24},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{span:24},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{shadow:"hover"},{default:Object(l["withCtx"])(()=>[i.loaded?(Object(l["openBlock"])(),Object(l["createBlock"])(u,{key:0,data:i.operationsByMonths},null,8,["data"])):Object(l["createCommentVNode"])("",!0)]),_:1})]),_:1})]),_:1})):(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",Ee,[Object(l["createVNode"])(s,{shadow:"hover"},{default:Object(l["withCtx"])(()=>[Me]),_:1})]))]),De])):(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",Te,[Object(l["createVNode"])(s,{shadow:"hover"},{default:Object(l["withCtx"])(()=>[Ue]),_:1})]))])),[[m,i.loading]])}a("13d5");const Ae=Object(l["createTextVNode"])("Сбросить");function Le(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("el-option"),c=Object(l["resolveComponent"])("el-select"),s=Object(l["resolveComponent"])("el-form-item"),d=Object(l["resolveComponent"])("el-date-picker"),b=Object(l["resolveComponent"])("el-button"),u=Object(l["resolveComponent"])("el-form"),m=Object(l["resolveComponent"])("vue3-chart-js");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object(l["createVNode"])(u,{ref:"formRef",inline:!0},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{label:"Период"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(c,{modelValue:i.period,"onUpdate:modelValue":t[0]||(t[0]=e=>i.period=e),class:"full",placeholder:"Выберите период",size:"large"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(i.periods,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(n,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Object(l["createVNode"])(s,{label:"Временной диапозон"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{modelValue:i.date_time,"onUpdate:modelValue":t[1]||(t[1]=e=>i.date_time=e),"default-time":i.defaultTime,class:"full","end-placeholder":"Конец периода",format:"DD.MM.YYYY HH:mm:ss","start-placeholder":"Начало периода",type:"datetimerange"},null,8,["modelValue","default-time"])]),_:1}),Object(l["createVNode"])(s,null,{default:Object(l["withCtx"])(()=>{var e;return[Object(l["createVNode"])(b,{disabled:2!==(null===(e=i.date_time)||void 0===e?void 0:e.length),type:"primary",onClick:r.clear},{default:Object(l["withCtx"])(()=>[Ae]),_:1},8,["disabled","onClick"])]}),_:1})]),_:1},512),Object(l["createVNode"])(m,Object(l["mergeProps"])({ref:"chartRef"},{...i.lineChart}),null,16)])}var qe=a("9c68"),$e=a("d9fa"),ze={components:{Vue3ChartJs:qe["a"]},props:{data:{type:Object,require:!0}},data(){return{defaultTime:[new Date(1970,1,1,0,0,0),new Date],date_time:[],chartRef:Object(l["ref"])(null),period:30,periods:[{label:"Все",value:"all"},{label:"1 день",value:"1"},{label:"2 дня",value:"2"},{label:"3 дня",value:"3"},{label:"4 дня",value:"4"},{label:"5 дней",value:"5"},{label:"6 дней",value:"6"},{label:"Неделя",value:"7"},{label:"2 недели",value:"14"},{label:"Месяц",value:"30"},{label:"2 месяца",value:"60"},{label:"3 месяца",value:"90"},{label:"4 месяца",value:"120"},{label:"5 месяцев",value:"150"},{label:"6 месяцев",value:"180"},{label:"7 месяцев",value:"210"},{label:"8 месяцев",value:"240"},{label:"9 месяцев",value:"270"},{label:"10 месяцев",value:"300"},{label:"11 месяцев",value:"330"},{label:"Год",value:"365"}],lineChart:{type:"line",plugins:[$e["a"]],data:{labels:this.data.labels,datasets:this.data.operations},options:{interaction:{intersect:!1},plugins:{title:{display:!0,text:"Операции по дням"},datalabels:{backgroundColor:function(e){return e.dataset.backgroundColor},borderRadius:4,color:"white",font:{weight:"bold"},formatter:Math.round,padding:6}}}}}},methods:{...Object(I["b"])(["setPeriod","setDateFrom","setDateTo","setIsUpdatedDate"]),clear:function(){this.setDateFrom(0),this.setDateTo(Math.floor((new Date).getTime()/1e3)),this.period="30",this.date_time=[]}},computed:{...Object(I["c"])(["getPeriod","getIsUpdated","getIsUpdatedDate"])},mounted(){this.period=this.getPeriod},watch:{period(){this.setPeriod(this.period)},date_time(){var e;if(2===(null===(e=this.date_time)||void 0===e?void 0:e.length)){this.setDateFrom(Math.floor(new Date(this.date_time[0]).getTime()/1e3)),this.setDateTo(Math.floor(new Date(this.date_time[1]).getTime()/1e3));const e=this.period;this.period="all",this.period===e&&"all"===this.period&&this.setIsUpdatedDate(Math.random())}},getIsUpdated(){this.lineChart.data.labels=this.data.labels,this.lineChart.data.datasets=this.data.operations,this.$refs.chartRef.update(250)}}};a("1f7c");const Pe=T()(ze,[["render",Le],["__scopeId","data-v-dd426d18"]]);var He=Pe,Re={components:{OperationsWithDays:He},data(){return{data:{debts:[]},chartDebt:[],operationsByMonths:{operations:[],labels:[]},colors:{},loaded:!1,loading:!1}},methods:{...Object(I["b"])(["getDataDashboard","setIsUpdated"]),randomColor:()=>"#"+(Math.random().toString(16)+"000000").substring(2,8).toUpperCase(),format_price:function(e){return y(e)},format_volume:function(e){return V(e)},volume_format:function(e){return x(e)},get_data_dashboard:async function(){this.loading=!0,this.data=await this.getDataDashboard({token:localStorage.getItem("crm_token"),period:this.getPeriod,date_from:this.getDateFrom,date_to:this.getDateTo});for(let t in this.data.debts)this.colors[t]=this.randomColor(Object.keys(this.data.debts).length);for(let t in this.data.debts)this.chartDebt.push({label:t,backgroundColor:this.colors[t],data:this.data.debts[t]});let e=[];for(let t in this.data.operations_by_months.operations)this.data.operations_by_months.operations[t].reduce((function(e,t){return e+t}),0)>0&&e.push({label:t,backgroundColor:this.colors[t],borderColor:this.colors[t],data:this.data.operations_by_months.operations[t].map(e=>0===e?NaN:e),fill:!1,spanGaps:!0});this.operationsByMonths.operations=e,this.operationsByMonths.labels=this.data.operations_by_months.labels,this.setIsUpdated(Math.random()),this.loaded=!0,this.loading=!1}},async mounted(){await this.get_data_dashboard()},computed:{...Object(I["c"])(["getPeriod","getDateFrom","getDateTo","getIsUpdatedDate"])},watch:{async getPeriod(){await this.get_data_dashboard()},async getIsUpdatedDate(){await this.get_data_dashboard()}}};a("b81e");const Je=T()(Re,[["render",Fe],["__scopeId","data-v-09725a65"]]);var Ye=Je,We={props:{title:{type:String,require:!0}},components:{MainChart:Ye,Main:oe},beforeMount(){document.title=this.title}};a("d14b");const Ke=T()(We,[["render",ye],["__scopeId","data-v-fc23f6dc"]]);var Ze=Ke;const Ge=Object(l["createElementVNode"])("h2",null,"Поставщики",-1);function Xe(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("Vendors",!0),c=Object(l["resolveComponent"])("Main");return Object(l["openBlock"])(),Object(l["createBlock"])(c,null,{default:Object(l["withCtx"])(()=>[Ge,Object(l["createVNode"])(n)]),_:1})}const Qe=e=>(Object(l["pushScopeId"])("data-v-17ae9ef6"),e=e(),Object(l["popScopeId"])(),e),et={class:"wrapper"},tt=Qe(()=>Object(l["createElementVNode"])("br",null,null,-1)),at=Qe(()=>Object(l["createElementVNode"])("br",null,null,-1));function lt(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("CreateVendors"),c=Object(l["resolveComponent"])("el-table-column"),s=Object(l["resolveComponent"])("font-awesome-icon"),d=Object(l["resolveComponent"])("EditVendors"),b=Object(l["resolveComponent"])("el-button"),u=Object(l["resolveComponent"])("el-popconfirm"),m=Object(l["resolveComponent"])("el-table"),p=Object(l["resolveComponent"])("el-pagination"),j=Object(l["resolveComponent"])("el-tab-pane"),O=Object(l["resolveComponent"])("el-tabs"),h=Object(l["resolveDirective"])("loading");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",et,[Object(l["createVNode"])(n,{icons:i.icons,class:"create"},null,8,["icons"]),Object(l["createVNode"])(O,{type:"border-card",onTabClick:r.set_tab},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(j,{name:String(0),label:"Активные"},{default:Object(l["withCtx"])(()=>[Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createBlock"])(m,{data:i.vendors.vendors,"default-sort":{prop:"id",order:"descending"},"empty-text":"Данных нет",style:{width:"100%"}},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(c,{label:"ID",prop:"id",sortable:"",width:"80"}),Object(l["createVNode"])(c,{label:"Иконка",prop:"icon",sortable:"",width:"100"},{default:Object(l["withCtx"])(e=>[Object(l["createVNode"])(s,{icon:[e.row.prefix,e.row.icon],class:"icon"},null,8,["icon"])]),_:1}),Object(l["createVNode"])(c,{label:"Название",prop:"name",sortable:""}),Object(l["createVNode"])(c,{label:"Действие",width:"145"},{default:Object(l["withCtx"])(e=>[Object(l["createVNode"])(d,{data:e.row,icons:i.icons,class:"block"},null,8,["data","icons"]),Object(l["createVNode"])(u,{"confirm-button-text":"Естественно","cancel-button-text":"Стой! Оставь","icon-color":"red",title:"Вы точно хотите удалить?",onConfirm:t=>r.remove(e.row.id)},{reference:Object(l["withCtx"])(()=>[Object(l["createVNode"])(b,{class:"remove",type:"danger"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{icon:"trash"})]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[h,i.loading]]),tt,Object(l["createVNode"])(p,{"current-page":i.pagination[i.current_tab],"page-size":10,total:Number(i.vendors.count),background:"",class:"pagination","hide-on-single-page":"",layout:"prev, pager, next",onNextClick:r.get_vendor,onPrevClick:r.get_vendor,onCurrentChange:r.get_vendor},null,8,["current-page","total","onNextClick","onPrevClick","onCurrentChange"])]),_:1},8,["name"]),Object(l["createVNode"])(j,{name:String(1),label:"Архивные"},{default:Object(l["withCtx"])(()=>[Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createBlock"])(m,{data:i.archive_vendors.vendors,"default-sort":{prop:"id",order:"descending"},class:"gray","empty-text":"Данных нет",style:{width:"100%"}},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(c,{label:"ID",prop:"id",sortable:"",width:"80"}),Object(l["createVNode"])(c,{label:"Иконка",prop:"icon",sortable:"",width:"100"},{default:Object(l["withCtx"])(e=>[Object(l["createVNode"])(s,{icon:[e.row.prefix,e.row.icon],class:"icon"},null,8,["icon"])]),_:1}),Object(l["createVNode"])(c,{label:"Название",prop:"name",sortable:""}),Object(l["createVNode"])(c,{label:"Действие",width:"85"},{default:Object(l["withCtx"])(e=>[Object(l["createVNode"])(b,{class:"remove",plain:"",type:"info",onClick:t=>r.restore(e.row.id)},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{icon:"trash-restore"})]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[h,i.loading]]),at,Object(l["createVNode"])(p,{"current-page":i.pagination[i.current_tab],"page-size":10,total:Number(i.archive_vendors.count),background:"",class:"pagination","hide-on-single-page":"",layout:"prev, pager, next",onNextClick:r.get_vendor,onPrevClick:r.get_vendor,onCurrentChange:r.get_vendor},null,8,["current-page","total","onNextClick","onPrevClick","onCurrentChange"])]),_:1},8,["name"])]),_:1},8,["onTabClick"])])}const ot={class:"dialog-footer"},it=Object(l["createTextVNode"])("Отменить"),rt=Object(l["createTextVNode"])(" Сохранить ");function nt(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("font-awesome-icon"),c=Object(l["resolveComponent"])("el-button"),s=Object(l["resolveComponent"])("el-input"),d=Object(l["resolveComponent"])("el-form-item"),b=Object(l["resolveComponent"])("Icons"),u=Object(l["resolveComponent"])("el-form"),m=Object(l["resolveComponent"])("el-dialog");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object(l["createVNode"])(c,{circle:"",type:"success",onClick:t[0]||(t[0]=e=>i.dialogVisible=!0)},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{icon:"plus"})]),_:1}),Object(l["createVNode"])(m,{modelValue:i.dialogVisible,"onUpdate:modelValue":t[4]||(t[4]=e=>i.dialogVisible=e),title:"Создание нового поставщика"},{footer:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",ot,[Object(l["createVNode"])(c,{disabled:i.loading,onClick:t[3]||(t[3]=Object(l["withModifiers"])(e=>i.dialogVisible=!1,["prevent"]))},{default:Object(l["withCtx"])(()=>[it]),_:1},8,["disabled"]),Object(l["createVNode"])(c,{disabled:i.loading,type:"primary",onClick:Object(l["withModifiers"])(r.submitForm,["prevent"])},{default:Object(l["withCtx"])(()=>[rt]),_:1},8,["disabled","onClick"])])]),default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{ref:"createVendor",model:i.fields,"label-width":"130px",onSubmit:t[2]||(t[2]=Object(l["withModifiers"])(()=>{},["prevent","stop"]))},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{disabled:i.loading,rules:i.rules.name,label:"Название",prop:"name"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{modelValue:i.fields.name,"onUpdate:modelValue":t[1]||(t[1]=e=>i.fields.name=e),maxlength:"30","show-word-limit":""},null,8,["modelValue"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(d,{disabled:i.loading,rules:i.rules.icon_id,label:"Иконка",prop:"icon_id"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(b,{icons:a.icons},null,8,["icons"])]),_:1},8,["disabled","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue"])])}const ct=Object(l["createTextVNode"])(" Выбрать иконку "),st={class:"dialog-footer"},dt=Object(l["createTextVNode"])(" Отменить ");function bt(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("font-awesome-icon"),c=Object(l["resolveComponent"])("el-button"),s=Object(l["resolveComponent"])("el-card"),d=Object(l["resolveComponent"])("el-col"),b=Object(l["resolveComponent"])("el-row"),u=Object(l["resolveComponent"])("el-pagination"),m=Object(l["resolveComponent"])("el-dialog");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object(l["createVNode"])(c,{class:"add_icon",type:"info",onClick:r.get_icons},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{icon:[e.getIcon.prefix,e.getIcon.name],class:"icon_btn"},null,8,["icon"]),ct]),_:1},8,["onClick"]),Object(l["createVNode"])(m,{modelValue:i.dialogVisible,"onUpdate:modelValue":t[1]||(t[1]=e=>i.dialogVisible=e),center:"",fullscreen:"",title:"Иконки"},{footer:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",st,[Object(l["createVNode"])(c,{disabled:i.loading,onClick:t[0]||(t[0]=Object(l["withModifiers"])(e=>i.dialogVisible=!1,["prevent"]))},{default:Object(l["withCtx"])(()=>[dt]),_:1},8,["disabled"])])]),default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(b,{gutter:12},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(i.options.icons,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(d,{key:e.id,span:4},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{class:"icon",shadow:"hover",onClick:t=>r.select_icon(e.id,e.prefix,e.name)},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{icon:[e.prefix,e.name]},null,8,["icon"])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1}),Object(l["createVNode"])(u,{"current-page":i.current_page,"page-size":48,total:Number(i.options.count),background:"",class:"pagination",layout:"prev, pager, next",onNextClick:r.pagination,onPrevClick:r.pagination,onCurrentChange:r.pagination},null,8,["current-page","total","onNextClick","onPrevClick","onCurrentChange"])]),_:1},8,["modelValue"])])}var ut={props:{icons:{require:!0,type:Object}},data(){return{dialogVisible:!1,options:[],current_page:1,loading:!1}},methods:{...Object(I["b"])(["getAllIcons","setIcon"]),get_icons:function(){this.options=this.icons,this.dialogVisible=!0},pagination:function(e){this.current_page=e,this.get_icons_with_api(48*e-48)},async get_icons_with_api(e){this.options=await this.getAllIcons({token:localStorage.getItem("crm_token"),offset:e})},select_icon:function(e,t,a){this.loading=!0,this.dialogVisible=!1,this.setIcon({id:e,prefix:t,name:a}),this.current_page=1,this.loading=!1}},computed:{...Object(I["c"])(["getIcon"])},async mounted(){}};a("92d8");const mt=T()(ut,[["render",bt],["__scopeId","data-v-e3165d20"]]);var pt=mt,jt={props:{icons:{require:!0,type:Object}},components:{Icons:pt},data(){return{fields:{name:""},options:[],loading:!1,dialogVisible:!1,rules:{name:[{required:!0,message:"Пожалуйста, укажите название поставщика",trigger:"blur"}]}}},methods:{...Object(I["b"])(["saveVendor","setIcon"]),submitForm:function(){this.$refs["createVendor"].validate(async e=>{if(!e)return this.loading=!1,this.setIcon({id:0,prefix:"",name:""}),!1;{this.loading=!0;const e=await this.saveVendor({name:this.fields.name,icon_id:0!==this.getIcon.id?this.getIcon.id:1,token:localStorage.getItem("crm_token")});e?(this.loading=!1,this.fields.name="",this.dialogVisible=!1,this.setIcon({id:0,prefix:"",name:""})):this.loading=!1}})}},computed:{...Object(I["c"])(["getIcon"])}};const Ot=T()(jt,[["render",nt]]);var ht=Ot;const _t={class:"btn_footer"},gt=Object(l["createTextVNode"])("Отменить"),ft=Object(l["createTextVNode"])(" Сохранить ");function vt(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("font-awesome-icon"),c=Object(l["resolveComponent"])("el-button"),s=Object(l["resolveComponent"])("el-input"),d=Object(l["resolveComponent"])("el-form-item"),b=Object(l["resolveComponent"])("Icons"),u=Object(l["resolveComponent"])("el-form"),m=Object(l["resolveComponent"])("el-dialog");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object(l["createVNode"])(c,{type:"primary",onClick:r.get_data},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{icon:"edit"})]),_:1},8,["onClick"]),Object(l["createVNode"])(m,{modelValue:i.dialogVisible,"onUpdate:modelValue":t[3]||(t[3]=e=>i.dialogVisible=e),center:"",title:"Редактирование поставщика"},{footer:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",_t,[Object(l["createVNode"])(c,{disabled:i.loading,onClick:t[2]||(t[2]=Object(l["withModifiers"])(e=>i.dialogVisible=!1,["prevent"]))},{default:Object(l["withCtx"])(()=>[gt]),_:1},8,["disabled"]),Object(l["createVNode"])(c,{disabled:i.loading,type:"primary",onClick:Object(l["withModifiers"])(r.submitForm,["prevent"])},{default:Object(l["withCtx"])(()=>[ft]),_:1},8,["disabled","onClick"])])]),default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{ref:"updateVendor",model:i.fields,"label-width":"130px",onSubmit:t[1]||(t[1]=Object(l["withModifiers"])(()=>{},["prevent","stop"]))},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{disabled:i.loading,rules:i.rules.name,label:"Название",prop:"name"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{modelValue:i.fields.name,"onUpdate:modelValue":t[0]||(t[0]=e=>i.fields.name=e),maxlength:"30","show-word-limit":""},null,8,["modelValue"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(d,{disabled:i.loading,label:"Иконка"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(b,{icons:a.icons},null,8,["icons"])]),_:1},8,["disabled"])]),_:1},8,["model"])]),_:1},8,["modelValue"])])}var yt={props:{data:{require:!0,type:Object},icons:{require:!0,type:Object}},components:{Icons:pt},data(){return{fields:{name:""},loading:!1,dialogVisible:!1,rules:{name:[{required:!0,message:"Пожалуйста, укажите название поставщика",trigger:"blur"}]}}},methods:{...Object(I["b"])(["updateVendor","setIcon"]),submitForm:function(){this.$refs["updateVendor"].validate(async e=>{if(!e)return this.loading=!1,this.setIcon({id:0,prefix:"",name:""}),!1;{this.loading=!0;const e=await this.updateVendor({id:this.data.id,name:this.fields.name,icon_id:0!==this.getIcon.id?this.getIcon.id:this.fields.icon_id,token:localStorage.getItem("crm_token")});e?(this.loading=!1,this.fields.name="",this.dialogVisible=!1,this.setIcon({id:0,prefix:"",name:""})):this.loading=!1}})},get_data:function(){this.dialogVisible=!0,this.options=this.icons}},computed:{...Object(I["c"])(["getIcon"])},async mounted(){this.fields.name=this.data.name,this.fields.icon_id=this.data.icon_id},watch:{data(e){this.fields.name=e.name,this.fields.icon_id=e.icon_id}}};const Vt=T()(yt,[["render",vt]]);var wt=Vt,kt={components:{CreateVendors:ht,EditVendors:wt},data(){return{icons:[],loading:!1,vendors:[],current_tab:0,archive_vendors:[],pagination:{0:1,1:1},offsets:{0:0,1:0}}},methods:{...Object(I["b"])(["getAllVendors","getAllIcons","deleteVendor","restoreVendor"]),get_vendor:function(e){this.offsets[this.current_tab]=10*e-10,this.pagination[this.current_tab]=e,this.get_vendors()},async get_vendors(){this.loading=!0,this.vendors=await this.getAllVendors({token:localStorage.getItem("crm_token"),offset:this.offsets[0],limit:10,archive:0}),this.archive_vendors=await this.getAllVendors({token:localStorage.getItem("crm_token"),offset:this.offsets[1],limit:10,archive:1}),this.loading=!1},remove:async function(e){var t,a;(null===(t=this.archive_vendors)||void 0===t||null===(a=t.legal_entities)||void 0===a?void 0:a.length)<2&&(this.offsets[0]=0,this.pagination[0]=0),await this.deleteVendor({id:e,token:localStorage.getItem("crm_token")})},restore:async function(e){var t,a;(null===(t=this.archive_vendors)||void 0===t||null===(a=t.legal_entities)||void 0===a?void 0:a.length)<2&&(this.offsets[1]=0,this.pagination[1]=0),await this.restoreVendor({id:e,token:localStorage.getItem("crm_token")})},set_tab:function(e){this.current_tab=e.props.name}},async mounted(){await this.get_vendors(),this.icons=await this.getAllIcons({token:localStorage.getItem("crm_token"),offset:0})},computed:{...Object(I["c"])(["getIsNewVendor"])},watch:{getIsNewVendor:async function(){await this.get_vendors()}}};a("7d0f");const Ct=T()(kt,[["render",lt],["__scopeId","data-v-17ae9ef6"]]);var Nt=Ct,xt={props:{title:{type:String,require:!0}},components:{Main:oe,Vendors:Nt},data(){return{}},methods:{},beforeMount(){document.title=this.title}};const Bt=T()(xt,[["render",Xe]]);var St=Bt;const It=Object(l["createElementVNode"])("h2",null,"Оплата",-1);function Et(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("Payments",!0),c=Object(l["resolveComponent"])("Main");return Object(l["openBlock"])(),Object(l["createBlock"])(c,null,{default:Object(l["withCtx"])(()=>[It,Object(l["createVNode"])(n)]),_:1})}const Mt=e=>(Object(l["pushScopeId"])("data-v-d3f24c0c"),e=e(),Object(l["popScopeId"])(),e),Dt={class:"wrapper"},Tt={class:"text"},Ut={key:0},Ft=Mt(()=>Object(l["createElementVNode"])("br",null,null,-1)),At={key:1},Lt=Mt(()=>Object(l["createElementVNode"])("div",null,"Нет данных",-1));function qt(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("CreatePayment"),c=Object(l["resolveComponent"])("el-menu-item"),s=Object(l["resolveComponent"])("el-menu"),d=Object(l["resolveComponent"])("el-card"),b=Object(l["resolveComponent"])("el-col"),u=Object(l["resolveComponent"])("el-table-column"),m=Object(l["resolveComponent"])("font-awesome-icon"),p=Object(l["resolveComponent"])("EditPayment"),j=Object(l["resolveComponent"])("el-button"),O=Object(l["resolveComponent"])("el-popconfirm"),h=Object(l["resolveComponent"])("el-table"),_=Object(l["resolveComponent"])("el-pagination"),g=Object(l["resolveComponent"])("el-row"),f=Object(l["resolveDirective"])("loading");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",Dt,[Object(l["createVNode"])(n,{legal_entities:i.edit.legal_entities.legal_entities,vendors:i.edit.vendors.vendors,material_types:i.edit.material_types.types,class:"create"},null,8,["legal_entities","vendors","material_types"]),Object.keys(i.legal_entity_ids).length?(Object(l["openBlock"])(),Object(l["createBlock"])(g,{key:0,gutter:24},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(b,{span:5},{default:Object(l["withCtx"])(()=>[Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createBlock"])(d,{shadow:"never"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,null,{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(Object.keys(i.legal_entity_ids),e=>(Object(l["openBlock"])(),Object(l["createBlock"])(c,{key:i.legal_entity_ids[e],index:`${e}_!-#$te__${i.legal_entity_ids[e]}`,onClick:r.set_vendor},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",Tt,Object(l["toDisplayString"])(e),1)]),_:2},1032,["index","onClick"]))),128))]),_:1})]),_:1})),[[f,i.loadingMenu]])]),_:1}),Object(l["createVNode"])(b,{span:19},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{shadow:"never"},{default:Object(l["withCtx"])(()=>[i.current_vendor?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",Ut,[Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createBlock"])(h,{data:i.payments[i.current_vendor],"default-sort":{prop:"id",order:"descending"},"empty-text":"Данных нет",style:{width:"100%"}},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{label:"ID",prop:"id",sortable:"",width:"60"}),Object(l["createVNode"])(u,{label:"Иконка",width:"80"},{default:Object(l["withCtx"])(e=>[Object(l["createVNode"])(m,{icon:[e.row.prefix,e.row.icon],class:"icon size_icon"},null,8,["icon"])]),_:1}),Object(l["createVNode"])(u,{label:"Поставщик",prop:"vendor",sortable:"",width:"180"}),Object(l["createVNode"])(u,{label:"Тип операции",sortable:"",width:"140"},{default:Object(l["withCtx"])(e=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])("buy"===e.row.operation_type?"Оплата":"Возврат"),1)]),_:1}),Object(l["createVNode"])(u,{label:"Тип материала",prop:"material_type",sortable:"",width:"150"}),Object(l["createVNode"])(u,{"sort-method":r.sortAmount,label:"Сумма",sortable:""},{default:Object(l["withCtx"])(e=>[Object(l["createElementVNode"])("span",{class:Object(l["normalizeClass"])({"color-green":r.color_green(e.row.operation_type),"color-red":r.color_red(e.row.operation_type)})},Object(l["toDisplayString"])(r.format_amount(-e.row.amount)),3)]),_:1},8,["sort-method"]),Object(l["createVNode"])(u,{"sort-method":r.sortDate,label:"Дата оплаты",sortable:""},{default:Object(l["withCtx"])(e=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(r.format_date(e.row.created_at)),1)]),_:1},8,["sort-method"]),Object(l["createVNode"])(u,{label:"Действие",width:"145"},{default:Object(l["withCtx"])(e=>[Object(l["createVNode"])(p,{data:e.row,legal_entities:i.edit.legal_entities.legal_entities,vendors:i.edit.vendors.vendors,material_types:i.edit.material_types.types,class:"block"},null,8,["data","legal_entities","vendors","material_types"]),Object(l["createVNode"])(O,{"cancel-button-text":"Стой! Оставь","confirm-button-text":"Естественно","icon-color":"red",title:"Вы точно хотите удалить?",onConfirm:t=>r.remove(e.row.id)},{reference:Object(l["withCtx"])(()=>[Object(l["createVNode"])(j,{class:"remove",type:"danger"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(m,{icon:"trash"})]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[f,i.loading]]),Ft,Object(l["createVNode"])(_,{"current-page":i.pagination[i.current_vendor],"page-size":10,total:Number(i.count[i.current_vendor]),background:"",class:"pagination","hide-on-single-page":"",layout:"prev, pager, next",onNextClick:r.get_payments,onPrevClick:r.get_payments,onCurrentChange:r.get_payments},null,8,["current-page","total","onNextClick","onPrevClick","onCurrentChange"])])):(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",At,"Юридическое лицо не выбран"))]),_:1})]),_:1})]),_:1})):Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createBlock"])(d,{key:1},{default:Object(l["withCtx"])(()=>[Lt]),_:1})),[[f,i.loadingMenu]])])}const $t={class:"dialog-footer"},zt=Object(l["createTextVNode"])("Отменить"),Pt=Object(l["createTextVNode"])(" Сохранить ");function Ht(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("font-awesome-icon"),c=Object(l["resolveComponent"])("el-button"),s=Object(l["resolveComponent"])("el-option"),d=Object(l["resolveComponent"])("el-select"),b=Object(l["resolveComponent"])("el-form-item"),u=Object(l["resolveComponent"])("el-input"),m=Object(l["resolveComponent"])("el-date-picker"),p=Object(l["resolveComponent"])("el-form"),j=Object(l["resolveComponent"])("el-checkbox"),O=Object(l["resolveComponent"])("el-dialog");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object(l["createVNode"])(c,{circle:"",type:"success",onClick:t[0]||(t[0]=e=>i.dialogVisible=!0)},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{icon:"plus"})]),_:1}),Object(l["createVNode"])(O,{modelValue:i.dialogVisible,"onUpdate:modelValue":t[9]||(t[9]=e=>i.dialogVisible=e),title:"Создание платежа"},{footer:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",$t,[Object(l["createVNode"])(j,{modelValue:i.isRefund,"onUpdate:modelValue":t[7]||(t[7]=e=>i.isRefund=e),label:"Возврат"},null,8,["modelValue"]),Object(l["createVNode"])(c,{onClick:t[8]||(t[8]=Object(l["withModifiers"])(e=>i.dialogVisible=!1,["prevent"]))},{default:Object(l["withCtx"])(()=>[zt]),_:1}),Object(l["createVNode"])(c,{disabled:i.loading,type:"primary",onClick:Object(l["withModifiers"])(r.submitForm,["prevent"])},{default:Object(l["withCtx"])(()=>[Pt]),_:1},8,["disabled","onClick"])])]),default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(p,{ref:"createMaterialType",model:i.fields,"label-width":"170px",onSubmit:t[6]||(t[6]=Object(l["withModifiers"])(()=>{},["prevent","stop"]))},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(b,{disabled:i.loading,rules:i.rules.vendor_id,label:"Постащик",prop:"vendor_id"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{modelValue:i.fields.vendor_id,"onUpdate:modelValue":t[1]||(t[1]=e=>i.fields.vendor_id=e),"no-data-text":"Поставщиков не найдено. Добавьте нового или восстановите старого",placeholder:"Выберите поставщика"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(a.vendors,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(s,{key:e.id,label:e.name,value:e.id},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",null,[Object(l["createVNode"])(n,{icon:[e.prefix,e.icon],class:"icon"},null,8,["icon"]),Object(l["createTextVNode"])("  "+Object(l["toDisplayString"])(e.name),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(b,{disabled:i.loading,rules:i.rules.legal_entity_id,label:"Юридическое лицо",prop:"legal_entity_id"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{modelValue:i.fields.legal_entity_id,"onUpdate:modelValue":t[2]||(t[2]=e=>i.fields.legal_entity_id=e),"no-data-text":"Юридических лиц не найдено. Добавьте новое или восстановите старое",placeholder:"Выберите юридическое лицо"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(a.legal_entities,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(s,{key:e.id,label:`${e.legal_entities_type} ${e.name}`,value:e.id},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",null,Object(l["toDisplayString"])(e.legal_entities_type)+" "+Object(l["toDisplayString"])(e.name),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(b,{disabled:i.loading,rules:i.rules.material_type_id,label:"Тип материала",prop:"material_type_id"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{modelValue:i.fields.material_type_id,"onUpdate:modelValue":t[3]||(t[3]=e=>i.fields.material_type_id=e),"no-data-text":"Тип материала не найден не найдено. Добавьте новое",placeholder:"Выберите тип материала"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(a.material_types,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(s,{key:e.id,label:e.name,value:e.id},{default:Object(l["withCtx"])(()=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.name),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(b,{disabled:i.loading,rules:i.rules.amount,label:"Сумма",prop:"amount"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{modelValue:i.fields.amount,"onUpdate:modelValue":t[4]||(t[4]=e=>i.fields.amount=e),maxlength:"15","show-word-limit":"",onBlur:r.format_price},null,8,["modelValue","onBlur"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(b,{disabled:i.loading,rules:i.rules.created_at,label:"Дата платежа",prop:"created_at"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(m,{modelValue:i.fields.created_at,"onUpdate:modelValue":t[5]||(t[5]=e=>i.fields.created_at=e),shortcuts:i.shortcuts,format:"DD.MM.YYYY HH:mm:ss",placeholder:"Выберите дату и время",type:"datetime"},null,8,["modelValue","shortcuts"])]),_:1},8,["disabled","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue"])])}var Rt={props:{vendors:{require:!0,type:Array},legal_entities:{require:!0,type:Array},material_types:{require:!0,type:Array}},data(){return{fields:{vendor_id:"",legal_entity_id:"",material_type_id:"",amount:null,created_at:new Date},shortcuts:[{text:"Сегодня",value:new Date},{text:"Вчера",value:()=>{const e=new Date;return e.setTime(e.getTime()-864e5),e}}],loading:!1,dialogVisible:!1,isRefund:!1,rules:{vendor_id:[{required:!0,message:"Пожалуйста, выберите поставщика",trigger:"blur"}],legal_entity_id:[{required:!0,message:"Пожалуйста, выберите юридическое лицо",trigger:"blur"}],material_type_id:[{required:!0,message:"Пожалуйста, выберите тип материала",trigger:"blur"}],amount:[{required:!0,message:"Пожалуйста, укажите сумму",trigger:"blur"}],created_at:[{required:!0,message:"Пожалуйста, укажите дату платежа",trigger:"blur"}]}}},methods:{...Object(I["b"])(["savePayment"]),submitForm:function(){this.$refs["createMaterialType"].validate(async e=>{if(!e)return this.loading=!1,!1;{this.loading=!0;const e=await this.savePayment({vendor_id:this.fields.vendor_id,legal_entity_id:this.fields.legal_entity_id,material_type_id:this.fields.material_type_id,operation_type:this.isRefund?"refund":"buy",amount:this.isRefund?-this.fields.amount.replace(",","."):this.fields.amount.replace(",","."),created_at:Math.floor(new Date(this.fields.created_at).getTime()/1e3),token:localStorage.getItem("crm_token")});e?(this.loading=!1,this.fields.vendor_id="",this.fields.legal_entity_id=this.getLegalEntityId,this.fields.material_type_id="",this.fields.amount=null,this.fields.created_at=new Date,this.dialogVisible=!1,this.isRefund=!1):this.loading=!1}})},format_price:function(e){this.fields.amount=w(parseFloat(e.target.value))}},computed:{...Object(I["c"])(["getLegalEntityId"])},async mounted(){this.fields.legal_entity_id=this.getLegalEntityId?this.getLegalEntityId:""},watch:{getLegalEntityId:function(){this.fields.legal_entity_id=this.getLegalEntityId?this.getLegalEntityId:""}}};a("f73f");const Jt=T()(Rt,[["render",Ht],["__scopeId","data-v-035a6df0"]]);var Yt=Jt;const Wt={class:"dialog-footer"},Kt=Object(l["createTextVNode"])("Отменить"),Zt=Object(l["createTextVNode"])(" Сохранить ");function Gt(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("font-awesome-icon"),c=Object(l["resolveComponent"])("el-button"),s=Object(l["resolveComponent"])("el-option"),d=Object(l["resolveComponent"])("el-select"),b=Object(l["resolveComponent"])("el-form-item"),u=Object(l["resolveComponent"])("el-input"),m=Object(l["resolveComponent"])("el-date-picker"),p=Object(l["resolveComponent"])("el-form"),j=Object(l["resolveComponent"])("el-checkbox"),O=Object(l["resolveComponent"])("el-dialog");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object(l["createVNode"])(c,{type:"primary",onClick:t[0]||(t[0]=e=>i.dialogVisible=!0)},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{icon:"edit"})]),_:1}),Object(l["createVNode"])(O,{modelValue:i.dialogVisible,"onUpdate:modelValue":t[9]||(t[9]=e=>i.dialogVisible=e),title:"Редактирование платежа"},{footer:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",Wt,[Object(l["createVNode"])(j,{modelValue:i.isRefund,"onUpdate:modelValue":t[7]||(t[7]=e=>i.isRefund=e),label:"Возврат"},null,8,["modelValue"]),Object(l["createVNode"])(c,{onClick:t[8]||(t[8]=Object(l["withModifiers"])(e=>i.dialogVisible=!1,["prevent"]))},{default:Object(l["withCtx"])(()=>[Kt]),_:1}),Object(l["createVNode"])(c,{disabled:i.loading,type:"primary",onClick:Object(l["withModifiers"])(r.submitForm,["prevent"])},{default:Object(l["withCtx"])(()=>[Zt]),_:1},8,["disabled","onClick"])])]),default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(p,{ref:"updatePayment",model:i.fields,"label-width":"170px",onSubmit:t[6]||(t[6]=Object(l["withModifiers"])(()=>{},["prevent","stop"]))},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(b,{disabled:i.loading,rules:i.rules.vendor_id,label:"Постащик",prop:"vendor_id"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{modelValue:i.fields.vendor_id,"onUpdate:modelValue":t[1]||(t[1]=e=>i.fields.vendor_id=e),"no-data-text":"Поставщиков не найдено. Добавьте нового или восстановите старого",placeholder:"Выберите поставщика"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(a.vendors,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(s,{key:e.id,label:e.name,value:e.id},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",null,[Object(l["createVNode"])(n,{icon:[e.prefix,e.icon],class:"icon"},null,8,["icon"]),Object(l["createTextVNode"])("  "+Object(l["toDisplayString"])(e.name),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(b,{disabled:i.loading,rules:i.rules.legal_entity_id,label:"Юридическое лицо",prop:"legal_entity_id"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{modelValue:i.fields.legal_entity_id,"onUpdate:modelValue":t[2]||(t[2]=e=>i.fields.legal_entity_id=e),"no-data-text":"Юридических лиц не найдено. Добавьте новое или восстановите старое",placeholder:"Выберите юридическое лицо"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(a.legal_entities,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(s,{key:e.id,label:`${e.legal_entities_type} ${e.name}`,value:e.id},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",null,Object(l["toDisplayString"])(e.legal_entities_type)+" "+Object(l["toDisplayString"])(e.name),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(b,{disabled:i.loading,rules:i.rules.material_type_id,label:"Тип материала",prop:"material_type_id"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{modelValue:i.fields.material_type_id,"onUpdate:modelValue":t[3]||(t[3]=e=>i.fields.material_type_id=e),"no-data-text":"Тип материала не найден не найдено. Добавьте новое",placeholder:"Выберите тип материала"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(a.material_types,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(s,{key:e.id,label:e.name,value:e.id},{default:Object(l["withCtx"])(()=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.name),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(b,{disabled:i.loading,rules:i.rules.amount,label:"Сумма",prop:"amount"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{modelValue:i.fields.amount,"onUpdate:modelValue":t[4]||(t[4]=e=>i.fields.amount=e),maxlength:"15","show-word-limit":"",type:"number",onBlur:r.format_price},null,8,["modelValue","onBlur"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(b,{disabled:i.loading,rules:i.rules.created_at,label:"Дата платежа",prop:"created_at"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(m,{modelValue:i.fields.created_at,"onUpdate:modelValue":t[5]||(t[5]=e=>i.fields.created_at=e),shortcuts:i.shortcuts,format:"DD.MM.YYYY HH:mm:ss",placeholder:"Выберите дату и время",type:"datetime"},null,8,["modelValue","shortcuts"])]),_:1},8,["disabled","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue"])])}var Xt={props:{vendors:{require:!0,type:Array},legal_entities:{require:!0,type:Array},material_types:{require:!0,type:Array},data:{require:!0,type:Object}},data(){return{fields:{vendor_id:"",legal_entity_id:"",amount:null,created_at:"",operation_type:""},isRefund:!1,shortcuts:[{text:"Сегодня",value:new Date},{text:"Вчера",value:()=>{const e=new Date;return e.setTime(e.getTime()-864e5),e}}],loading:!1,dialogVisible:!1,rules:{vendor_id:[{required:!0,message:"Пожалуйста, выберите поставщика",trigger:"blur"}],legal_entity_id:[{required:!0,message:"Пожалуйста, выберите юридическое лицо",trigger:"blur"}],material_type_id:[{required:!0,message:"Пожалуйста, выберите тип материала",trigger:"blur"}],amount:[{required:!0,message:"Пожалуйста, укажите сумму",trigger:"blur"}],created_at:[{required:!0,message:"Пожалуйста, укажите дату платежа",trigger:"blur"}]}}},methods:{...Object(I["b"])(["updatePayment"]),submitForm:function(){this.$refs["updatePayment"].validate(async e=>{if(!e)return this.loading=!1,!1;{this.loading=!0,isNaN(parseFloat(this.fields.amount))||isFinite(this.fields.amount)||(this.fields.amount=this.fields.amount.replace(",","."));const e=await this.updatePayment({id:this.data.id,vendor_id:this.fields.vendor_id,legal_entity_id:this.fields.legal_entity_id,material_type_id:this.fields.material_type_id,operation_type:this.isRefund?"refund":"buy",amount:this.isRefund?-this.fields.amount:this.fields.amount,created_at:Math.floor(new Date(this.fields.created_at).getTime()/1e3),token:localStorage.getItem("crm_token")});e?(this.loading=!1,this.fields.vendor_id="",this.fields.legal_entity_id="",this.fields.material_type_id="",this.fields.amount=null,this.fields.created_at=new Date,this.dialogVisible=!1,this.isRefund=!1):this.loading=!1}})},format_price:function(e){this.fields.amount=w(parseFloat(e.target.value))}},mounted(){const e=e=>{var t;let a="";return this.vendors.length&&this.vendors.map(t=>{t.id===e&&(a=e)}),null!==(t=a)&&void 0!==t?t:""},t=e=>{var t,a;let l="";return null!==(t=this.material_types)&&void 0!==t&&t.length&&this.material_types.map(t=>{t.id===e&&(l=e)}),null!==(a=l)&&void 0!==a?a:""},a=e=>{var t,a;let l="";return null!==(t=this.legal_entities)&&void 0!==t&&t.length&&this.legal_entities.map(t=>{t.id===e&&(l=e)}),null!==(a=l)&&void 0!==a?a:""};this.fields.vendor_id=e(this.data.vendor_id),this.fields.legal_entity_id=a(this.getLegalEntityId),this.fields.material_type_id=t(this.data.material_type_id),this.fields.amount=this.data.amount<0?-this.data.amount:this.data.amount,this.fields.operation_type=this.data.operation_type,this.fields.created_at=new Date(1e3*this.data.created_at),this.isRefund="refund"===this.data.operation_type},computed:{...Object(I["c"])(["getLegalEntityId"])},watch:{getLegalEntityId:function(){this.fields.legal_entity_id=this.getLegalEntityId},data(e){this.fields.vendor_id=e.vendor_id,this.fields.legal_entity_id=e.legal_entity_id,this.fields.material_type_id=e.material_type_id,this.fields.amount=e.amount<0?-e.amount:e.amount,this.fields.operation_type=e.operation_type,this.fields.created_at=1e3*e.created_at,this.isRefund="refund"===e.operation_type}}};a("c946");const Qt=T()(Xt,[["render",Gt],["__scopeId","data-v-734246c0"]]);var ea=Qt,ta={components:{CreatePayment:Yt,EditPayment:ea},data(){return{loading:!1,loadingMenu:!1,payments:[],count:[],legal_entity_ids:[],current_tab:1,offsets:[],current_vendor:"",pagination:{},edit:{vendors:[],legal_entities:[],material_types:[]}}},methods:{...Object(I["b"])(["getAllPayments","setLegalEntityId","getAllVendors","getAllLegalEntities","deletePayment","getAllMaterialTypes"]),format_amount:function(e){return y(e)},format_date:function(e){return N(e)},get_payments:function(e){this.pagination[this.current_vendor]=e,this.get_data(10*e-10,this.current_tab)},async get_data(e,t,a=!1){this.loading=!0,a||(this.offsets[t]=e);const{payments:l,count:o,legal_entity_ids:i}=await this.getAllPayments({token:localStorage.getItem("crm_token"),offset:Object.keys(this.offsets).length?this.offsets:{0:0}});Object.keys(this.payments).length!==Object.keys(l).length&&(this.current_vendor=""),this.payments=l,this.count=o,this.legal_entity_ids=i,this.loading=!1},set_vendor:function(e){const t=e.index.split("_!-#$te__");this.current_tab=t[1],this.current_vendor=t[0],this.setLegalEntityId(Number(t[1]))},sortAmount:(e,t)=>e.amount-t.amount,sortDate:(e,t)=>e.created_at-t.created_at,remove:async function(e){var t;(null===(t=this.payments[this.current_vendor])||void 0===t?void 0:t.length)<2&&(this.offsets[this.current_tab]=0,this.pagination[this.current_vendor]=1),await this.deletePayment({id:e,token:localStorage.getItem("crm_token")})},color_green:e=>"refund"===e,color_red:e=>"buy"===e},async mounted(){this.loadingMenu=!0,await this.get_data(0,this.current_tab);for(let e in this.legal_entity_ids)this.offsets[this.legal_entity_ids[e]]=0,this.pagination[e]=1;this.loadingMenu=!1,this.edit.vendors=await this.getAllVendors({token:localStorage.getItem("crm_token")}),this.edit.legal_entities=await this.getAllLegalEntities({token:localStorage.getItem("crm_token")}),this.edit.material_types=await this.getAllMaterialTypes({token:localStorage.getItem("crm_token")}),this.setLegalEntityId(0)},computed:{...Object(I["c"])(["getIsNewPayment"])},watch:{getIsNewPayment:async function(){await this.get_data(0,this.current_tab,!0)}}};a("1821");const aa=T()(ta,[["render",qt],["__scopeId","data-v-d3f24c0c"]]);var la=aa,oa={props:{title:{type:String,require:!0}},components:{Main:oe,Payments:la},data(){return{}},methods:{},beforeMount(){document.title=this.title}};const ia=T()(oa,[["render",Et]]);var ra=ia;const na=Object(l["createElementVNode"])("h2",null,"Настройки приложения",-1);function ca(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("Settings",!0),c=Object(l["resolveComponent"])("Main");return Object(l["openBlock"])(),Object(l["createBlock"])(c,null,{default:Object(l["withCtx"])(()=>[na,Object(l["createVNode"])(n)]),_:1})}function sa(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("TimeZone"),c=Object(l["resolveComponent"])("el-tab-pane"),s=Object(l["resolveComponent"])("Users"),d=Object(l["resolveComponent"])("Debt"),b=Object(l["resolveComponent"])("el-tabs");return Object(l["openBlock"])(),Object(l["createBlock"])(b,{type:"border-card"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(c,{label:"Настройка часового пояса"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n)]),_:1}),i.is_admin?(Object(l["openBlock"])(),Object(l["createBlock"])(c,{key:0,label:"Пользователи"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s)]),_:1})):Object(l["createCommentVNode"])("",!0),i.is_admin?(Object(l["openBlock"])(),Object(l["createBlock"])(c,{key:1,label:"Итог на конец года"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d)]),_:1})):Object(l["createCommentVNode"])("",!0)]),_:1})}const da={class:"timezone"},ba={class:"time"};function ua(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("el-option"),c=Object(l["resolveComponent"])("el-select");return Object(l["openBlock"])(),Object(l["createBlock"])(c,{modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=e=>i.value=e),loading:i.loading,filterable:"","no-data-text":"Часовых поясов не найдено",placeholder:"Выберите часовой пояс",onChange:r.set_timezone},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(i.timezones,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(n,{key:e.timezone_name,label:e.timezone_name,value:e.id,filterable:""},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",da,Object(l["toDisplayString"])(e.timezone_name),1),Object(l["createElementVNode"])("span",ba,Object(l["toDisplayString"])(e.real_time),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","loading","onChange"])}var ma={data(){var e;return{timezones:null,value:null===(e=JSON.parse(localStorage.getItem("user_data")))||void 0===e?void 0:e.timezone,loading:!1}},methods:{...Object(I["b"])(["getTimezones","setUserTimezone"]),set_timezone(e){this.setUserTimezone({timezone_id:e,token:localStorage.getItem("crm_token")})}},computed:{...Object(I["c"])(["getTimezone"])},async mounted(){this.loading=!0,this.timezones=await this.getTimezones(localStorage.getItem("crm_token")),this.timezones.forEach(e=>{let t=new Date,a=t.toLocaleString("ru-RU",{timeZone:e.timezone_name});e.real_time=a}),this.loading=!1}};a("2ea4");const pa=T()(ma,[["render",ua],["__scopeId","data-v-10d47409"]]);var ja=pa;const Oa=e=>(Object(l["pushScopeId"])("data-v-1ff2d8cf"),e=e(),Object(l["popScopeId"])(),e),ha={class:"wrapper"},_a=Oa(()=>Object(l["createElementVNode"])("br",null,null,-1));function ga(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("CreateUser"),c=Object(l["resolveComponent"])("el-table-column"),s=Object(l["resolveComponent"])("EditUser"),d=Object(l["resolveComponent"])("font-awesome-icon"),b=Object(l["resolveComponent"])("el-button"),u=Object(l["resolveComponent"])("el-popconfirm"),m=Object(l["resolveComponent"])("el-table"),p=Object(l["resolveComponent"])("el-pagination"),j=Object(l["resolveDirective"])("loading");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",ha,[Object(l["createVNode"])(n,{class:"create"}),Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createBlock"])(m,{data:i.users.users,"empty-text":"Данных нет",style:{width:"100%"}},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(c,{label:"ID",prop:"id",width:"80"}),Object(l["createVNode"])(c,{label:"Логин",prop:"login",width:"380"}),Object(l["createVNode"])(c,{label:"Email",prop:"email"}),Object(l["createVNode"])(c,{label:"Действия",width:"150"},{default:Object(l["withCtx"])(e=>[Object(l["createVNode"])(s,{data:e.row},null,8,["data"]),Object(l["createVNode"])(u,{"confirm-button-text":"Естественно","cancel-button-text":"Стой! Оставь","icon-color":"red",title:"Вы точно хотите удалить?",onConfirm:t=>r.remove_user(e.row.id)},{reference:Object(l["withCtx"])(()=>[Object(l["createVNode"])(b,{type:"danger"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{icon:"trash"})]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[j,i.loading]]),_a,Object(l["createVNode"])(p,{"page-size":10,total:Number(i.users.count),background:"",class:"pagination","hide-on-single-page":"",layout:"prev, pager, next",onNextClick:r.get_user,onPrevClick:r.get_user,onCurrentChange:r.get_user},null,8,["total","onNextClick","onPrevClick","onCurrentChange"])])}const fa={class:"dialog-footer"},va=Object(l["createTextVNode"])("Отменить"),ya=Object(l["createTextVNode"])(" Сохранить ");function Va(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("font-awesome-icon"),c=Object(l["resolveComponent"])("el-button"),s=Object(l["resolveComponent"])("el-input"),d=Object(l["resolveComponent"])("el-form-item"),b=Object(l["resolveComponent"])("el-form"),u=Object(l["resolveComponent"])("el-dialog");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object(l["createVNode"])(c,{circle:"",class:"add_user",type:"success",onClick:t[0]||(t[0]=e=>i.dialogVisible=!0)},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{icon:"plus"})]),_:1}),Object(l["createVNode"])(u,{modelValue:i.dialogVisible,"onUpdate:modelValue":t[5]||(t[5]=e=>i.dialogVisible=e),title:"Создание пользователя"},{footer:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",fa,[Object(l["createVNode"])(c,{disabled:i.loading,onClick:t[4]||(t[4]=e=>i.dialogVisible=!1)},{default:Object(l["withCtx"])(()=>[va]),_:1},8,["disabled"]),Object(l["createVNode"])(c,{disabled:i.loading,type:"primary",onClick:r.submitForm},{default:Object(l["withCtx"])(()=>[ya]),_:1},8,["disabled","onClick"])])]),default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(b,{ref:"createUser",model:i.fields,"label-width":"80px"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{disabled:i.loading,rules:i.rules.login,label:"Логин",prop:"login"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{modelValue:i.fields.login,"onUpdate:modelValue":t[1]||(t[1]=e=>i.fields.login=e),maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(d,{disabled:i.loading,rules:i.rules.email,label:"Email",prop:"email"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{modelValue:i.fields.email,"onUpdate:modelValue":t[2]||(t[2]=e=>i.fields.email=e),maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(d,{disabled:i.loading,rules:i.rules.password,label:"Пароль",prop:"password"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{modelValue:i.fields.password,"onUpdate:modelValue":t[3]||(t[3]=e=>i.fields.password=e),maxlength:"100","show-word-limit":"",type:"password"},null,8,["modelValue"])]),_:1},8,["disabled","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue"])])}var wa={data(){return{fields:{login:"",email:"",password:""},loading:!1,dialogVisible:!1,rules:{email:[{required:!0,message:"Пожалуйста, укажите адрес электронной почты",trigger:"blur"},{type:"email",message:"Пожалуйста, введите корректный адрес электронной почты",trigger:["blur","change"]}],login:[{required:!0,message:"Пожалуйста, укажите адрес электронной почты",trigger:"blur"}],password:[{required:!0,message:"Пожалуйста, укажите пароль",trigger:"blur"},{required:!0,message:"Минимальная длинна пароля должна быть не менее 5 символов",trigger:["blur","change"],min:5}]}}},methods:{...Object(I["b"])(["create"]),submitForm:function(){this.$refs["createUser"].validate(async e=>{if(!e)return this.loading=!1,!1;{this.loading=!0;const e=await this.create({password:this.fields.password,login:this.fields.login,email:this.fields.email,token:localStorage.getItem("crm_token")});e?(this.loading=!1,this.fields.login="",this.fields.email="",this.fields.password="",this.dialogVisible=!1):this.loading=!1}})}}};const ka=T()(wa,[["render",Va]]);var Ca=ka;const Na={class:"dialog-footer"},xa=Object(l["createTextVNode"])("Отменить"),Ba=Object(l["createTextVNode"])(" Сохранить ");function Sa(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("font-awesome-icon"),c=Object(l["resolveComponent"])("el-button"),s=Object(l["resolveComponent"])("el-input"),d=Object(l["resolveComponent"])("el-form-item"),b=Object(l["resolveComponent"])("el-form"),u=Object(l["resolveComponent"])("el-dialog");return Object(l["openBlock"])(),Object(l["createElementBlock"])(l["Fragment"],null,[Object(l["createVNode"])(c,{class:"edit_user",type:"primary",onClick:t[0]||(t[0]=e=>i.dialogVisible=!0)},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{icon:"edit"})]),_:1}),Object(l["createVNode"])(u,{modelValue:i.dialogVisible,"onUpdate:modelValue":t[5]||(t[5]=e=>i.dialogVisible=e),title:"Редактирование пользователя"},{footer:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",Na,[Object(l["createVNode"])(c,{onClick:t[4]||(t[4]=e=>i.dialogVisible=!1)},{default:Object(l["withCtx"])(()=>[xa]),_:1}),Object(l["createVNode"])(c,{disabled:i.loading,type:"primary",onClick:r.submitForm},{default:Object(l["withCtx"])(()=>[Ba]),_:1},8,["disabled","onClick"])])]),default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(b,{ref:"createUser",model:i.fields,"label-width":"80px"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{disabled:i.loading,rules:i.rules.login,label:"Логин",prop:"login"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{modelValue:i.fields.login,"onUpdate:modelValue":t[1]||(t[1]=e=>i.fields.login=e),maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(d,{disabled:i.loading,rules:i.rules.email,label:"Email",prop:"email"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{modelValue:i.fields.email,"onUpdate:modelValue":t[2]||(t[2]=e=>i.fields.email=e),maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(d,{disabled:i.loading,rules:i.rules.password,label:"Пароль",prop:"password"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{modelValue:i.fields.password,"onUpdate:modelValue":t[3]||(t[3]=e=>i.fields.password=e),maxlength:"100","show-word-limit":"",type:"password"},null,8,["modelValue"])]),_:1},8,["disabled","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}var Ia={props:{data:{require:!0,type:Object}},data(){return{fields:{login:"",email:"",password:""},loading:!1,dialogVisible:!1,rules:{email:[{required:!0,message:"Пожалуйста, укажите адрес электронной почты",trigger:"blur"},{type:"email",message:"Пожалуйста, введите корректный адрес электронной почты",trigger:["blur","change"]}],login:[{required:!0,message:"Пожалуйста, укажите адрес электронной почты",trigger:"blur"}],password:[{required:!0,message:"Пожалуйста, укажите пароль",trigger:"blur"},{required:!0,message:"Минимальная длинна пароля должна быть не менее 5 символов",trigger:["blur","change"],min:5}]}}},methods:{...Object(I["b"])(["update_info"]),submitForm:function(){this.$refs["createUser"].validate(async e=>{if(!e)return this.loading=!1,!1;{this.loading=!0;const e=await this.update_info({id:this.data.id,login:this.fields.login,email:this.fields.email,password:this.fields.password,token:localStorage.getItem("crm_token")});e?(this.loading=!1,this.fields.login="",this.fields.email="",this.fields.password="",this.dialogVisible=!1):this.loading=!1}})}},mounted(){this.fields.login=this.data.login,this.fields.email=this.data.email}};a("0cb0");const Ea=T()(Ia,[["render",Sa],["__scopeId","data-v-ce01da14"]]);var Ma=Ea,Da={components:{CreateUser:Ca,EditUser:Ma},data(){return{loading:!1,users:[],offset:0}},methods:{...Object(I["b"])(["get_all","delete"]),async get_users(){this.loading=!0,this.users=await this.get_all({token:localStorage.getItem("crm_token"),offset:this.offset,limit:10}),this.loading=!1},get_user:function(e){this.offset=10*e-10,this.get_users()},remove_user:function(e){this.delete({id:e,token:localStorage.getItem("crm_token")})}},computed:{...Object(I["c"])(["getIsCreateUser"])},watch:{getIsCreateUser:async function(){await this.get_users()}},async mounted(){await this.get_users()}};a("c461");const Ta=T()(Da,[["render",ga],["__scopeId","data-v-1ff2d8cf"]]);var Ua=Ta;function Fa(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("el-checkbox");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(n,{modelValue:i.isDebt,"onUpdate:modelValue":t[0]||(t[0]=e=>i.isDebt=e),onChange:r.setDebt,label:"Включить долг на конец года"},null,8,["modelValue","onChange"])])])}var Aa={data(){return{isDebt:!1}},methods:{...Object(I["b"])(["getDebt","saveDebt"]),setDebt:async function(){await this.saveDebt({token:localStorage.getItem("crm_token"),active:Number(this.isDebt)})}},async mounted(){this.isDebt=await this.getDebt({token:localStorage.getItem("crm_token")})}};a("26d6");const La=T()(Aa,[["render",Fa],["__scopeId","data-v-261e8eb0"]]);var qa=La,$a={components:{TimeZone:ja,Users:Ua,Debt:qa},data(){var e,t;return{is_admin:null===(e=JSON.parse(localStorage.getItem("user_data")))||void 0===e||null===(t=e.rights)||void 0===t?void 0:t.is_admin}},methods:{}};a("1ad6");const za=T()($a,[["render",sa],["__scopeId","data-v-42bc502f"]]);var Pa=za,Ha={props:{title:{type:String,require:!0}},components:{Main:oe,Settings:Pa},data(){return{}},methods:{},beforeMount(){document.title=this.title}};const Ra=T()(Ha,[["render",ca]]);var Ja=Ra;const Ya=Object(l["createElementVNode"])("h2",null,"Настройки пользователя",-1);function Wa(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("UserSettings",!0),c=Object(l["resolveComponent"])("Main");return Object(l["openBlock"])(),Object(l["createBlock"])(c,null,{default:Object(l["withCtx"])(()=>[Ya,Object(l["createVNode"])(n)]),_:1})}function Ka(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("UserData"),c=Object(l["resolveComponent"])("el-tab-pane"),s=Object(l["resolveComponent"])("ChangePassword"),d=Object(l["resolveComponent"])("UploadAvatar"),b=Object(l["resolveComponent"])("el-tabs");return Object(l["openBlock"])(),Object(l["createBlock"])(b,{type:"border-card"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(c,{label:"Личные данные"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n)]),_:1}),Object(l["createVNode"])(c,{label:"Пароль"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s)]),_:1}),Object(l["createVNode"])(c,{label:"Аватарка"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d)]),_:1})]),_:1})}const Za=Object(l["createTextVNode"])(" Сохранить ");function Ga(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("el-input"),c=Object(l["resolveComponent"])("el-form-item"),s=Object(l["resolveComponent"])("el-button"),d=Object(l["resolveComponent"])("el-form");return Object(l["openBlock"])(),Object(l["createBlock"])(d,{ref:"dynamicValidateForm",model:i.fields,"label-width":"80px"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(c,{disabled:i.loading,rules:i.rules.login,label:"Логин",prop:"login"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{modelValue:i.fields.login,"onUpdate:modelValue":t[0]||(t[0]=e=>i.fields.login=e),maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(c,{disabled:i.loading,rules:i.rules.email,label:"Email",prop:"email"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{modelValue:i.fields.email,"onUpdate:modelValue":t[1]||(t[1]=e=>i.fields.email=e),maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(c,null,{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{disabled:i.loading,type:"primary",onClick:t[2]||(t[2]=e=>r.submitForm("dynamicValidateForm"))},{default:Object(l["withCtx"])(()=>[Za]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"])}var Xa={data(){return{loading:!1,fields:{login:"",email:""},rules:{email:[{required:!0,message:"Пожалуйста, укажите адрес электронной почты",trigger:"blur"},{type:"email",message:"Пожалуйста, введите корректный адрес электронной почты",trigger:["blur","change"]}],login:[{required:!0,message:"Пожалуйста, укажите адрес электронной почты",trigger:"blur"}]}}},methods:{...Object(I["b"])(["update_info"]),submitForm(e){this.$refs[e].validate(async e=>{if(!e)return this.loading=!1,!1;{this.loading=!0;const e=JSON.parse(localStorage.getItem("user_data"));await this.update_info({login:this.fields.login,email:this.fields.email,id:e.id,token:localStorage.getItem("crm_token")}),this.loading=!1}})}},async mounted(){const e=JSON.parse(localStorage.getItem("user_data"));this.fields.email=e.email,this.fields.login=e.login}};a("20fb");const Qa=T()(Xa,[["render",Ga],["__scopeId","data-v-e59e2744"]]);var el=Qa;const tl=Object(l["createTextVNode"])(" Сохранить ");function al(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("el-input"),c=Object(l["resolveComponent"])("el-form-item"),s=Object(l["resolveComponent"])("el-button"),d=Object(l["resolveComponent"])("el-form");return Object(l["openBlock"])(),Object(l["createBlock"])(d,{ref:"dynamicValidateForm",model:i.fields,"label-width":"80px"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(c,{disabled:i.loading,rules:i.rules.password,label:"Пароль",prop:"password"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{modelValue:i.fields.password,"onUpdate:modelValue":t[0]||(t[0]=e=>i.fields.password=e),maxlength:"100","show-word-limit":"",type:"password"},null,8,["modelValue"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(c,null,{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{disabled:i.loading,type:"primary",onClick:t[1]||(t[1]=e=>r.submitForm("dynamicValidateForm"))},{default:Object(l["withCtx"])(()=>[tl]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"])}var ll={data(){return{loading:!1,fields:{password:""},rules:{password:[{required:!0,message:"Пожалуйста, укажите пароль",trigger:"blur"},{required:!0,message:"Минимальная длинна пароля должна быть не менее 5 символов",trigger:["blur","change"],min:5}]}}},methods:{...Object(I["b"])(["change_password"]),submitForm(e){this.$refs[e].validate(async e=>{if(!e)return this.loading=!1,!1;{this.loading=!0;const e=JSON.parse(localStorage.getItem("user_data")),t=await this.change_password({password:this.fields.password,id:e.id,token:localStorage.getItem("crm_token")});t?(this.loading=!1,this.fields.password=""):this.loading=!1}})}},async mounted(){const e=JSON.parse(localStorage.getItem("user_data"));this.fields.email=e.email,this.fields.login=e.login}};a("5bc4");const ol=T()(ll,[["render",al],["__scopeId","data-v-8a36e324"]]);var il=ol;const rl=e=>(Object(l["pushScopeId"])("data-v-f44a0264"),e=e(),Object(l["popScopeId"])(),e),nl=rl(()=>Object(l["createElementVNode"])("p",null,"Сменить аватар",-1)),cl=rl(()=>Object(l["createElementVNode"])("i",{class:"el-icon-plus"},null,-1)),sl=["src"];function dl(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("el-upload"),c=Object(l["resolveDirective"])("loading");return Object(l["openBlock"])(),Object(l["createElementBlock"])(l["Fragment"],null,[nl,Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[i.visibleBtn?(Object(l["openBlock"])(),Object(l["createBlock"])(n,{key:0,"auto-upload":!1,"on-change":r.upload,action:"#",class:"avatar-uploader","list-type":"picture-card"},{default:Object(l["withCtx"])(()=>[cl]),_:1},8,["on-change"])):(Object(l["openBlock"])(),Object(l["createElementBlock"])("img",{key:1,src:i.dialogImageUrl,alt:"",class:"avatar"},null,8,sl))])),[[c,i.loading]])],64)}var bl={data(){return{dialogImageUrl:"",visibleBtn:!0,loading:!1}},methods:{...Object(I["b"])(["upload_avatar"]),async upload(e){this.dialogImageUrl=URL.createObjectURL(e.raw),this.visibleBtn=!1,this.loading=!0;const t=JSON.parse(localStorage.getItem("user_data")),a=document.querySelector(".el-upload__input").files[0];await this.upload_avatar({avatar:a,id:t.id,token:localStorage.getItem("crm_token")}),this.dialogImageUrl="",this.visibleBtn=!0,this.loading=!1}}};a("7231");const ul=T()(bl,[["render",dl],["__scopeId","data-v-f44a0264"]]);var ml=ul,pl={components:{UserData:el,ChangePassword:il,UploadAvatar:ml},data(){return{}},methods:{}};a("8513");const jl=T()(pl,[["render",Ka],["__scopeId","data-v-55bb07d7"]]);var Ol=jl,hl={props:{title:{type:String,require:!0}},components:{Main:oe,UserSettings:Ol},data(){return{}},methods:{},beforeMount(){document.title=this.title}};const _l=T()(hl,[["render",Wa]]);var gl=_l;const fl=Object(l["createElementVNode"])("h2",null,"Список материалов",-1);function vl(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("Materials",!0),c=Object(l["resolveComponent"])("Main");return Object(l["openBlock"])(),Object(l["createBlock"])(c,null,{default:Object(l["withCtx"])(()=>[fl,Object(l["createVNode"])(n)]),_:1})}const yl=e=>(Object(l["pushScopeId"])("data-v-4bdf9bf0"),e=e(),Object(l["popScopeId"])(),e),Vl={class:"wrapper"},wl=yl(()=>Object(l["createElementVNode"])("br",null,null,-1));function kl(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("Search"),c=Object(l["resolveComponent"])("CreateMaterial"),s=Object(l["resolveComponent"])("el-table-column"),d=Object(l["resolveComponent"])("EditMaterial"),b=Object(l["resolveComponent"])("el-table"),u=Object(l["resolveComponent"])("el-pagination"),m=Object(l["resolveComponent"])("el-card"),p=Object(l["resolveDirective"])("loading");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",Vl,[Object(l["createVNode"])(n),Object(l["createVNode"])(c,{material_types:i.material_types.types,class:"create"},null,8,["material_types"]),Object(l["createVNode"])(m,{shadow:"never"},{default:Object(l["withCtx"])(()=>{var t;return[Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createBlock"])(b,{data:i.materials.materials,"default-sort":{prop:"id",order:"descending"},"empty-text":"Данных нет",style:{width:"100%"}},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{label:"ID",prop:"id",sortable:"",width:"80"}),Object(l["createVNode"])(s,{label:"Тип",prop:"type",sortable:""}),Object(l["createVNode"])(s,{label:"Название",prop:"name",sortable:""}),Object(l["createVNode"])(s,{label:"Действие",width:"85"},{default:Object(l["withCtx"])(e=>[Object(l["createVNode"])(d,{data:e.row,material_types:i.material_types.types},null,8,["data","material_types"])]),_:1})]),_:1},8,["data"])),[[p,i.loading]]),wl,Object(l["createVNode"])(u,{"page-size":(null===(t=e.getSearchWordMaterial)||void 0===t?void 0:t.length)>0?1e3:10,total:Number(i.materials.count),background:"",class:"pagination","hide-on-single-page":"",layout:"prev, pager, next",onNextClick:r.get_material,onPrevClick:r.get_material,onCurrentChange:r.get_material},null,8,["page-size","total","onNextClick","onPrevClick","onCurrentChange"])]}),_:1})])}const Cl={class:"dialog-footer"},Nl=Object(l["createTextVNode"])("Отменить"),xl=Object(l["createTextVNode"])(" Сохранить ");function Bl(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("font-awesome-icon"),c=Object(l["resolveComponent"])("el-button"),s=Object(l["resolveComponent"])("el-input"),d=Object(l["resolveComponent"])("el-form-item"),b=Object(l["resolveComponent"])("el-option"),u=Object(l["resolveComponent"])("el-select"),m=Object(l["resolveComponent"])("el-form"),p=Object(l["resolveComponent"])("el-dialog");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object(l["createVNode"])(c,{circle:"",type:"success",onClick:t[0]||(t[0]=e=>i.dialogVisible=!0)},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{icon:"plus"})]),_:1}),Object(l["createVNode"])(p,{modelValue:i.dialogVisible,"onUpdate:modelValue":t[5]||(t[5]=e=>i.dialogVisible=e),title:"Создание материала"},{footer:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",Cl,[Object(l["createVNode"])(c,{disabled:i.loading,onClick:t[4]||(t[4]=Object(l["withModifiers"])(e=>i.dialogVisible=!1,["prevent"]))},{default:Object(l["withCtx"])(()=>[Nl]),_:1},8,["disabled"]),Object(l["createVNode"])(c,{disabled:i.loading,type:"primary",onClick:Object(l["withModifiers"])(r.submitForm,["prevent"])},{default:Object(l["withCtx"])(()=>[xl]),_:1},8,["disabled","onClick"])])]),default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(m,{ref:"createMaterial",model:i.fields,"label-width":"130px",onSubmit:t[3]||(t[3]=Object(l["withModifiers"])(()=>{},["prevent","stop"]))},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{disabled:i.loading,rules:i.rules.name,label:"Название",prop:"name"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{modelValue:i.fields.name,"onUpdate:modelValue":t[1]||(t[1]=e=>i.fields.name=e),maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(d,{disabled:i.loading,rules:i.rules.type_id,label:"Тип материала",prop:"type_id"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{modelValue:i.fields.type_id,"onUpdate:modelValue":t[2]||(t[2]=e=>i.fields.type_id=e),"no-data-text":"Типы материалов не найдены. Добавьте новый",placeholder:"Выберите тип материала"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(a.material_types,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(b,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["disabled","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue"])])}var Sl={props:{material_types:{require:!0,type:Array}},data(){return{fields:{name:"",type_id:""},options:[],loading:!1,dialogVisible:!1,rules:{name:[{required:!0,message:"Пожалуйста, укажите название типа материала",trigger:"blur"}],type_id:[{required:!0,message:"Пожалуйста, выберите типа материала",trigger:"blur"}]}}},methods:{...Object(I["b"])(["saveMaterial","getAllMaterialTypes"]),submitForm:function(){this.$refs["createMaterial"].validate(async e=>{if(!e)return this.loading=!1,!1;{this.loading=!0;const e=await this.saveMaterial({name:this.fields.name,type_id:this.fields.type_id,token:localStorage.getItem("crm_token")});e?(this.loading=!1,this.fields.type_id="",this.fields.name="",this.dialogVisible=!1):this.loading=!1}})}}};a("16fc");const Il=T()(Sl,[["render",Bl],["__scopeId","data-v-5a49e668"]]);var El=Il;const Ml={class:"dialog-footer"},Dl=Object(l["createTextVNode"])("Отменить"),Tl=Object(l["createTextVNode"])(" Сохранить ");function Ul(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("font-awesome-icon"),c=Object(l["resolveComponent"])("el-button"),s=Object(l["resolveComponent"])("el-input"),d=Object(l["resolveComponent"])("el-form-item"),b=Object(l["resolveComponent"])("el-option"),u=Object(l["resolveComponent"])("el-select"),m=Object(l["resolveComponent"])("el-form"),p=Object(l["resolveComponent"])("el-dialog");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object(l["createVNode"])(c,{type:"primary",onClick:t[0]||(t[0]=e=>i.dialogVisible=!0)},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{icon:"edit"})]),_:1}),Object(l["createVNode"])(p,{modelValue:i.dialogVisible,"onUpdate:modelValue":t[5]||(t[5]=e=>i.dialogVisible=e),title:"Редактирование материала"},{footer:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",Ml,[Object(l["createVNode"])(c,{disabled:i.loading,onClick:t[4]||(t[4]=Object(l["withModifiers"])(e=>i.dialogVisible=!1,["prevent"]))},{default:Object(l["withCtx"])(()=>[Dl]),_:1},8,["disabled"]),Object(l["createVNode"])(c,{disabled:i.loading,type:"primary",onClick:Object(l["withModifiers"])(r.submitForm,["prevent"])},{default:Object(l["withCtx"])(()=>[Tl]),_:1},8,["disabled","onClick"])])]),default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(m,{ref:"editMaterial",model:i.fields,"label-width":"130px",onSubmit:t[3]||(t[3]=Object(l["withModifiers"])(()=>{},["prevent","stop"]))},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{disabled:i.loading,rules:i.rules.name,label:"Название",prop:"name"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{modelValue:i.fields.name,"onUpdate:modelValue":t[1]||(t[1]=e=>i.fields.name=e),maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(d,{disabled:i.loading,rules:i.rules.type_id,label:"Тип материала",prop:"type_id"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{modelValue:i.fields.type_id,"onUpdate:modelValue":t[2]||(t[2]=e=>i.fields.type_id=e),"no-data-text":"Типы материалов не найдены. Добавьте новый",placeholder:"Выберите тип материала"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(a.material_types,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(b,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["disabled","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue"])])}var Fl={props:{data:{require:!0,type:Object},material_types:{require:!0,type:Array}},data(){return{fields:{name:"",type_id:""},options:[],loading:!1,dialogVisible:!1,rules:{name:[{required:!0,message:"Пожалуйста, укажите название типа материала",trigger:"blur"}],type_id:[{required:!0,message:"Пожалуйста, выберите типа материала",trigger:"blur"}]}}},methods:{...Object(I["b"])(["updateMaterial"]),submitForm:function(){this.$refs["editMaterial"].validate(async e=>{if(!e)return this.loading=!1,!1;{this.loading=!0;const e=await this.updateMaterial({id:this.data.id,name:this.fields.name,type_id:this.fields.type_id,token:localStorage.getItem("crm_token")});e?(this.loading=!1,this.fields.type_id="",this.fields.name="",this.dialogVisible=!1):this.loading=!1}})}},async mounted(){this.fields.name=this.data.name,this.fields.type_id=this.data.type_id},watch:{data(e){this.fields.name=e.name,this.fields.type_id=e.type_id}}};a("2859");const Al=T()(Fl,[["render",Ul],["__scopeId","data-v-1700ba79"]]);var Ll=Al;const ql={class:"query_material"};function $l(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("el-input"),c=Object(l["resolveComponent"])("font-awesome-icon"),s=Object(l["resolveComponent"])("el-button");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",ql,[Object(l["createVNode"])(n,{modelValue:i.query,"onUpdate:modelValue":t[0]||(t[0]=e=>i.query=e),maxlength:"100","show-word-limit":"",class:"query_material_field",onKeydown:Object(l["withKeys"])(r.search,["enter"]),placeholder:"Введите название материала"},null,8,["modelValue","onKeydown"]),Object(l["createVNode"])(s,{type:"primary",onClick:r.search,disabled:i.active_btn},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(c,{icon:"search"})]),_:1},8,["onClick","disabled"])])}var zl={name:"Search",data(){return{query:"",active_btn:!0}},methods:{...Object(I["b"])(["setSearchWordMaterial","setIsSearchMaterial","setIsNewMaterial"]),async search(){this.setSearchWordMaterial(this.query),this.setIsSearchMaterial(Math.random())}},watch:{query:function(){this.query.length>0&&!0===this.active_btn&&(this.active_btn=!1),0===this.query.length&&!1===this.active_btn&&(this.active_btn=!0,this.setIsNewMaterial(Math.random()),this.setSearchWordMaterial(""))}}};a("89f6");const Pl=T()(zl,[["render",$l],["__scopeId","data-v-a2be0280"]]);var Hl=Pl,Rl={components:{Search:Hl,CreateMaterial:El,EditMaterial:Ll},data(){return{materials:[],loading:!1,material_types:[],offset:0}},methods:{...Object(I["b"])(["getAllMaterials","getAllMaterialTypes","searchMaterial"]),async get_materials(){this.loading=!0,this.materials=await this.getAllMaterials({token:localStorage.getItem("crm_token"),offset:this.offset,limit:10}),this.loading=!1},get_material:function(e){this.offset=10*e-10,this.get_materials()},async search_materials(e){this.loading=!0,this.materials=await this.searchMaterial({token:localStorage.getItem("crm_token"),query:e}),this.loading=!1}},async mounted(){await this.get_materials(),this.material_types=await this.getAllMaterialTypes({token:localStorage.getItem("crm_token")})},computed:{...Object(I["c"])(["getIsNewMaterial","getIsSearchMaterial","getSearchWordMaterial"])},watch:{getIsNewMaterial:async function(){await this.get_materials()},getIsSearchMaterial:async function(){await this.search_materials(this.getSearchWordMaterial)}}};a("d24c");const Jl=T()(Rl,[["render",kl],["__scopeId","data-v-4bdf9bf0"]]);var Yl=Jl,Wl={props:{title:{type:String,require:!0}},components:{Main:oe,Materials:Yl},data(){return{}},methods:{},beforeMount(){document.title=this.title}};const Kl=T()(Wl,[["render",vl]]);var Zl=Kl;const Gl=Object(l["createElementVNode"])("h2",null,"Список объектов",-1);function Xl(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("Objects",!0),c=Object(l["resolveComponent"])("Main");return Object(l["openBlock"])(),Object(l["createBlock"])(c,null,{default:Object(l["withCtx"])(()=>[Gl,Object(l["createVNode"])(n)]),_:1})}const Ql=e=>(Object(l["pushScopeId"])("data-v-5fdaa671"),e=e(),Object(l["popScopeId"])(),e),eo={class:"wrapper"},to=Ql(()=>Object(l["createElementVNode"])("br",null,null,-1)),ao=Ql(()=>Object(l["createElementVNode"])("br",null,null,-1));function lo(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("Search"),c=Object(l["resolveComponent"])("CreateObject"),s=Object(l["resolveComponent"])("el-table-column"),d=Object(l["resolveComponent"])("EditObject"),b=Object(l["resolveComponent"])("font-awesome-icon"),u=Object(l["resolveComponent"])("el-button"),m=Object(l["resolveComponent"])("el-popconfirm"),p=Object(l["resolveComponent"])("el-table"),j=Object(l["resolveComponent"])("el-pagination"),O=Object(l["resolveComponent"])("el-tab-pane"),h=Object(l["resolveComponent"])("el-tabs"),_=Object(l["resolveDirective"])("loading");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",eo,[Object(l["createVNode"])(n),Object(l["createVNode"])(c,{class:"create"}),Object(l["createVNode"])(h,{type:"border-card",onTabClick:r.set_tab},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(O,{name:String(0),label:"Активные"},{default:Object(l["withCtx"])(()=>{var t;return[Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createBlock"])(p,{data:i.objects.objects,"default-sort":{prop:"id",order:"descending"},"empty-text":"Данных нет",style:{width:"100%"}},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{label:"ID",prop:"id",sortable:"",width:"80"}),Object(l["createVNode"])(s,{label:"Название",prop:"name",sortable:""}),Object(l["createVNode"])(s,{label:"Действие",width:"145"},{default:Object(l["withCtx"])(e=>[Object(l["createVNode"])(d,{data:e.row,class:"block"},null,8,["data"]),Object(l["createVNode"])(m,{"confirm-button-text":"Естественно","cancel-button-text":"Стой! Оставь","icon-color":"red",title:"Вы точно хотите удалить?",onConfirm:t=>r.remove(e.row.id)},{reference:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{class:"remove",type:"danger"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(b,{icon:"trash"})]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[_,i.loading]]),to,Object(l["createVNode"])(j,{"current-page":i.pagination[i.current_tab],"page-size":(null===(t=e.getSearchWordObject)||void 0===t?void 0:t.length)>0?1e3:10,total:Number(i.objects.count),background:"",class:"pagination","hide-on-single-page":"",layout:"prev, pager, next",onNextClick:r.get_object,onPrevClick:r.get_object,onCurrentChange:r.get_object},null,8,["current-page","page-size","total","onNextClick","onPrevClick","onCurrentChange"])]}),_:1},8,["name"]),Object(l["createVNode"])(O,{name:String(1),label:"Архивные"},{default:Object(l["withCtx"])(()=>[Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createBlock"])(p,{data:i.archive_objects.objects,"default-sort":{prop:"id",order:"descending"},class:"gray","empty-text":"Данных нет",style:{width:"100%"}},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{label:"ID",prop:"id",sortable:"",width:"80"}),Object(l["createVNode"])(s,{label:"Название",prop:"name",sortable:""}),Object(l["createVNode"])(s,{label:"Действие",width:"85"},{default:Object(l["withCtx"])(e=>[Object(l["createVNode"])(u,{class:"remove",plain:"",type:"info",onClick:t=>r.restore(e.row.id)},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(b,{icon:"trash-restore"})]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[_,i.loading]]),ao,Object(l["createVNode"])(j,{"current-page":i.pagination[i.current_tab],"page-size":10,total:Number(i.archive_objects.count),background:"",class:"pagination","hide-on-single-page":"",layout:"prev, pager, next",onNextClick:r.get_object,onPrevClick:r.get_object,onCurrentChange:r.get_object},null,8,["current-page","total","onNextClick","onPrevClick","onCurrentChange"])]),_:1},8,["name"])]),_:1},8,["onTabClick"])])}const oo={class:"dialog-footer"},io=Object(l["createTextVNode"])("Отменить"),ro=Object(l["createTextVNode"])(" Сохранить ");function no(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("font-awesome-icon"),c=Object(l["resolveComponent"])("el-button"),s=Object(l["resolveComponent"])("el-input"),d=Object(l["resolveComponent"])("el-form-item"),b=Object(l["resolveComponent"])("el-form"),u=Object(l["resolveComponent"])("el-dialog");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object(l["createVNode"])(c,{circle:"",type:"success",onClick:t[0]||(t[0]=e=>i.dialogVisible=!0)},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{icon:"plus"})]),_:1}),Object(l["createVNode"])(u,{modelValue:i.dialogVisible,"onUpdate:modelValue":t[4]||(t[4]=e=>i.dialogVisible=e),title:"Создание объекта"},{footer:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",oo,[Object(l["createVNode"])(c,{disabled:i.loading,onClick:t[3]||(t[3]=Object(l["withModifiers"])(e=>i.dialogVisible=!1,["prevent"]))},{default:Object(l["withCtx"])(()=>[io]),_:1},8,["disabled"]),Object(l["createVNode"])(c,{disabled:i.loading,type:"primary",onClick:Object(l["withModifiers"])(r.submitForm,["prevent"])},{default:Object(l["withCtx"])(()=>[ro]),_:1},8,["disabled","onClick"])])]),default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(b,{ref:"createObject",model:i.fields,"label-width":"120px",onSubmit:t[2]||(t[2]=Object(l["withModifiers"])(()=>{},["prevent","stop"]))},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{disabled:i.loading,rules:i.rules.name,label:"Название",prop:"name"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{modelValue:i.fields.name,"onUpdate:modelValue":t[1]||(t[1]=e=>i.fields.name=e),maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1},8,["disabled","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue"])])}var co={data(){return{fields:{name:""},loading:!1,dialogVisible:!1,rules:{name:[{required:!0,message:"Пожалуйста, укажите название типа материала",trigger:"blur"}]}}},methods:{...Object(I["b"])(["saveObject"]),submitForm:function(){this.$refs["createObject"].validate(async e=>{if(!e)return this.loading=!1,this.fields.name="",!1;{this.loading=!0;const e=await this.saveObject({name:this.fields.name,token:localStorage.getItem("crm_token")});e?(this.loading=!1,this.fields.name="",this.dialogVisible=!1):this.loading=!1}})}}};a("7b59");const so=T()(co,[["render",no],["__scopeId","data-v-b35ecca4"]]);var bo=so;const uo={class:"dialog-footer"},mo=Object(l["createTextVNode"])("Отменить"),po=Object(l["createTextVNode"])(" Сохранить ");function jo(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("font-awesome-icon"),c=Object(l["resolveComponent"])("el-button"),s=Object(l["resolveComponent"])("el-input"),d=Object(l["resolveComponent"])("el-form-item"),b=Object(l["resolveComponent"])("el-form"),u=Object(l["resolveComponent"])("el-dialog");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object(l["createVNode"])(c,{type:"primary",onClick:t[0]||(t[0]=e=>i.dialogVisible=!0)},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{icon:"edit"})]),_:1}),Object(l["createVNode"])(u,{modelValue:i.dialogVisible,"onUpdate:modelValue":t[4]||(t[4]=e=>i.dialogVisible=e),title:"Создание объекта"},{footer:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",uo,[Object(l["createVNode"])(c,{disabled:i.loading,onClick:t[3]||(t[3]=Object(l["withModifiers"])(e=>i.dialogVisible=!1,["prevent"]))},{default:Object(l["withCtx"])(()=>[mo]),_:1},8,["disabled"]),Object(l["createVNode"])(c,{disabled:i.loading,type:"primary",onClick:Object(l["withModifiers"])(r.submitForm,["prevent"])},{default:Object(l["withCtx"])(()=>[po]),_:1},8,["disabled","onClick"])])]),default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(b,{ref:"createObject",model:i.fields,"label-width":"120px",onSubmit:t[2]||(t[2]=Object(l["withModifiers"])(()=>{},["prevent","stop"]))},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{disabled:i.loading,rules:i.rules.name,label:"Название",prop:"name"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{modelValue:i.fields.name,"onUpdate:modelValue":t[1]||(t[1]=e=>i.fields.name=e),maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1},8,["disabled","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue"])])}var Oo={props:{data:{require:!0,type:Object}},data(){return{fields:{name:""},options:[],loading:!1,dialogVisible:!1,rules:{name:[{required:!0,message:"Пожалуйста, укажите название типа материала",trigger:"blur"}]}}},methods:{...Object(I["b"])(["updateObject"]),submitForm:function(){this.$refs["createObject"].validate(async e=>{if(!e)return this.loading=!1,this.fields.name="",!1;{this.loading=!0;const e=await this.updateObject({id:this.data.id,name:this.fields.name,token:localStorage.getItem("crm_token")});e?(this.loading=!1,this.fields.name="",this.dialogVisible=!1):this.loading=!1}})}},async mounted(){this.fields.name=this.data.name},computed:{...Object(I["c"])(["getIcon"])},watch:{data(e){this.fields.name=e.name}}};a("5190");const ho=T()(Oo,[["render",jo],["__scopeId","data-v-dad65172"]]);var _o=ho;const go={class:"query_object"};function fo(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("el-input"),c=Object(l["resolveComponent"])("font-awesome-icon"),s=Object(l["resolveComponent"])("el-button");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",go,[Object(l["createVNode"])(n,{modelValue:i.query,"onUpdate:modelValue":t[0]||(t[0]=e=>i.query=e),maxlength:"100","show-word-limit":"",class:"query_object_field",onKeydown:Object(l["withKeys"])(r.search,["enter"]),placeholder:"Введите название объекта"},null,8,["modelValue","onKeydown"]),Object(l["createVNode"])(s,{type:"primary",onClick:r.search,disabled:i.active_btn},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(c,{icon:"search"})]),_:1},8,["onClick","disabled"])])}var vo={name:"Search",data(){return{query:"",active_btn:!0}},methods:{...Object(I["b"])(["setSearchWordObject","setIsSearchObject","setIsNewObject"]),async search(){this.setSearchWordObject(this.query),this.setIsSearchObject(Math.random())}},watch:{query:function(){this.query.length>0&&!0===this.active_btn&&(this.active_btn=!1),0===this.query.length&&!1===this.active_btn&&(this.active_btn=!0,this.setIsNewObject(Math.random()),this.setSearchWordObject(""))}}};a("0052");const yo=T()(vo,[["render",fo],["__scopeId","data-v-627f2a18"]]);var Vo=yo,wo={components:{Search:Vo,CreateObject:bo,EditObject:_o},data(){return{loading:!1,objects:[],current_tab:0,archive_objects:[],pagination:{0:1,1:1},offsets:{0:0,1:0}}},methods:{...Object(I["b"])(["getAllObjects","getAllVendors","deleteObject","restoreObject","searchObject"]),get_object:function(e){this.offsets[this.current_tab]=10*e-10,this.pagination[this.current_tab]=e,this.get_objects()},async get_objects(){this.loading=!0,this.objects=await this.getAllObjects({token:localStorage.getItem("crm_token"),offset:this.offsets[0],limit:10,archive:0}),this.archive_objects=await this.getAllObjects({token:localStorage.getItem("crm_token"),offset:this.offsets[1],limit:10,archive:1}),this.loading=!1},remove:async function(e){var t,a;(null===(t=this.archive_objects)||void 0===t||null===(a=t.legal_entities)||void 0===a?void 0:a.length)<2&&(this.offsets[0]=0,this.pagination[0]=0),await this.deleteObject({id:e,token:localStorage.getItem("crm_token")})},restore:async function(e){var t,a;(null===(t=this.archive_objects)||void 0===t||null===(a=t.legal_entities)||void 0===a?void 0:a.length)<2&&(this.offsets[1]=0,this.pagination[1]=0),await this.restoreObject({id:e,token:localStorage.getItem("crm_token")})},set_tab:function(e){this.current_tab=e.props.name},async search_objects(e){this.loading=!0,this.objects=await this.searchObject({token:localStorage.getItem("crm_token"),query:e}),this.loading=!1}},async mounted(){await this.get_objects()},computed:{...Object(I["c"])(["getIsNewObject","getIsSearchObject","getSearchWordObject"])},watch:{getIsNewObject:async function(){await this.get_objects()},getIsSearchObject:async function(){await this.search_objects(this.getSearchWordObject)}}};a("4c17");const ko=T()(wo,[["render",lo],["__scopeId","data-v-5fdaa671"]]);var Co=ko,No={props:{title:{type:String,require:!0}},components:{Main:oe,Objects:Co},data(){return{}},methods:{},beforeMount(){document.title=this.title}};const xo=T()(No,[["render",Xl]]);var Bo=xo;const So=Object(l["createElementVNode"])("h2",null,"Типы материалов",-1);function Io(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("MaterialTypes",!0),c=Object(l["resolveComponent"])("Main");return Object(l["openBlock"])(),Object(l["createBlock"])(c,null,{default:Object(l["withCtx"])(()=>[So,Object(l["createVNode"])(n)]),_:1})}const Eo=e=>(Object(l["pushScopeId"])("data-v-24232d39"),e=e(),Object(l["popScopeId"])(),e),Mo={class:"wrapper"},Do=Eo(()=>Object(l["createElementVNode"])("br",null,null,-1));function To(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("AddMaterialType"),c=Object(l["resolveComponent"])("el-table-column"),s=Object(l["resolveComponent"])("EditMaterialType"),d=Object(l["resolveComponent"])("el-table"),b=Object(l["resolveComponent"])("el-pagination"),u=Object(l["resolveComponent"])("el-card"),m=Object(l["resolveDirective"])("loading");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",Mo,[Object(l["createVNode"])(n,{units_measurement_volume:i.units_measurement_volume,class:"create"},null,8,["units_measurement_volume"]),Object(l["createVNode"])(u,{shadow:"never"},{default:Object(l["withCtx"])(()=>[Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createBlock"])(d,{data:i.material_types.types,"default-sort":{prop:"id",order:"descending"},"empty-text":"Данных нет",style:{width:"100%"}},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(c,{label:"ID",prop:"id",sortable:"",width:"80"}),Object(l["createVNode"])(c,{label:"Величина объема",prop:"units_measurement_volume.name",sortable:"",width:"260"}),Object(l["createVNode"])(c,{label:"Название",prop:"name",sortable:""}),Object(l["createVNode"])(c,{label:"Действие",width:"85"},{default:Object(l["withCtx"])(e=>[Object(l["createVNode"])(s,{data:e.row,units_measurement_volume:i.units_measurement_volume},null,8,["data","units_measurement_volume"])]),_:1})]),_:1},8,["data"])),[[m,i.loading]]),Do,Object(l["createVNode"])(b,{"page-size":10,total:Number(i.material_types.count),background:"",class:"pagination","hide-on-single-page":"",layout:"prev, pager, next",onNextClick:r.get_types,onPrevClick:r.get_types,onCurrentChange:r.get_types},null,8,["total","onNextClick","onPrevClick","onCurrentChange"])]),_:1})])}const Uo={class:"dialog-footer"},Fo=Object(l["createTextVNode"])("Отменить"),Ao=Object(l["createTextVNode"])(" Сохранить ");function Lo(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("font-awesome-icon"),c=Object(l["resolveComponent"])("el-button"),s=Object(l["resolveComponent"])("el-input"),d=Object(l["resolveComponent"])("el-form-item"),b=Object(l["resolveComponent"])("el-option"),u=Object(l["resolveComponent"])("el-select"),m=Object(l["resolveComponent"])("el-form"),p=Object(l["resolveComponent"])("el-dialog");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object(l["createVNode"])(c,{type:"success",circle:"",onClick:t[0]||(t[0]=e=>i.dialogVisible=!0)},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{icon:"plus"})]),_:1}),Object(l["createVNode"])(p,{modelValue:i.dialogVisible,"onUpdate:modelValue":t[5]||(t[5]=e=>i.dialogVisible=e),title:"Создание типа материала"},{footer:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",Uo,[Object(l["createVNode"])(c,{onClick:t[4]||(t[4]=Object(l["withModifiers"])(e=>i.dialogVisible=!1,["prevent"])),disabled:i.loading},{default:Object(l["withCtx"])(()=>[Fo]),_:1},8,["disabled"]),Object(l["createVNode"])(c,{type:"primary",onClick:Object(l["withModifiers"])(r.submitForm,["prevent"]),disabled:i.loading},{default:Object(l["withCtx"])(()=>[Ao]),_:1},8,["onClick","disabled"])])]),default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(m,{model:i.fields,"label-width":"150px",ref:"createMaterialType",onSubmit:t[3]||(t[3]=Object(l["withModifiers"])(()=>{},["prevent","stop"]))},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{prop:"name",label:"Название",rules:i.rules.name,disabled:i.loading},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{modelValue:i.fields.name,"onUpdate:modelValue":t[1]||(t[1]=e=>i.fields.name=e),maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1},8,["rules","disabled"]),Object(l["createVNode"])(d,{prop:"units_measurement_volume_id",label:"Величина объема",rules:i.rules.units_measurement_volume_id,disabled:i.loading},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{modelValue:i.fields.units_measurement_volume_id,"onUpdate:modelValue":t[2]||(t[2]=e=>i.fields.units_measurement_volume_id=e),placeholder:"Выберите величину объема","no-data-text":"Величин объема не найдено"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(a.units_measurement_volume,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(b,{key:e.id,value:e.id,label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["rules","disabled"])]),_:1},8,["model"])]),_:1},8,["modelValue"])])}var qo={props:{units_measurement_volume:{require:!0,type:Array}},data(){return{fields:{name:"",units_measurement_volume_id:""},loading:!1,dialogVisible:!1,rules:{name:[{required:!0,message:"Пожалуйста, укажите название типа материала",trigger:"blur"}],units_measurement_volume_id:[{required:!0,message:"Пожалуйста, выберите величину объема",trigger:"blur"}]}}},methods:{...Object(I["b"])(["saveMaterialType"]),submitForm:function(){this.$refs["createMaterialType"].validate(async e=>{if(!e)return this.loading=!1,!1;{this.loading=!0;const e=await this.saveMaterialType({name:this.fields.name,units_measurement_volume_id:this.fields.units_measurement_volume_id,token:localStorage.getItem("crm_token")});e?(this.loading=!1,this.fields.name="",this.fields.units_measurement_volume_id="",this.dialogVisible=!1):this.loading=!1}})}}};a("4c8b");const $o=T()(qo,[["render",Lo],["__scopeId","data-v-30de0887"]]);var zo=$o;const Po={class:"dialog-footer"},Ho=Object(l["createTextVNode"])("Отменить"),Ro=Object(l["createTextVNode"])(" Сохранить ");function Jo(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("font-awesome-icon"),c=Object(l["resolveComponent"])("el-button"),s=Object(l["resolveComponent"])("el-input"),d=Object(l["resolveComponent"])("el-form-item"),b=Object(l["resolveComponent"])("el-option"),u=Object(l["resolveComponent"])("el-select"),m=Object(l["resolveComponent"])("el-form"),p=Object(l["resolveComponent"])("el-dialog");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object(l["createVNode"])(c,{type:"primary",onClick:t[0]||(t[0]=e=>i.dialogVisible=!0)},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{icon:"edit"})]),_:1}),Object(l["createVNode"])(p,{modelValue:i.dialogVisible,"onUpdate:modelValue":t[5]||(t[5]=e=>i.dialogVisible=e),title:"Обновление типа материала"},{footer:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",Po,[Object(l["createVNode"])(c,{disabled:i.loading,onClick:t[4]||(t[4]=Object(l["withModifiers"])(e=>i.dialogVisible=!1,["prevent"]))},{default:Object(l["withCtx"])(()=>[Ho]),_:1},8,["disabled"]),Object(l["createVNode"])(c,{disabled:i.loading,type:"primary",onClick:Object(l["withModifiers"])(r.submitForm,["prevent"])},{default:Object(l["withCtx"])(()=>[Ro]),_:1},8,["disabled","onClick"])])]),default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(m,{ref:"updateMaterialType",model:i.fields,"label-width":"150px",onSubmit:t[3]||(t[3]=Object(l["withModifiers"])(()=>{},["prevent","stop"]))},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{disabled:i.loading,rules:i.rules.name,label:"Название",prop:"name"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{modelValue:i.fields.name,"onUpdate:modelValue":t[1]||(t[1]=e=>i.fields.name=e),maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(d,{disabled:i.loading,rules:i.rules.units_measurement_volume_id,label:"Величина объема",prop:"units_measurement_volume_id"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{modelValue:i.fields.units_measurement_volume_id,"onUpdate:modelValue":t[2]||(t[2]=e=>i.fields.units_measurement_volume_id=e),"no-data-text":"Величин объема не найдено",placeholder:"Выберите величину объема"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(a.units_measurement_volume,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(b,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["disabled","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue"])])}var Yo={props:{data:{require:!0,type:Object},units_measurement_volume:{require:!0,type:Array}},data(){return{fields:{name:"",units_measurement_volume_id:""},loading:!1,dialogVisible:!1,rules:{name:[{required:!0,message:"Пожалуйста, укажите название типа материала",trigger:"blur"}],units_measurement_volume_id:[{required:!0,message:"Пожалуйста, выберите величину объема",trigger:"blur"}]}}},methods:{...Object(I["b"])(["updateMaterialType"]),submitForm:function(){this.$refs["updateMaterialType"].validate(async e=>{if(!e)return this.loading=!1,!1;{this.loading=!0;const e=await this.updateMaterialType({id:this.data.id,name:this.fields.name,units_measurement_volume_id:this.fields.units_measurement_volume_id,token:localStorage.getItem("crm_token")});e?(this.loading=!1,this.fields.name="",this.fields.units_measurement_volume_id="",this.dialogVisible=!1):this.loading=!1}})}},mounted(){this.fields.name=this.data.name,this.fields.units_measurement_volume_id=this.data.units_measurement_volume.id},watch:{data(e){this.fields.name=e.name,this.fields.units_measurement_volume_id=e.units_measurement_volume.id}}};a("d3b0");const Wo=T()(Yo,[["render",Jo],["__scopeId","data-v-05eca110"]]);var Ko=Wo,Zo={components:{AddMaterialType:zo,EditMaterialType:Ko},data(){return{material_types:[],units_measurement_volume:[],loading:!1,offset:0}},methods:{...Object(I["b"])(["getAllMaterialTypes","getAllUnitsMeasurementVolume"]),async get_material_types(){this.loading=!0,this.material_types=await this.getAllMaterialTypes({token:localStorage.getItem("crm_token"),offset:this.offset,limit:10}),this.loading=!1},get_types:function(e){this.offset=10*e-10,this.get_material_types(this.offset)}},async mounted(){await this.get_material_types(),this.units_measurement_volume=await this.getAllUnitsMeasurementVolume(localStorage.getItem("crm_token"))},computed:{...Object(I["c"])(["getIsNewMaterialType"])},watch:{getIsNewMaterialType:async function(){await this.get_material_types()}}};a("3752");const Go=T()(Zo,[["render",To],["__scopeId","data-v-24232d39"]]);var Xo=Go,Qo={props:{title:{type:String,require:!0}},components:{Main:oe,MaterialTypes:Xo},data(){return{}},methods:{},beforeMount(){document.title=this.title}};const ei=T()(Qo,[["render",Io]]);var ti=ei;const ai=Object(l["createElementVNode"])("h2",null,"Юридические лица",-1);function li(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("LegalEntities",!0),c=Object(l["resolveComponent"])("Main");return Object(l["openBlock"])(),Object(l["createBlock"])(c,null,{default:Object(l["withCtx"])(()=>[ai,Object(l["createVNode"])(n)]),_:1})}const oi=e=>(Object(l["pushScopeId"])("data-v-939630ae"),e=e(),Object(l["popScopeId"])(),e),ii={class:"wrapper"},ri=oi(()=>Object(l["createElementVNode"])("br",null,null,-1)),ni=oi(()=>Object(l["createElementVNode"])("br",null,null,-1));function ci(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("CreateLegalEntities"),c=Object(l["resolveComponent"])("el-table-column"),s=Object(l["resolveComponent"])("EditLegalEntities"),d=Object(l["resolveComponent"])("font-awesome-icon"),b=Object(l["resolveComponent"])("el-button"),u=Object(l["resolveComponent"])("el-popconfirm"),m=Object(l["resolveComponent"])("el-table"),p=Object(l["resolveComponent"])("el-pagination"),j=Object(l["resolveComponent"])("el-tab-pane"),O=Object(l["resolveComponent"])("el-tabs"),h=Object(l["resolveDirective"])("loading");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",ii,[Object(l["createVNode"])(n,{legal_entity_types:i.legal_entity_types,class:"create"},null,8,["legal_entity_types"]),Object(l["createVNode"])(O,{type:"border-card",onTabClick:r.set_tab},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(j,{name:String(0),label:"Активные"},{default:Object(l["withCtx"])(()=>[Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createBlock"])(m,{data:i.legal_entities.legal_entities,"default-sort":{prop:"id",order:"descending"},"empty-text":"Данных нет",style:{width:"100%"}},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(c,{label:"ID",prop:"id",sortable:"",width:"80"}),Object(l["createVNode"])(c,{label:"Тип",prop:"legal_entities_type",sortable:"",width:"100"}),Object(l["createVNode"])(c,{label:"Название",prop:"name",sortable:""}),Object(l["createVNode"])(c,{label:"Действие",width:"145"},{default:Object(l["withCtx"])(e=>[Object(l["createVNode"])(s,{data:e.row,legal_entity_types:i.legal_entity_types,class:"block"},null,8,["data","legal_entity_types"]),Object(l["createVNode"])(u,{"confirm-button-text":"Естественно","cancel-button-text":"Стой! Оставь","icon-color":"red",title:"Вы точно хотите удалить?",onConfirm:t=>r.remove(e.row.id)},{reference:Object(l["withCtx"])(()=>[Object(l["createVNode"])(b,{class:"remove",type:"danger"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{icon:"trash"})]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[h,i.loading]]),ri,Object(l["createVNode"])(p,{"page-size":10,total:Number(i.legal_entities.count),background:"",class:"pagination","hide-on-single-page":"",layout:"prev, pager, next",onNextClick:r.get_entity,onPrevClick:r.get_entity,onCurrentChange:r.get_entity},null,8,["total","onNextClick","onPrevClick","onCurrentChange"])]),_:1},8,["name"]),Object(l["createVNode"])(j,{name:String(1),label:"Архивные"},{default:Object(l["withCtx"])(()=>[Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createBlock"])(m,{data:i.archive_legal_entity_types.legal_entities,"default-sort":{prop:"id",order:"descending"},class:"gray","empty-text":"Данных нет",style:{width:"100%"}},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(c,{label:"ID",prop:"id",sortable:"",width:"80"}),Object(l["createVNode"])(c,{label:"Тип",prop:"legal_entities_type",sortable:"",width:"100"}),Object(l["createVNode"])(c,{label:"Название",prop:"name",sortable:""}),Object(l["createVNode"])(c,{label:"Действие",width:"85"},{default:Object(l["withCtx"])(e=>[Object(l["createVNode"])(b,{class:"remove",plain:"",type:"info",onClick:t=>r.restore(e.row.id)},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{icon:"trash-restore"})]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[h,i.loading]]),ni,Object(l["createVNode"])(p,{"current-page":i.pagination[i.current_tab],"page-size":10,total:Number(i.archive_legal_entity_types.count),background:"",class:"pagination","hide-on-single-page":"",layout:"prev, pager, next",onNextClick:r.get_entity,onPrevClick:r.get_entity,onCurrentChange:r.get_entity},null,8,["current-page","total","onNextClick","onPrevClick","onCurrentChange"])]),_:1},8,["name"])]),_:1},8,["onTabClick"])])}const si={class:"name"},di={class:"label"},bi={class:"dialog-footer"},ui=Object(l["createTextVNode"])("Отменить"),mi=Object(l["createTextVNode"])(" Сохранить ");function pi(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("font-awesome-icon"),c=Object(l["resolveComponent"])("el-button"),s=Object(l["resolveComponent"])("el-option"),d=Object(l["resolveComponent"])("el-select"),b=Object(l["resolveComponent"])("el-form-item"),u=Object(l["resolveComponent"])("el-input"),m=Object(l["resolveComponent"])("el-form"),p=Object(l["resolveComponent"])("el-dialog");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object(l["createVNode"])(c,{circle:"",type:"success",onClick:t[0]||(t[0]=e=>i.dialogVisible=!0)},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{icon:"plus"})]),_:1}),Object(l["createVNode"])(p,{modelValue:i.dialogVisible,"onUpdate:modelValue":t[5]||(t[5]=e=>i.dialogVisible=e),title:"Создание нового юридического лица"},{footer:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",bi,[Object(l["createVNode"])(c,{disabled:i.loading,onClick:t[4]||(t[4]=Object(l["withModifiers"])(e=>i.dialogVisible=!1,["prevent"]))},{default:Object(l["withCtx"])(()=>[ui]),_:1},8,["disabled"]),Object(l["createVNode"])(c,{disabled:i.loading,type:"primary",onClick:Object(l["withModifiers"])(r.submitForm,["prevent"])},{default:Object(l["withCtx"])(()=>[mi]),_:1},8,["disabled","onClick"])])]),default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(m,{ref:"createLegalEntities",model:i.fields,"label-width":"130px",onSubmit:t[3]||(t[3]=Object(l["withModifiers"])(()=>{},["prevent","stop"]))},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(b,{disabled:i.loading,rules:i.rules.legal_entities_type_id,label:"Тип управления",prop:"legal_entities_type_id"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{modelValue:i.fields.legal_entities_type_id,"onUpdate:modelValue":t[1]||(t[1]=e=>i.fields.legal_entities_type_id=e),"no-data-text":"Типов управления не найдено",placeholder:"Выберите тип управления"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(a.legal_entity_types,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(s,{key:e.id,label:e.name,value:e.id},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",si,Object(l["toDisplayString"])(e.full_name),1),Object(l["createElementVNode"])("span",di,Object(l["toDisplayString"])(e.name),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(b,{disabled:i.loading,rules:i.rules.name,label:"Название",prop:"name"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{modelValue:i.fields.name,"onUpdate:modelValue":t[2]||(t[2]=e=>i.fields.name=e),maxlength:"20","show-word-limit":""},null,8,["modelValue"])]),_:1},8,["disabled","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue"])])}var ji={props:{legal_entity_types:{require:!0,type:Array}},data(){return{fields:{name:"",legal_entities_type_id:""},options:[],loading:!1,dialogVisible:!1,rules:{name:[{required:!0,message:"Пожалуйста, укажите название организации",trigger:"blur"}],legal_entities_type_id:[{required:!0,message:"Пожалуйста, выберите тип управления",trigger:"blur"}]}}},methods:{...Object(I["b"])(["saveLegalEntities"]),submitForm:function(){this.$refs["createLegalEntities"].validate(async e=>{if(!e)return this.loading=!1,!1;{this.loading=!0;const e=await this.saveLegalEntities({name:this.fields.name,legal_entities_type_id:this.fields.legal_entities_type_id,token:localStorage.getItem("crm_token")});e?(this.loading=!1,this.fields.legal_entities_type_id="",this.fields.name="",this.dialogVisible=!1):this.loading=!1}})}}};a("17a3");const Oi=T()(ji,[["render",pi],["__scopeId","data-v-544dbca5"]]);var hi=Oi;const _i={class:"name"},gi={class:"label"},fi={class:"dialog-footer"},vi=Object(l["createTextVNode"])("Отменить"),yi=Object(l["createTextVNode"])(" Сохранить ");function Vi(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("font-awesome-icon"),c=Object(l["resolveComponent"])("el-button"),s=Object(l["resolveComponent"])("el-option"),d=Object(l["resolveComponent"])("el-select"),b=Object(l["resolveComponent"])("el-form-item"),u=Object(l["resolveComponent"])("el-input"),m=Object(l["resolveComponent"])("el-form"),p=Object(l["resolveComponent"])("el-dialog");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object(l["createVNode"])(c,{type:"primary",onClick:t[0]||(t[0]=e=>i.dialogVisible=!0)},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{icon:"edit"})]),_:1}),Object(l["createVNode"])(p,{modelValue:i.dialogVisible,"onUpdate:modelValue":t[5]||(t[5]=e=>i.dialogVisible=e),title:"Редактирование юридического лица"},{footer:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",fi,[Object(l["createVNode"])(c,{disabled:i.loading,onClick:t[4]||(t[4]=Object(l["withModifiers"])(e=>i.dialogVisible=!1,["prevent"]))},{default:Object(l["withCtx"])(()=>[vi]),_:1},8,["disabled"]),Object(l["createVNode"])(c,{disabled:i.loading,type:"primary",onClick:Object(l["withModifiers"])(r.submitForm,["prevent"])},{default:Object(l["withCtx"])(()=>[yi]),_:1},8,["disabled","onClick"])])]),default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(m,{ref:"updateLegalEntities",model:i.fields,"label-width":"130px",onSubmit:t[3]||(t[3]=Object(l["withModifiers"])(()=>{},["prevent","stop"]))},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(b,{disabled:i.loading,rules:i.rules.legal_entities_type_id,label:"Тип управления",prop:"legal_entities_type_id"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{modelValue:i.fields.legal_entities_type_id,"onUpdate:modelValue":t[1]||(t[1]=e=>i.fields.legal_entities_type_id=e),"no-data-text":"Типов управления не найдено",placeholder:"Выберите тип управления"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(a.legal_entity_types,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(s,{key:e.id,label:e.name,value:e.id},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",_i,Object(l["toDisplayString"])(e.full_name),1),Object(l["createElementVNode"])("span",gi,Object(l["toDisplayString"])(e.name),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(b,{disabled:i.loading,rules:i.rules.name,label:"Название",prop:"name"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{modelValue:i.fields.name,"onUpdate:modelValue":t[2]||(t[2]=e=>i.fields.name=e),maxlength:"20","show-word-limit":""},null,8,["modelValue"])]),_:1},8,["disabled","rules"])]),_:1},8,["model"])]),_:1},8,["modelValue"])])}var wi={props:{data:{require:!0,type:Object},legal_entity_types:{require:!0,type:Array}},data(){return{fields:{name:"",legal_entities_type_id:""},options:[],loading:!1,dialogVisible:!1,rules:{name:[{required:!0,message:"Пожалуйста, укажите название организации",trigger:"blur"}],legal_entities_type_id:[{required:!0,message:"Пожалуйста, выберите тип управления",trigger:"blur"}]}}},methods:{...Object(I["b"])(["getAllLegalEntitiesTypes","updateLegalEntities"]),submitForm:function(){this.$refs["updateLegalEntities"].validate(async e=>{if(!e)return this.loading=!1,!1;{this.loading=!0;const e=await this.updateLegalEntities({id:this.data.id,name:this.fields.name,legal_entities_type_id:this.fields.legal_entities_type_id,token:localStorage.getItem("crm_token")});e?(this.loading=!1,this.fields.legal_entities_type_id="",this.fields.name="",this.dialogVisible=!1):this.loading=!1}})}},async mounted(){this.fields.name=this.data.name,this.fields.legal_entities_type_id=this.data.legal_entities_type_id},watch:{data(e){this.fields.name=e.name,this.fields.legal_entities_type_id=e.legal_entities_type_id}}};a("90a0");const ki=T()(wi,[["render",Vi],["__scopeId","data-v-0d31394f"]]);var Ci=ki,Ni={components:{CreateLegalEntities:hi,EditLegalEntities:Ci},data(){return{legal_entities:[],loading:!1,legal_entity_types:[],current_tab:0,archive_legal_entity_types:[],pagination:{0:1,1:1},offsets:{0:0,1:0}}},methods:{...Object(I["b"])(["getAllLegalEntities","getAllLegalEntitiesTypes","deleteLegalEntity","restoreLegalEntity"]),get_entity:function(e){this.offsets[this.current_tab]=10*e-10,this.pagination[this.current_tab]=e,this.get_legal_entities(this.offset)},async get_legal_entities(){this.loading=!0,this.legal_entities=await this.getAllLegalEntities({token:localStorage.getItem("crm_token"),offset:this.offsets[0],limit:10,archive:0}),this.archive_legal_entity_types=await this.getAllLegalEntities({token:localStorage.getItem("crm_token"),offset:this.offsets[1],limit:10,archive:1}),this.loading=!1},remove:async function(e){var t,a;(null===(t=this.archive_legal_entity_types)||void 0===t||null===(a=t.legal_entities)||void 0===a?void 0:a.length)<2&&(this.offsets[0]=0,this.pagination[0]=0),await this.deleteLegalEntity({id:e,token:localStorage.getItem("crm_token")})},restore:async function(e){var t,a;(null===(t=this.archive_legal_entity_types)||void 0===t||null===(a=t.legal_entities)||void 0===a?void 0:a.length)<2&&(this.offsets[1]=0,this.pagination[1]=0),await this.restoreLegalEntity({id:e,token:localStorage.getItem("crm_token")})},set_tab:function(e){this.current_tab=e.props.name}},async mounted(){await this.get_legal_entities(),this.legal_entity_types=await this.getAllLegalEntitiesTypes(localStorage.getItem("crm_token"))},computed:{...Object(I["c"])(["getIsLegalEntities"])},watch:{getIsLegalEntities:async function(){await this.get_legal_entities()}}};a("fa01");const xi=T()(Ni,[["render",ci],["__scopeId","data-v-939630ae"]]);var Bi=xi,Si={props:{title:{type:String,require:!0}},components:{Main:oe,LegalEntities:Bi},data(){return{}},methods:{},beforeMount(){document.title=this.title}};const Ii=T()(Si,[["render",li]]);var Ei=Ii;const Mi=Object(l["createElementVNode"])("h2",null,"История операций",-1);function Di(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("History",!0),c=Object(l["resolveComponent"])("Main");return Object(l["openBlock"])(),Object(l["createBlock"])(c,null,{default:Object(l["withCtx"])(()=>[Mi,Object(l["createVNode"])(n)]),_:1})}const Ti=e=>(Object(l["pushScopeId"])("data-v-e566affa"),e=e(),Object(l["popScopeId"])(),e),Ui={class:"wrapper_history"},Fi={class:"table_title"},Ai={class:"title_object"},Li={class:"title_total"},qi={class:"table_title"},$i={class:"title_object"},zi={class:"mt-10"},Pi={class:"title_total mt-10"},Hi={class:"block_row"},Ri={class:"block_row_detail"},Ji=Ti(()=>Object(l["createElementVNode"])("span",null,"ID",-1)),Yi={class:"block_row_detail"},Wi=Ti(()=>Object(l["createElementVNode"])("span",null,"Платильщик",-1)),Ki={class:"block_row_detail"},Zi=Ti(()=>Object(l["createElementVNode"])("span",null,"Поставщик",-1)),Gi={class:"detail_text"},Xi={class:"block_row_detail"},Qi=Ti(()=>Object(l["createElementVNode"])("span",null,"Объект",-1)),er={class:"block_row_detail"},tr=Ti(()=>Object(l["createElementVNode"])("span",null,"Тип материала",-1)),ar={class:"block_row_detail"},lr=Ti(()=>Object(l["createElementVNode"])("span",null,"Материал",-1)),or={class:"block_row_detail"},ir={class:"block_row_detail"},rr=Ti(()=>Object(l["createElementVNode"])("span",null,"Объем",-1)),nr={class:"block_row_detail"},cr=Ti(()=>Object(l["createElementVNode"])("span",null,"Итого",-1)),sr={class:"block_row_detail"},dr=Ti(()=>Object(l["createElementVNode"])("span",null,"Дата создания",-1)),br={class:"block_row_detail"},ur=Ti(()=>Object(l["createElementVNode"])("span",null,"Подтверждение",-1)),mr={class:"block_row_detail"},pr=Ti(()=>Object(l["createElementVNode"])("span",null,"Документы",-1)),jr=["href"],Or={key:1},hr={key:0,class:"block_row_detail"},_r=Ti(()=>Object(l["createElementVNode"])("span",null,"Комментарий",-1)),gr={class:"detail_text comment"},fr=Ti(()=>Object(l["createElementVNode"])("br",null,null,-1)),vr=Ti(()=>Object(l["createElementVNode"])("br",null,null,-1)),yr={key:1},Vr=Ti(()=>Object(l["createElementVNode"])("div",null,"Поставщики не добавлены",-1));function wr(e,t,a,o,i,r){var n,c;const s=Object(l["resolveComponent"])("CreateHistoryOperation"),d=Object(l["resolveComponent"])("font-awesome-icon"),b=Object(l["resolveComponent"])("el-tooltip"),u=Object(l["resolveComponent"])("el-menu-item"),m=Object(l["resolveComponent"])("el-menu"),p=Object(l["resolveComponent"])("el-card"),j=Object(l["resolveComponent"])("el-col"),O=Object(l["resolveComponent"])("el-table-column"),h=Object(l["resolveComponent"])("EditHistoryOperation"),_=Object(l["resolveComponent"])("el-button"),g=Object(l["resolveComponent"])("el-popconfirm"),f=Object(l["resolveComponent"])("el-table"),v=Object(l["resolveComponent"])("el-pagination"),y=Object(l["resolveComponent"])("el-collapse-item"),V=Object(l["resolveComponent"])("el-collapse"),w=Object(l["resolveComponent"])("el-row"),k=Object(l["resolveDirective"])("loading");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",Ui,[Object(l["createVNode"])(s,{materials:i.materials.materials,materials_types:i.materials_types.types,objects:i.objects.objects,vendors:i.vendors.vendors,legal_entities:i.legal_entities.legal_entities,class:"create"},null,8,["materials","materials_types","objects","vendors","legal_entities"]),null!==(n=i.vendors)&&void 0!==n&&null!==(c=n.vendors)&&void 0!==c&&c.length?(Object(l["openBlock"])(),Object(l["createBlock"])(w,{key:0,gutter:24},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(j,{span:2},{default:Object(l["withCtx"])(()=>[Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createBlock"])(p,{shadow:"never"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(m,{class:"menu"},{default:Object(l["withCtx"])(()=>{var e;return[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(null===(e=i.vendors)||void 0===e?void 0:e.vendors,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(u,{key:e.id,index:`${e.name}_!-#$te__${e.id}`,class:"wrapper",onClick:r.set_vendor},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(b,{content:e.name,class:"item",effect:"dark",placement:"left"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{icon:[e.prefix,e.icon],class:"icon"},null,8,["icon"])]),_:2},1032,["content"])]),_:2},1032,["index","onClick"]))),128))]}),_:1})]),_:1})),[[k,i.loadingMenu]])]),_:1}),Object(l["createVNode"])(j,{span:22},{default:Object(l["withCtx"])(()=>[Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createBlock"])(p,{class:"collapse",shadow:"never"},{default:Object(l["withCtx"])(()=>[i.current_vendor&&Object.keys(i.objects_by_vendor).length?(Object(l["openBlock"])(),Object(l["createBlock"])(V,{key:0,accordion:!0,onChange:r.get_object_and_material},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(Object.keys(i.objects_by_vendor),e=>(Object(l["openBlock"])(),Object(l["createBlock"])(y,{key:e,name:e},{title:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("table",Fi,[Object(l["createElementVNode"])("tr",null,[Object(l["createElementVNode"])("td",Ai,Object(l["toDisplayString"])(e),1),Object(l["createElementVNode"])("td",Li,Object(l["toDisplayString"])(r.format_price(i.objects_by_vendor[e].total)),1)])])]),default:Object(l["withCtx"])(()=>[i.current_vendor&&Object.keys(i.materials_by_objects).length?(Object(l["openBlock"])(),Object(l["createBlock"])(V,{key:0,accordion:!0,onChange:r.get_object_and_material},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(Object.keys(i.materials_by_objects),e=>(Object(l["openBlock"])(),Object(l["createBlock"])(y,{key:e,name:e},{title:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("table",qi,[Object(l["createElementVNode"])("tr",null,[Object(l["createElementVNode"])("td",$i,[Object(l["createElementVNode"])("strong",zi,Object(l["toDisplayString"])(e),1)]),Object(l["createElementVNode"])("td",Pi,Object(l["toDisplayString"])(r.format_price(i.materials_by_objects[e].total)),1)])])]),default:Object(l["withCtx"])(()=>{var e;return[Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createBlock"])(f,{data:null===(e=i.history_operations)||void 0===e?void 0:e.operations,"default-sort":{prop:"id",order:"descending"},"row-class-name":r.confirmed_data,border:"","empty-text":"Данных нет",style:{width:"100%"},onCellClick:r.click_expand},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(O,{type:"expand"},{default:Object(l["withCtx"])(e=>[Object(l["createElementVNode"])("div",Hi,[Object(l["createElementVNode"])("div",Ri,[Ji,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.row.id),1)]),Object(l["createElementVNode"])("div",Yi,[Wi,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.row.legal_entity.legal_entities_type)+" "+Object(l["toDisplayString"])(e.row.legal_entity.name),1)]),Object(l["createElementVNode"])("div",Ki,[Zi,Object(l["createElementVNode"])("span",null,[Object(l["createVNode"])(d,{icon:[e.row.vendor.prefix,e.row.vendor.icon],class:"vendor_icon"},null,8,["icon"]),Object(l["createElementVNode"])("span",Gi,Object(l["toDisplayString"])(e.row.vendor.name),1)])]),Object(l["createElementVNode"])("div",Xi,[Qi,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.row.object.name),1)]),Object(l["createElementVNode"])("div",er,[tr,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.row.material.type),1)]),Object(l["createElementVNode"])("div",ar,[lr,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.row.material.name),1)]),Object(l["createElementVNode"])("div",or,[Object(l["createElementVNode"])("span",null," Цена за "+Object(l["toDisplayString"])(r.word_decimal(e.row.material.units.toLowerCase())),1),Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(r.format_price(e.row.price)),1)]),Object(l["createElementVNode"])("div",ir,[rr,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(r.format_volume(e.row.volume)),1)]),Object(l["createElementVNode"])("div",nr,[cr,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(r.format_price(e.row.total)),1)]),Object(l["createElementVNode"])("div",sr,[dr,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(r.format_date(e.row.created_at)),1)]),Object(l["createElementVNode"])("div",br,[ur,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(0===Number(e.row.confirmed_data)?"Данные не подтверждены":"Данные подтверждены"),1)]),Object(l["createElementVNode"])("div",mr,[pr,e.row.file.link?(Object(l["openBlock"])(),Object(l["createElementBlock"])("a",{key:0,href:e.row.file.link,target:"_blank"},Object(l["toDisplayString"])(e.row.file.name),9,jr)):(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",Or,"Документ не загружен"))]),e.row.comment?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",hr,[_r,Object(l["createElementVNode"])("span",gr,Object(l["toDisplayString"])(e.row.comment),1)])):Object(l["createCommentVNode"])("",!0),fr])]),_:2},1024),Object(l["createVNode"])(O,{label:"ID",prop:"id",sortable:"",width:"80"}),Object(l["createVNode"])(O,{label:"Тип материала",sortable:"",width:"150"},{default:Object(l["withCtx"])(e=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.row.material.type),1)]),_:2},1024),Object(l["createVNode"])(O,{label:"Материал",sortable:""},{default:Object(l["withCtx"])(e=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.row.material.name),1)]),_:2},1024),Object(l["createVNode"])(O,{label:"Дата создания",sortable:"",width:"170"},{default:Object(l["withCtx"])(e=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(r.format_date(e.row.created_at)),1)]),_:1}),Object(l["createVNode"])(O,{label:"Цена за тонну",sortable:""},{default:Object(l["withCtx"])(e=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(r.format_price(e.row.price)),1)]),_:1}),Object(l["createVNode"])(O,{label:"Объем",sortable:""},{default:Object(l["withCtx"])(e=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(r.format_volume(e.row.volume)),1)]),_:1}),Object(l["createVNode"])(O,{label:"Итого",sortable:""},{default:Object(l["withCtx"])(e=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(r.format_price(e.row.total)),1)]),_:1}),Object(l["createVNode"])(O,{label:"Действие"},{default:Object(l["withCtx"])(e=>[Object(l["createVNode"])(h,{data:e.row,materials:i.materials.materials,materials_types:i.materials_types.types,objects:i.objects.objects,vendors:i.vendors.vendors,legal_entities:i.legal_entities.legal_entities,class:"block"},null,8,["data","materials","materials_types","objects","vendors","legal_entities"]),Object(l["createVNode"])(g,{"cancel-button-text":"Стой! Оставь","confirm-button-text":"Естественно","icon-color":"red",title:"Вы точно хотите удалить?",onConfirm:t=>r.remove(e.row.id)},{reference:Object(l["withCtx"])(()=>[Object(l["createVNode"])(_,{class:"remove",type:"danger"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{icon:"trash"})]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:2},1032,["data","row-class-name","onCellClick"])),[[k,i.loading]]),vr,Object(l["createVNode"])(v,{"page-size":5,total:Number(i.history_operations.count),background:"",class:"pagination","hide-on-single-page":"",layout:"prev, pager, next",onNextClick:r.get_operations,onPrevClick:r.get_operations,onCurrentChange:r.get_operations},null,8,["total","onNextClick","onPrevClick","onCurrentChange"])]}),_:2},1032,["name"]))),128))]),_:2},1032,["onChange"])):Object(l["createCommentVNode"])("",!0)]),_:2},1032,["name"]))),128))]),_:1},8,["onChange"])):(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",yr,"Нет операций"))]),_:1})),[[k,i.loading]])]),_:1})]),_:1})):Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createBlock"])(p,{key:1},{default:Object(l["withCtx"])(()=>[Vr]),_:1})),[[k,i.loadingMenu]])])}a("caad");const kr=e=>(Object(l["pushScopeId"])("data-v-5c03d906"),e=e(),Object(l["popScopeId"])(),e),Cr=kr(()=>Object(l["createElementVNode"])("br",null,null,-1)),Nr=kr(()=>Object(l["createElementVNode"])("br",null,null,-1)),xr={class:"btn_footer"},Br=Object(l["createTextVNode"])("Назад "),Sr=Object(l["createTextVNode"])("Далее "),Ir={class:"btn_footer"},Er=Object(l["createTextVNode"])("Назад"),Mr=Object(l["createTextVNode"])("Далее "),Dr=kr(()=>Object(l["createElementVNode"])("span",null,"Данные не подтверждены",-1)),Tr=kr(()=>Object(l["createElementVNode"])("span",null,"Данные подтверждены",-1)),Ur=Object(l["createTextVNode"])("Выберите файл"),Fr=kr(()=>Object(l["createElementVNode"])("span",null,null,-1)),Ar=kr(()=>Object(l["createElementVNode"])("span",null,null,-1)),Lr={class:"dialog-footer"},qr=Object(l["createTextVNode"])("Назад"),$r=Object(l["createTextVNode"])(" Сохранить ");function zr(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("font-awesome-icon"),c=Object(l["resolveComponent"])("el-button"),s=Object(l["resolveComponent"])("el-step"),d=Object(l["resolveComponent"])("el-steps"),b=Object(l["resolveComponent"])("el-option"),u=Object(l["resolveComponent"])("el-select"),m=Object(l["resolveComponent"])("el-form-item"),p=Object(l["resolveComponent"])("el-checkbox"),j=Object(l["resolveComponent"])("el-form"),O=Object(l["resolveComponent"])("el-input"),h=Object(l["resolveComponent"])("el-date-picker"),_=Object(l["resolveComponent"])("el-upload"),g=Object(l["resolveComponent"])("el-dialog"),f=Object(l["resolveDirective"])("loading");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object(l["createVNode"])(c,{circle:"",type:"success",onClick:t[0]||(t[0]=e=>i.dialogVisible=!0)},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{icon:"plus"})]),_:1}),Object(l["createVNode"])(g,{modelValue:i.dialogVisible,"onUpdate:modelValue":t[16]||(t[16]=e=>i.dialogVisible=e),title:"Создание новой операции"},Object(l["createSlots"])({default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{active:i.active,"align-center":"","finish-status":"success"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{title:"Основа"}),Object(l["createVNode"])(s,{title:"Детали"}),Object(l["createVNode"])(s,{title:"Итог"})]),_:1},8,["active"]),Cr,Nr,0===i.active?(Object(l["openBlock"])(),Object(l["createBlock"])(j,{key:0,ref:"createLegalEntities",model:i.fields,"label-width":"130px",onSubmit:t[6]||(t[6]=Object(l["withModifiers"])(()=>{},["prevent","stop"]))},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(m,{disabled:i.loading,rules:i.rules.vendor_id,label:"Поставщик",prop:"vendor_id"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{modelValue:i.fields.vendor_id,"onUpdate:modelValue":t[1]||(t[1]=e=>i.fields.vendor_id=e),"no-data-text":"Поставщиков не найдено. Добавьте нового или восстановите старого",placeholder:"Выберите поставщика"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(a.vendors,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(b,{key:e.id,label:e.name,value:e.id},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",null,[Object(l["createVNode"])(n,{icon:[e.prefix,e.icon],class:"icon"},null,8,["icon"]),Object(l["createTextVNode"])("  "+Object(l["toDisplayString"])(e.name),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(m,{disabled:i.loading,rules:i.rules.material_type_id,label:"Тип материала",prop:"material_type_id"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{modelValue:i.fields.material_type_id,"onUpdate:modelValue":t[2]||(t[2]=e=>i.fields.material_type_id=e),disabled:!i.fields.vendor_id,"no-data-text":"Типов материалов не найдено. Добавьте новый",placeholder:"Выберите тип материала"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(a.materials_types,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(b,{key:e.id,label:e.name,value:e.id},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",null,Object(l["toDisplayString"])(e.name),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(m,{disabled:i.loading,rules:i.rules.material_id,label:"Материал",prop:"material_id"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{modelValue:i.fields.material_id,"onUpdate:modelValue":t[3]||(t[3]=e=>i.fields.material_id=e),disabled:!i.fields.material_type_id,"no-data-text":"Материалов не найдено. Добавьте новый",placeholder:"Выберите материал",filterable:""},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(r.filteredMaterials,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(b,{key:e.id,label:e.name,value:e.id},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",null,Object(l["toDisplayString"])(e.name),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(m,{disabled:i.loading,rules:i.rules.legal_entity_id,label:"Платильщик",prop:"legal_entity_id"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{modelValue:i.fields.legal_entity_id,"onUpdate:modelValue":t[4]||(t[4]=e=>i.fields.legal_entity_id=e),disabled:!i.fields.material_id,"no-data-text":"Платильщик не найдено. Добавьте новый",placeholder:"Выберите платильщика"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(a.legal_entities,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(b,{key:e.id,label:e.full_name,value:e.id},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",null,Object(l["toDisplayString"])(e.full_name),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1},8,["disabled","rules"]),Object(l["createElementVNode"])("div",xr,[i.isDebtVisible?(Object(l["openBlock"])(),Object(l["createBlock"])(p,{key:0,modelValue:i.isDebt,"onUpdate:modelValue":t[5]||(t[5]=e=>i.isDebt=e),label:"Долг на конец года"},null,8,["modelValue"])):Object(l["createCommentVNode"])("",!0),Object(l["createVNode"])(c,{disabled:0===this.active,style:{"margin-top":"12px"},onClick:r.prev},{default:Object(l["withCtx"])(()=>[Br]),_:1},8,["disabled","onClick"]),Object(l["createVNode"])(c,{disabled:!i.fields.legal_entity_id,style:{"margin-top":"12px"},onClick:r.next},{default:Object(l["withCtx"])(()=>[Sr]),_:1},8,["disabled","onClick"])])]),_:1},8,["model"])):Object(l["createCommentVNode"])("",!0),1===i.active?(Object(l["openBlock"])(),Object(l["createBlock"])(j,{key:1,ref:"createLegalEntities",model:i.fields,"label-width":"130px",onSubmit:t[11]||(t[11]=Object(l["withModifiers"])(()=>{},["prevent","stop"]))},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(m,{disabled:i.loading,rules:i.rules.object_id,label:"Объект",prop:"object_id"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{modelValue:i.fields.object_id,"onUpdate:modelValue":t[7]||(t[7]=e=>i.fields.object_id=e),disabled:!i.fields.legal_entity_id,"no-data-text":"Объектов не найдено. Добавьте новый или восстановите старый",placeholder:"Выберите объект",filterable:""},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(a.objects,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(b,{key:e.id,label:e.name,value:e.id},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",null,Object(l["toDisplayString"])(e.name),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(m,{rules:i.rules.volume,label:"Объем",prop:"volume"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(O,{modelValue:i.fields.volume,"onUpdate:modelValue":t[8]||(t[8]=e=>i.fields.volume=e),disabled:!i.fields.object_id,maxlength:"12","show-word-limit":""},null,8,["modelValue","disabled"])]),_:1},8,["rules"]),Object(l["createVNode"])(m,{rules:i.rules.price,label:"Стоимость",prop:"price"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(O,{modelValue:i.fields.price,"onUpdate:modelValue":t[9]||(t[9]=e=>i.fields.price=e),disabled:!i.fields.volume,maxlength:"12","show-word-limit":""},null,8,["modelValue","disabled"])]),_:1},8,["rules"]),Object(l["createVNode"])(m,{rules:i.rules.total,label:"Итого",prop:"total"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(O,{modelValue:i.fields.total,"onUpdate:modelValue":t[10]||(t[10]=e=>i.fields.total=e),disabled:!i.fields.price,maxlength:"12","show-word-limit":""},null,8,["modelValue","disabled"])]),_:1},8,["rules"]),Object(l["createElementVNode"])("div",Ir,[Object(l["createVNode"])(c,{style:{"margin-top":"12px"},onClick:r.prev},{default:Object(l["withCtx"])(()=>[Er]),_:1},8,["onClick"]),Object(l["createVNode"])(c,{disabled:!i.fields.total,style:{"margin-top":"12px"},onClick:r.next},{default:Object(l["withCtx"])(()=>[Mr]),_:1},8,["disabled","onClick"])])]),_:1},8,["model"])):Object(l["createCommentVNode"])("",!0),2===i.active?(Object(l["openBlock"])(),Object(l["createBlock"])(j,{key:2,ref:"createLegalEntities",model:i.fields,"label-width":"130px",onSubmit:t[15]||(t[15]=Object(l["withModifiers"])(()=>{},["prevent","stop"]))},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(m,{rules:i.rules.created_at,label:"Дата операции",prop:"created_at"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(h,{modelValue:i.fields.created_at,"onUpdate:modelValue":t[12]||(t[12]=e=>i.fields.created_at=e),disabled:!i.fields.total,shortcuts:i.shortcuts,format:"DD.MM.YYYY HH:mm:ss",placeholder:"Выберите дату и время",type:"datetime"},null,8,["modelValue","disabled","shortcuts"])]),_:1},8,["rules"]),Object(l["createVNode"])(m,{rules:i.rules.confirmed_data,label:"Подтверждение",prop:"confirmed_data"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{modelValue:i.fields.confirmed_data,"onUpdate:modelValue":t[13]||(t[13]=e=>i.fields.confirmed_data=e),disabled:!i.fields.created_at,placeholder:"Выберите вариант подтверждения оперции"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(b,{label:"Данные не подтверждены",value:"0"},{default:Object(l["withCtx"])(()=>[Dr]),_:1}),Object(l["createVNode"])(b,{label:"Данные подтверждены",value:"1"},{default:Object(l["withCtx"])(()=>[Tr]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1},8,["rules"]),Object(l["createVNode"])(m,{label:"Комментарий",prop:"total"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(O,{modelValue:i.fields.comment,"onUpdate:modelValue":t[14]||(t[14]=e=>i.fields.comment=e),disabled:!i.fields.confirmed_data,maxlength:"1000","show-word-limit":"",type:"textarea"},null,8,["modelValue","disabled"])]),_:1}),Object(l["createVNode"])(m,{label:"Документ",prop:"file"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(_,{ref:"upload","auto-upload":!1,action:"#",class:"upload"},{trigger:Object(l["withCtx"])(()=>[Object(l["createVNode"])(c,{size:"small",type:"primary"},{default:Object(l["withCtx"])(()=>[Ur]),_:1})]),default:Object(l["withCtx"])(()=>[Fr,Ar]),_:1},512)]),_:1})]),_:1},8,["model"])):Object(l["createCommentVNode"])("",!0)]),_:2},[2===i.active?{name:"footer",fn:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",Lr,[Object(l["createVNode"])(c,{disabled:i.loading,style:{"margin-top":"12px"},onClick:r.prev},{default:Object(l["withCtx"])(()=>[qr]),_:1},8,["disabled","onClick"]),Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createBlock"])(c,{disabled:i.loading||!i.fields.confirmed_data,type:"primary",onClick:Object(l["withModifiers"])(r.submitForm,["prevent"])},{default:Object(l["withCtx"])(()=>[$r]),_:1},8,["disabled","onClick"])),[[f,i.loading]])])])}:void 0]),1032,["modelValue"])])}var Pr={props:{vendors:{require:!0,type:Array},materials:{require:!0,type:Array},materials_types:{require:!0,type:Array},objects:{require:!0,type:Array},legal_entities:{require:!0,type:Array}},data(){return{fields:{vendor_id:"",material_id:"",legal_entity_id:"",object_id:"",volume:"",price:"",total:"",comment:"",created_at:new Date,material_type_id:"",confirmed_data:""},active:0,options:[],loading:!1,dialogVisible:!1,isDebtVisible:!1,isDebt:!1,shortcuts:[{text:"Сегодня",value:new Date},{text:"Вчера",value:()=>{const e=new Date;return e.setTime(e.getTime()-864e5),e}}],rules:{vendor_id:[{required:!0,message:"Пожалуйста, выберите поставщика",trigger:"blur"}],material_type_id:[{required:!0,message:"Пожалуйста, выберите тип материала",trigger:"blur"}],material_id:[{required:!0,message:"Пожалуйста, выберите материал",trigger:"blur"}],legal_entity_id:[{required:!0,message:"Пожалуйста, выберите платильщика",trigger:"blur"}],object_id:[{required:!0,message:"Пожалуйста, выберите объект",trigger:"blur"}],volume:[{required:!0,message:"Пожалуйста, укажите объем",trigger:"blur"}],price:[{required:!0,message:"Пожалуйста, укажите стоимость",trigger:"blur"}],total:[{required:!0,message:"Пожалуйста, укажите итоговую стоимость",trigger:"blur"}],created_at:[{required:!0,message:"Пожалуйста, укажите дату операции",trigger:"blur"}],confirmed_data:[{required:!0,message:"Пожалуйста, укажите подтверждение операции",trigger:"blur"}]}}},methods:{...Object(I["b"])(["saveHistoryOperation","getDebt"]),submitForm:function(){this.$refs["createLegalEntities"].validate(async e=>{if(!e)return this.loading=!1,!1;{this.loading=!0;const e=document.querySelector(".el-upload__input").files[0],t=await this.saveHistoryOperation({token:localStorage.getItem("crm_token"),vendor_id:this.fields.vendor_id,material_id:this.fields.material_id,object_id:this.fields.object_id,legal_entity_id:this.fields.legal_entity_id,volume:w(parseFloat(this.fields.volume.replace(",","."))),price:w(parseFloat(this.fields.price.replace(",","."))),total:w(parseFloat(this.fields.total.replace(",","."))),comment:this.fields.comment,confirmed_data:this.fields.confirmed_data,is_debt:Number(this.isDebt),file:e,created_at:Math.floor(new Date(this.fields.created_at).getTime()/1e3)});t?(this.loading=!1,this.fields.vendor_id="",this.active=0,this.fields.material_id="",this.fields.material_type_id="",this.fields.legal_entity_id="",this.fields.object_id="",this.fields.volume="",this.fields.price="",this.fields.total="",this.fields.comment="",this.fields.confirmed_data="",this.fields.created_at=new Date,this.isDebt=!1,this.dialogVisible=!1):this.loading=!1}})},next(){this.active++>1&&(this.active=0)},prev(){this.active--<1&&(this.active=0)}},computed:{filteredMaterials(){var e;return null!==(e=this.materials)&&void 0!==e&&e.length?this.materials.filter(e=>e.type_id===this.fields.material_type_id):this.materials},material_type_id(){return this.fields.material_type_id}},async mounted(){this.isDebtVisible=await this.getDebt({token:localStorage.getItem("crm_token")})},watch:{material_type_id(){this.fields.material_id=""}}};a("cee9");const Hr=T()(Pr,[["render",zr],["__scopeId","data-v-5c03d906"]]);var Rr=Hr;const Jr=e=>(Object(l["pushScopeId"])("data-v-98de5d26"),e=e(),Object(l["popScopeId"])(),e),Yr=Jr(()=>Object(l["createElementVNode"])("br",null,null,-1)),Wr=Jr(()=>Object(l["createElementVNode"])("br",null,null,-1)),Kr={class:"btn_footer"},Zr=Object(l["createTextVNode"])("Назад "),Gr=Object(l["createTextVNode"])("Далее "),Xr={class:"btn_footer"},Qr=Object(l["createTextVNode"])("Назад"),en=Object(l["createTextVNode"])("Далее "),tn=Jr(()=>Object(l["createElementVNode"])("span",null,"Данные не подтверждены",-1)),an=Jr(()=>Object(l["createElementVNode"])("span",null,"Данные подтверждены",-1)),ln=Object(l["createTextVNode"])("Выберите файл"),on=Jr(()=>Object(l["createElementVNode"])("span",null,null,-1)),rn=Jr(()=>Object(l["createElementVNode"])("span",null,null,-1)),nn={class:"dialog-footer"},cn=Object(l["createTextVNode"])("Назад"),sn=Object(l["createTextVNode"])(" Сохранить ");function dn(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("font-awesome-icon"),c=Object(l["resolveComponent"])("el-button"),s=Object(l["resolveComponent"])("el-step"),d=Object(l["resolveComponent"])("el-steps"),b=Object(l["resolveComponent"])("el-option"),u=Object(l["resolveComponent"])("el-select"),m=Object(l["resolveComponent"])("el-form-item"),p=Object(l["resolveComponent"])("el-checkbox"),j=Object(l["resolveComponent"])("el-form"),O=Object(l["resolveComponent"])("el-input"),h=Object(l["resolveComponent"])("el-date-picker"),_=Object(l["resolveComponent"])("el-upload"),g=Object(l["resolveComponent"])("el-dialog"),f=Object(l["resolveDirective"])("loading");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object(l["createVNode"])(c,{type:"primary",onClick:t[0]||(t[0]=Object(l["withModifiers"])(e=>i.dialogVisible=!0,["prevent","stop"]))},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{icon:"edit"})]),_:1}),Object(l["createVNode"])(g,{modelValue:i.dialogVisible,"onUpdate:modelValue":t[16]||(t[16]=e=>i.dialogVisible=e),title:"Редактирование операции"},Object(l["createSlots"])({default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(d,{active:i.active,"align-center":"","finish-status":"success"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s,{title:"Основа"}),Object(l["createVNode"])(s,{title:"Детали"}),Object(l["createVNode"])(s,{title:"Итог"})]),_:1},8,["active"]),Yr,Wr,0===i.active?(Object(l["openBlock"])(),Object(l["createBlock"])(j,{key:0,ref:"createLegalEntities",model:i.fields,"label-width":"130px",onSubmit:t[6]||(t[6]=Object(l["withModifiers"])(()=>{},["prevent","stop"]))},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(m,{disabled:i.loading,rules:i.rules.vendor_id,label:"Поставщик",prop:"vendor_id"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{modelValue:i.fields.vendor_id,"onUpdate:modelValue":t[1]||(t[1]=e=>i.fields.vendor_id=e),"no-data-text":"Поставщиков не найдено. Добавьте нового или восстановите старого",placeholder:"Выберите поставщика"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(a.vendors,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(b,{key:e.id,label:e.name,value:e.id},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",null,[Object(l["createVNode"])(n,{icon:[e.prefix,e.icon],class:"icon"},null,8,["icon"]),Object(l["createTextVNode"])("  "+Object(l["toDisplayString"])(e.name),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(m,{disabled:i.loading,rules:i.rules.material_type_id,label:"Тип материала",prop:"material_type_id"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{modelValue:i.fields.material_type_id,"onUpdate:modelValue":t[2]||(t[2]=e=>i.fields.material_type_id=e),disabled:!i.fields.vendor_id,"no-data-text":"Типов материалов не найдено. Добавьте новый",placeholder:"Выберите тип материала"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(a.materials_types,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(b,{key:e.id,label:e.name,value:e.id},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",null,Object(l["toDisplayString"])(e.name),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(m,{disabled:i.loading,rules:i.rules.material_id,label:"Материал",prop:"material_id"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{modelValue:i.fields.material_id,"onUpdate:modelValue":t[3]||(t[3]=e=>i.fields.material_id=e),disabled:!i.fields.material_type_id,"no-data-text":"Материалов не найдено. Добавьте новый",placeholder:"Выберите материал",filterable:""},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(r.filteredMaterials,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(b,{key:e.id,label:e.name,value:e.id},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",null,Object(l["toDisplayString"])(e.name),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(m,{disabled:i.loading,rules:i.rules.legal_entity_id,label:"Платильщик",prop:"legal_entity_id"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{modelValue:i.fields.legal_entity_id,"onUpdate:modelValue":t[4]||(t[4]=e=>i.fields.legal_entity_id=e),disabled:!i.fields.material_id,"no-data-text":"Платильщик не найдено. Добавьте новый",placeholder:"Выберите платильщика"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(a.legal_entities,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(b,{key:e.id,label:e.full_name,value:e.id},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",null,Object(l["toDisplayString"])(e.full_name),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1},8,["disabled","rules"]),Object(l["createElementVNode"])("div",Kr,[e.isDebtVisible?(Object(l["openBlock"])(),Object(l["createBlock"])(p,{key:0,modelValue:e.isDebt,"onUpdate:modelValue":t[5]||(t[5]=t=>e.isDebt=t),label:"Долг на конец года"},null,8,["modelValue"])):Object(l["createCommentVNode"])("",!0),Object(l["createVNode"])(c,{disabled:0===this.active,style:{"margin-top":"12px"},onClick:r.prev},{default:Object(l["withCtx"])(()=>[Zr]),_:1},8,["disabled","onClick"]),Object(l["createVNode"])(c,{disabled:!i.fields.legal_entity_id,style:{"margin-top":"12px"},onClick:r.next},{default:Object(l["withCtx"])(()=>[Gr]),_:1},8,["disabled","onClick"])])]),_:1},8,["model"])):Object(l["createCommentVNode"])("",!0),1===i.active?(Object(l["openBlock"])(),Object(l["createBlock"])(j,{key:1,ref:"createLegalEntities",model:i.fields,"label-width":"130px",onSubmit:t[11]||(t[11]=Object(l["withModifiers"])(()=>{},["prevent","stop"]))},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(m,{disabled:i.loading,rules:i.rules.object_id,label:"Объект",prop:"object_id"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{modelValue:i.fields.object_id,"onUpdate:modelValue":t[7]||(t[7]=e=>i.fields.object_id=e),disabled:!i.fields.legal_entity_id,"no-data-text":"Объектов не найдено. Добавьте новый или восстановите старый",placeholder:"Выберите объект",filterable:""},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(a.objects,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(b,{key:e.id,label:e.name,value:e.id},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",null,Object(l["toDisplayString"])(e.name),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1},8,["disabled","rules"]),Object(l["createVNode"])(m,{rules:i.rules.volume,label:"Объем",prop:"volume"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(O,{modelValue:i.fields.volume,"onUpdate:modelValue":t[8]||(t[8]=e=>i.fields.volume=e),disabled:!i.fields.object_id,maxlength:"12","show-word-limit":""},null,8,["modelValue","disabled"])]),_:1},8,["rules"]),Object(l["createVNode"])(m,{rules:i.rules.price,label:"Стоимость",prop:"price"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(O,{modelValue:i.fields.price,"onUpdate:modelValue":t[9]||(t[9]=e=>i.fields.price=e),disabled:!i.fields.volume,maxlength:"12","show-word-limit":""},null,8,["modelValue","disabled"])]),_:1},8,["rules"]),Object(l["createVNode"])(m,{rules:i.rules.total,label:"Итого",prop:"total"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(O,{modelValue:i.fields.total,"onUpdate:modelValue":t[10]||(t[10]=e=>i.fields.total=e),disabled:!i.fields.price,maxlength:"12","show-word-limit":""},null,8,["modelValue","disabled"])]),_:1},8,["rules"]),Object(l["createElementVNode"])("div",Xr,[Object(l["createVNode"])(c,{style:{"margin-top":"12px"},onClick:r.prev},{default:Object(l["withCtx"])(()=>[Qr]),_:1},8,["onClick"]),Object(l["createVNode"])(c,{disabled:!i.fields.total,style:{"margin-top":"12px"},onClick:r.next},{default:Object(l["withCtx"])(()=>[en]),_:1},8,["disabled","onClick"])])]),_:1},8,["model"])):Object(l["createCommentVNode"])("",!0),2===i.active?(Object(l["openBlock"])(),Object(l["createBlock"])(j,{key:2,ref:"createLegalEntities",model:i.fields,"label-width":"130px",onSubmit:t[15]||(t[15]=Object(l["withModifiers"])(()=>{},["prevent","stop"]))},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(m,{rules:i.rules.created_at,label:"Дата операции",prop:"created_at"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(h,{modelValue:i.fields.created_at,"onUpdate:modelValue":t[12]||(t[12]=e=>i.fields.created_at=e),disabled:!i.fields.total,shortcuts:i.shortcuts,format:"DD.MM.YYYY HH:mm:ss",placeholder:"Выберите дату и время",type:"datetime"},null,8,["modelValue","disabled","shortcuts"])]),_:1},8,["rules"]),Object(l["createVNode"])(m,{rules:i.rules.confirmed_data,label:"Подтверждение",prop:"confirmed_data"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{modelValue:i.fields.confirmed_data,"onUpdate:modelValue":t[13]||(t[13]=e=>i.fields.confirmed_data=e),disabled:!i.fields.created_at,placeholder:"Выберите вариант подтверждения оперции"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(b,{label:"Данные не подтверждены",value:"0"},{default:Object(l["withCtx"])(()=>[tn]),_:1}),Object(l["createVNode"])(b,{label:"Данные подтверждены",value:"1"},{default:Object(l["withCtx"])(()=>[an]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1},8,["rules"]),Object(l["createVNode"])(m,{label:"Комментарий",prop:"total"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(O,{modelValue:i.fields.comment,"onUpdate:modelValue":t[14]||(t[14]=e=>i.fields.comment=e),disabled:!i.fields.confirmed_data,maxlength:"1000","show-word-limit":"",type:"textarea"},null,8,["modelValue","disabled"])]),_:1}),Object(l["createVNode"])(m,{label:"Документ",prop:"file"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(_,{ref:"upload","auto-upload":!1,action:"#",class:"upload"},{trigger:Object(l["withCtx"])(()=>[Object(l["createVNode"])(c,{size:"small",type:"primary"},{default:Object(l["withCtx"])(()=>[ln]),_:1})]),default:Object(l["withCtx"])(()=>[on,rn]),_:1},512)]),_:1})]),_:1},8,["model"])):Object(l["createCommentVNode"])("",!0)]),_:2},[2===i.active?{name:"footer",fn:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",nn,[Object(l["createVNode"])(c,{disabled:i.loading,style:{"margin-top":"12px"},onClick:r.prev},{default:Object(l["withCtx"])(()=>[cn]),_:1},8,["disabled","onClick"]),Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createBlock"])(c,{disabled:i.loading||!i.fields.confirmed_data,type:"primary",onClick:Object(l["withModifiers"])(r.submitForm,["prevent"])},{default:Object(l["withCtx"])(()=>[sn]),_:1},8,["disabled","onClick"])),[[f,i.loading]])])])}:void 0]),1032,["modelValue"])])}var bn={props:{vendors:{require:!0,type:Array},materials:{require:!0,type:Array},materials_types:{require:!0,type:Array},objects:{require:!0,type:Array},legal_entities:{require:!0,type:Array},data:{require:!0,type:Object}},data(){return{fields:{vendor_id:"",material_id:"",legal_entity_id:"",object_id:"",volume:"",price:"",total:"",comment:"",created_at:new Date,material_type_id:"",confirmed_data:""},active:0,options:[],loading:!1,dialogVisible:!1,shortcuts:[{text:"Сегодня",value:new Date},{text:"Вчера",value:()=>{const e=new Date;return e.setTime(e.getTime()-864e5),e}}],rules:{vendor_id:[{required:!0,message:"Пожалуйста, выберите поставщика",trigger:"blur"}],material_type_id:[{required:!0,message:"Пожалуйста, выберите тип материала",trigger:"blur"}],legal_entity_id:[{required:!0,message:"Пожалуйста, выберите платильщика",trigger:"blur"}],material_id:[{required:!0,message:"Пожалуйста, выберите материал",trigger:"blur"}],object_id:[{required:!0,message:"Пожалуйста, выберите объект",trigger:"blur"}],volume:[{required:!0,message:"Пожалуйста, укажите объем",trigger:"blur"}],price:[{required:!0,message:"Пожалуйста, укажите стоимость",trigger:"blur"}],total:[{required:!0,message:"Пожалуйста, укажите итоговую стоимость",trigger:"blur"}],created_at:[{required:!0,message:"Пожалуйста, укажите дату операции",trigger:"blur"}],confirmed_data:[{required:!0,message:"Пожалуйста, укажите подтверждение операции",trigger:"blur"}]}}},methods:{...Object(I["b"])(["updateHistoryOperation"]),submitForm:function(){this.$refs["createLegalEntities"].validate(async e=>{if(!e)return this.loading=!1,!1;{this.loading=!0;const e=document.querySelector(".el-upload__input").files[0],t=await this.updateHistoryOperation({token:localStorage.getItem("crm_token"),id:this.data.id,vendor_id:this.fields.vendor_id,material_id:this.fields.material_id,legal_entity_id:this.fields.legal_entity_id,object_id:this.fields.object_id,volume:w(parseFloat(this.fields.volume.replace(",","."))),price:w(parseFloat(this.fields.price.replace(",","."))),total:w(parseFloat(this.fields.total.replace(",","."))),comment:this.fields.comment,confirmed_data:Number(this.fields.confirmed_data),file:e,created_at:Math.floor(new Date(this.fields.created_at).getTime()/1e3)});t?(this.loading=!1,this.fields.vendor_id="",this.active=0,this.fields.material_id="",this.fields.material_type_id="",this.fields.legal_entity_id="",this.fields.object_id="",this.fields.volume="",this.fields.price="",this.fields.total="",this.fields.comment="",this.fields.confirmed_data="",this.fields.created_at=new Date,this.dialogVisible=!1):this.loading=!1}})},next(){this.active++>1&&(this.active=0)},prev(){this.active--<1&&(this.active=0)}},computed:{...Object(I["c"])(["getIsNewHistoryOperation"]),filteredMaterials(){var e;return null!==(e=this.materials)&&void 0!==e&&e.length?this.materials.filter(e=>e.type_id===this.fields.material_type_id):this.materials},material_type_id(){return this.fields.material_type_id}},mounted(){this.fields.vendor_id=this.data.vendor.id,this.fields.material_id=this.data.material.id,this.fields.material_type_id=this.data.material.type_id,this.fields.legal_entity_id=this.data.legal_entity.id,this.fields.object_id=this.data.object.id,this.fields.volume=w(this.data.volume),this.fields.price=w(this.data.price),this.fields.total=w(this.data.total),this.fields.comment=this.data.comment,this.fields.confirmed_data=String(this.data.confirmed_data),this.fields.created_at=new Date(1e3*this.data.created_at)},watch:{material_type_id(){this.data.material.type_id===this.fields.material_type_id&&this.fields.material_id===this.data.material.id||(this.fields.material_id="")},data(e){this.fields.vendor_id=e.vendor.id,this.fields.material_id=e.material.id,this.fields.material_type_id=e.material.type_id,this.fields.legal_entity_id=e.legal_entity.id,this.fields.object_id=e.object.id,this.fields.confirmed_data=String(e.confirmed_data),this.fields.volume=w(e.volume),this.fields.price=w(e.price),this.fields.total=w(e.total),this.fields.comment=e.comment,this.fields.created_at=new Date(1e3*e.created_at)}}};a("eaf3");const un=T()(bn,[["render",dn],["__scopeId","data-v-98de5d26"]]);var mn=un,pn={components:{CreateHistoryOperation:Rr,EditHistoryOperation:mn},data(){return{loading:!1,activeNames:[],current_vendor:"",current_vendor_id:1,loadingMenu:!1,history_operations:{vendor:[],operations:[]},vendors:[],materials:[],legal_entities:[],materials_types:[],objects:[],active_tab:"0",objects_by_vendor:[],materials_by_objects:[],current_object_id:0,current_material_id:0,offset:0}},methods:{...Object(I["b"])(["getAllHistoryOperation","getAllMaterials","getAllVendors","getAllMaterialTypes","getAllObjects","deleteHistoryOperation","getAllObjectsByVendorHistoryOperation","getAllMaterialsByObjectsHistoryOperation","getAllLegalEntities"]),set_vendor:async function(e){const t=e.index.split("_!-#$te__");this.current_vendor=t[0],this.current_vendor_id=t[1],this.objects_by_vendor=[],this.materials_by_objects=[],this.current_object_id=0,this.current_material_id=0,this.offset=0,this.loading=!0,this.objects_by_vendor=await this.getAllObjectsByVendorHistoryOperation({token:localStorage.getItem("crm_token"),vendor_id:t[1]}),this.loading=!1},format_price:function(e){return y(e)},format_date:function(e){return N(e)},format_volume:function(e){return V(e)},word_decimal:function(e){return C(e)},click_expand:function(e){const t=k(`//tr[contains(@class, "el-table__row")]//div[text() = "${e.id}"]/../..//div[@class="cell"]/div[contains(@class, "el-table__expand-icon")]`);let a=t.iterateNext();while(a)a.click(),a=t.iterateNext()},remove:function(e){this.deleteHistoryOperation({token:localStorage.getItem("crm_token"),id:e})},get_object_and_material:async function(e){this.loading=!0,Object.keys(this.objects_by_vendor).includes(e)&&(this.current_object_id=this.objects_by_vendor[e].object_id,this.materials_by_objects=await this.getAllMaterialsByObjectsHistoryOperation({token:localStorage.getItem("crm_token"),vendor_id:this.current_vendor_id,object_id:this.current_object_id})),Object.keys(this.materials_by_objects).includes(e)&&(this.current_material_id=this.materials_by_objects[e].material_id,this.history_operations=await this.getAllHistoryOperation({token:localStorage.getItem("crm_token"),vendor_id:this.current_vendor_id,object_id:this.current_object_id,material_id:this.current_material_id,offset:this.offset})),this.loading=!1},get_operations:async function(e){this.loading=!0,this.offset=5*e-5,this.history_operations=await this.getAllHistoryOperation({token:localStorage.getItem("crm_token"),vendor_id:this.current_vendor_id,object_id:this.current_object_id,material_id:this.current_material_id,offset:this.offset}),this.loading=!1},confirmed_data({row:e}){return 0===Number(e.confirmed_data)?"danger_docs":""}},async mounted(){this.loading=!0,this.loadingMenu=!0,this.materials=await this.getAllMaterials({token:localStorage.getItem("crm_token"),offset:0,limit:0}),this.vendors=await this.getAllVendors({token:localStorage.getItem("crm_token"),offset:0,limit:0,archive:0}),this.materials_types=await this.getAllMaterialTypes({token:localStorage.getItem("crm_token")}),this.legal_entities=await this.getAllLegalEntities({token:localStorage.getItem("crm_token")}),this.objects=await this.getAllObjects({token:localStorage.getItem("crm_token"),offset:0,limit:0,archive:0}),this.loading=!1,this.loadingMenu=!1},computed:{...Object(I["c"])(["getIsNewHistoryOperation"])},watch:{getIsNewHistoryOperation:async function(){this.loading=!0,this.current_vendor_id&&(this.objects_by_vendor=await this.getAllObjectsByVendorHistoryOperation({token:localStorage.getItem("crm_token"),vendor_id:this.current_vendor_id})),this.current_object_id&&(this.materials_by_objects=await this.getAllMaterialsByObjectsHistoryOperation({token:localStorage.getItem("crm_token"),vendor_id:this.current_vendor_id,object_id:this.current_object_id})),this.current_material_id&&(this.history_operations=await this.getAllHistoryOperation({token:localStorage.getItem("crm_token"),vendor_id:this.current_vendor_id,object_id:this.current_object_id,material_id:this.current_material_id,offset:this.offset})),this.loading=!1}}};a("7637");const jn=T()(pn,[["render",wr],["__scopeId","data-v-e566affa"]]);var On=jn,hn={props:{title:{type:String,require:!0}},components:{Main:oe,History:On},data(){return{}},methods:{},beforeMount(){document.title=this.title}};const _n=T()(hn,[["render",Di]]);var gn=_n;const fn=e=>(Object(l["pushScopeId"])("data-v-7e04ba83"),e=e(),Object(l["popScopeId"])(),e),vn=fn(()=>Object(l["createElementVNode"])("h2",null,"Отчеты",-1));function yn(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("Reports",!0),c=Object(l["resolveComponent"])("Main");return Object(l["openBlock"])(),Object(l["createBlock"])(c,null,{default:Object(l["withCtx"])(()=>[vn,Object(l["createVNode"])(n,{class:"wrapper"})]),_:1})}function Vn(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("Base"),c=Object(l["resolveComponent"])("el-tab-pane"),s=Object(l["resolveComponent"])("Advanced"),d=Object(l["resolveComponent"])("el-tabs");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object(l["createVNode"])(d,{type:"border-card"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(c,{label:"Базовый"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n)]),_:1}),Object(l["createVNode"])(c,{label:"Расширенный"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(s)]),_:1})]),_:1})])}const wn=e=>(Object(l["pushScopeId"])("data-v-67e82b5c"),e=e(),Object(l["popScopeId"])(),e),kn=wn(()=>Object(l["createElementVNode"])("div",{class:"button-new-tag"},null,-1)),Cn={class:"filters"},Nn={class:"generate"},xn=Object(l["createTextVNode"])(" Сохранить в Excel "),Bn=Object(l["createTextVNode"])(" Сохранить в PDF "),Sn=Object(l["createTextVNode"])(" Печать"),In={class:"content_wrapper"},En={class:"formated_reports"},Mn={key:0},Dn={key:1},Tn={id:"print_base_vendors",class:"view_reports"},Un={class:"green"};function Fn(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("el-button"),c=Object(l["resolveComponent"])("export-excel"),s=Object(l["resolveComponent"])("el-divider"),d=Object(l["resolveComponent"])("el-checkbox"),b=Object(l["resolveComponent"])("el-table-column"),u=Object(l["resolveComponent"])("el-table"),m=Object(l["resolveDirective"])("print"),p=Object(l["resolveDirective"])("loading");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[kn,Object(l["createElementVNode"])("div",Cn,[Object(l["createElementVNode"])("div",Nn,[Object(l["createVNode"])(c,{data:i.export_excel_vendor,fields:r.excel_fields,name:r.get_excel_name,class:"excel"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{disabled:0===i.export_excel_vendor.length,type:"success"},{default:Object(l["withCtx"])(()=>[xn]),_:1},8,["disabled"])]),_:1},8,["data","fields","name"]),Object(l["createVNode"])(n,{disabled:0===r.filtered_vendors.length,type:"danger",onClick:r.createPDF},{default:Object(l["withCtx"])(()=>[Bn]),_:1},8,["disabled","onClick"]),Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createBlock"])(n,{disabled:0===r.filtered_vendors.length,type:"info"},{default:Object(l["withCtx"])(()=>[Sn]),_:1},8,["disabled"])),[[m,i.printObj]])])]),Object(l["createVNode"])(s),Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createElementBlock"])("div",In,[Object(l["createElementVNode"])("div",En,[i.vendors.length?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",Mn,[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(i.vendors,e=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",{key:e.id,class:"vendor_item"},[Object(l["createVNode"])(d,{modelValue:e.visible,"onUpdate:modelValue":t=>e.visible=t,label:e.name,border:""},null,8,["modelValue","onUpdate:modelValue","label"])]))),128))])):(Object(l["openBlock"])(),Object(l["createElementBlock"])("p",Dn,"Нет данных"))]),Object(l["createElementVNode"])("div",Tn,[Object(l["createVNode"])(u,{data:r.filtered_vendors,style:{width:"100%"}},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(b,{label:"Поставщик",prop:"name"}),Object(l["createVNode"])(b,{label:"Взяли"},{default:Object(l["withCtx"])(e=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.row.total,e=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("table",{key:e,class:"debt_data"},[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.take,e=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("tr",{key:e},[Object(l["createElementVNode"])("td",null,[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.legal_entity)+": ",1),Object(l["createElementVNode"])("span",Un,Object(l["toDisplayString"])(e.total),1)])]))),128))]))),128))]),_:1}),Object(l["createVNode"])(b,{label:"Долг "},{default:Object(l["withCtx"])(e=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.row.total,e=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("table",{key:e,class:"debt_data"},[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.debt,e=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("tr",{key:e},[Object(l["createElementVNode"])("td",null,[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.legal_entity)+": ",1),Object(l["createElementVNode"])("span",{class:Object(l["normalizeClass"])([e.value>0?"red":e.value<0?"blue":""])},Object(l["toDisplayString"])(e.total),3)])]))),128))]))),128))]),_:1})]),_:1},8,["data"])])])),[[p,i.loading]])])}var An=a("e499"),Ln=a.n(An),qn=a("4ebb"),$n=a.n(qn);Ln.a.vfs=$n.a.pdfMake.vfs;var zn={data(){return{vendors:[],loading:!1,export_excel_vendor:[],printObj:{id:"print_base_vendors",popTitle:"ABLE CRM"}}},methods:{...Object(I["b"])(["getBaseReport"]),format_price(e){return y(e)},createPDF(){const e=[];for(let a in this.export_excel_vendor)e.push([this.export_excel_vendor[a].vendor,this.export_excel_vendor[a].take,this.export_excel_vendor[a].debt]);const t={content:[{text:"Create by ABLE CRM"},{text:" "},{text:" "},{layout:"lightHorizontalLines",table:{headerRows:1,widths:["*","auto","auto"],body:[["Поставщик","Взяли","Долг"],...e]}}]};Ln.a.createPdf(t).download(this.get_pdf_name)}},async mounted(){this.loading=!0;const e=await this.getBaseReport(localStorage.getItem("crm_token"));for(let t in e){let a=[];for(let l in e[t]){let o=[],i=[];for(let a in e[t][l])"Взяли"===l&&o.push({legal_entity:a,total:this.format_price(e[t][l][a])}),"Долг"===l&&i.push({legal_entity:a,total:this.format_price(e[t][l][a]),value:e[t][l][a]});a.push({take:o,debt:i})}this.vendors.push({name:t,total:a,visible:!0})}this.loading=!1},computed:{filtered_vendors(){const e=this.vendors.filter(e=>e.visible);let t=[];for(let a in e){let l=[],o=[];for(let t in e[a].total){if(e[a].total[t].take.length)for(let o in e[a].total[t].take){const i=+o+1===e[a].total[t].take.length?"":"\n";l.push(`${e[a].total[t].take[o].legal_entity}: ${e[a].total[t].take[o].total}${i}`)}if(e[a].total[t].debt.length)for(let l in e[a].total[t].debt){const i=+l+1===e[a].total[t].debt.length?"":"\n";o.push(`${e[a].total[t].debt[l].legal_entity}: ${e[a].total[t].debt[l].total}${i}`)}}t.push({vendor:e[a].name,take:l.join(""),debt:o.join("")})}return this.export_excel_vendor=t,e},get_excel_name(){const e=(new Date).getTime()/1e3;return`Базовая выгрузка от ${N(e)}.xls`},get_pdf_name(){const e=(new Date).getTime()/1e3;return`Базовая выгрузка от ${N(e)}.pdf`},excel_fields(){return{"Поставщик":"vendor","Взяли":"take","Долг":"debt"}}}};a("eb71");const Pn=T()(zn,[["render",Fn],["__scopeId","data-v-67e82b5c"]]);var Hn=Pn;const Rn=e=>(Object(l["pushScopeId"])("data-v-488a3904"),e=e(),Object(l["popScopeId"])(),e),Jn={class:"filters"},Yn={key:1,class:"generate"},Wn=Object(l["createTextVNode"])(" Сохранить в Excel"),Kn=Object(l["createTextVNode"])(" Сохранить в PDF "),Zn=Object(l["createTextVNode"])(" Печать"),Gn={key:0,class:"wrapper_filter"},Xn={class:"icon"},Qn={key:1},ec={id:"print_advanced_vendors"},tc={key:0},ac={class:"block_row"},lc={class:"block_row_detail"},oc=Rn(()=>Object(l["createElementVNode"])("span",null,"ID",-1)),ic={class:"block_row_detail"},rc=Rn(()=>Object(l["createElementVNode"])("span",null,"Поставщик",-1)),nc={class:"detail_text"},cc={class:"block_row_detail"},sc=Rn(()=>Object(l["createElementVNode"])("span",null,"Объект",-1)),dc={class:"block_row_detail"},bc=Rn(()=>Object(l["createElementVNode"])("span",null,"Тип материала",-1)),uc={class:"block_row_detail"},mc=Rn(()=>Object(l["createElementVNode"])("span",null,"Материал",-1)),pc={class:"block_row_detail"},jc={class:"block_row_detail"},Oc=Rn(()=>Object(l["createElementVNode"])("span",null,"Объем",-1)),hc={class:"block_row_detail"},_c=Rn(()=>Object(l["createElementVNode"])("span",null,"Итого",-1)),gc={class:"block_row_detail"},fc=Rn(()=>Object(l["createElementVNode"])("span",null,"Дата создания",-1)),vc={class:"block_row_detail"},yc=Rn(()=>Object(l["createElementVNode"])("span",null,"Подтверждение",-1)),Vc={class:"block_row_detail"},wc=Rn(()=>Object(l["createElementVNode"])("span",null,"Документы",-1)),kc=["href"],Cc={key:1},Nc={class:"block_row_detail"},xc=Rn(()=>Object(l["createElementVNode"])("span",null,"Комментарий",-1)),Bc={class:"detail_text comment"},Sc=Rn(()=>Object(l["createElementVNode"])("br",null,null,-1)),Ic={key:1},Ec={key:0};function Mc(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("Filters"),c=Object(l["resolveComponent"])("el-button"),s=Object(l["resolveComponent"])("export-excel"),d=Object(l["resolveComponent"])("el-divider"),b=Object(l["resolveComponent"])("EditFilters"),u=Object(l["resolveComponent"])("font-awesome-icon"),m=Object(l["resolveComponent"])("el-popconfirm"),p=Object(l["resolveComponent"])("el-card"),j=Object(l["resolveComponent"])("el-table-column"),O=Object(l["resolveComponent"])("el-table"),h=Object(l["resolveDirective"])("print"),_=Object(l["resolveDirective"])("loading");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createElementBlock"])("div",Jn,[i.filters_data.vendor.length?(Object(l["openBlock"])(),Object(l["createBlock"])(n,{key:0,filters_data_new:i.filters_data},null,8,["filters_data_new"])):Object(l["createCommentVNode"])("",!0),i.filters.length&&i.filters_data.vendor.length?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",Yn,[Object(l["createVNode"])(s,{data:r.formated_date,fields:r.excel_fields,name:r.get_excel_name,class:"excel"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(c,{disabled:0===i.filtered_data.length,type:"success"},{default:Object(l["withCtx"])(()=>[Wn]),_:1},8,["disabled"])]),_:1},8,["data","fields","name"]),Object(l["createVNode"])(c,{disabled:0===i.filtered_data.length,type:"danger",onClick:r.createPDF},{default:Object(l["withCtx"])(()=>[Kn]),_:1},8,["disabled","onClick"]),Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createBlock"])(c,{disabled:0===i.filtered_data.length,type:"info"},{default:Object(l["withCtx"])(()=>[Zn]),_:1},8,["disabled"])),[[h,i.printObj]])])):Object(l["createCommentVNode"])("",!0)])),[[_,i.loadingFilters]]),Object(l["createVNode"])(d,{class:"first_line"}),Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[i.filters.length&&i.filters_data.vendor.length?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",Gn,[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(i.filters,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(p,{key:e.id,class:"card",shadow:"hover",onClick:Object(l["withModifiers"])(t=>r.get_filter(e.id),["stop","prevent"])},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("div",null,[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.name)+" ",1),Object(l["createElementVNode"])("span",Xn,[Object(l["createVNode"])(b,{data:e,filters_data_edit:i.filters_data},null,8,["data","filters_data_edit"]),Object(l["createVNode"])(m,{"cancel-button-text":"Стой! Оставь","confirm-button-text":"Естественно","icon-color":"red",title:"Вы точно хотите удалить?",onConfirm:t=>r.remove_filter(e.id)},{reference:Object(l["withCtx"])(()=>[Object(l["createVNode"])(c,{circle:"",plain:"",type:"danger"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{icon:"trash"})]),_:1})]),_:2},1032,["onConfirm"])])])]),_:2},1032,["onClick"]))),128))])):(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",Qn,"Нет созданных фильтров"))])),[[_,i.loadingFilters]]),Object(l["createVNode"])(d),Object(l["createElementVNode"])("div",ec,[Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[i.filtered_data.length?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",tc,[Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createBlock"])(O,{data:i.filtered_data,"default-sort":{prop:"id",order:"descending"},"row-class-name":r.confirmed_data,border:"","empty-text":"Данных нет",style:{width:"100%"},onCellClick:r.click_expand},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(j,{type:"expand"},{default:Object(l["withCtx"])(e=>[Object(l["createElementVNode"])("div",ac,[Object(l["createElementVNode"])("div",lc,[oc,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.row.id),1)]),Object(l["createElementVNode"])("div",ic,[rc,Object(l["createElementVNode"])("span",null,[Object(l["createVNode"])(u,{icon:[e.row.vendor.prefix,e.row.vendor.icon],class:"vendor_icon"},null,8,["icon"]),Object(l["createElementVNode"])("span",nc,Object(l["toDisplayString"])(e.row.vendor.name),1)])]),Object(l["createElementVNode"])("div",cc,[sc,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.row.object.name),1)]),Object(l["createElementVNode"])("div",dc,[bc,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.row.material.type),1)]),Object(l["createElementVNode"])("div",uc,[mc,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.row.material.name),1)]),Object(l["createElementVNode"])("div",pc,[Object(l["createElementVNode"])("span",null," Цена за "+Object(l["toDisplayString"])(r.word_decimal(e.row.material.units.toLowerCase())),1),Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(r.format_price(e.row.price)),1)]),Object(l["createElementVNode"])("div",jc,[Oc,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(r.format_volume(e.row.volume)),1)]),Object(l["createElementVNode"])("div",hc,[_c,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(r.format_price(e.row.total)),1)]),Object(l["createElementVNode"])("div",gc,[fc,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(r.format_date(e.row.created_at)),1)]),Object(l["createElementVNode"])("div",vc,[yc,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(0===e.row.confirmed_data?"Данные не подтверждены":"Данные подтверждены"),1)]),Object(l["createElementVNode"])("div",Vc,[wc,e.row.file.link?(Object(l["openBlock"])(),Object(l["createElementBlock"])("a",{key:0,href:e.row.file.link,target:"_blank"},Object(l["toDisplayString"])(e.row.file.name),9,kc)):(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",Cc,"Документ не загружен"))]),Object(l["createElementVNode"])("div",Nc,[xc,Object(l["createElementVNode"])("span",Bc,Object(l["toDisplayString"])(e.row.comment),1)]),Sc])]),_:1}),Object(l["createVNode"])(j,{label:"ID",prop:"id",sortable:"",width:"80"}),Object(l["createVNode"])(j,{label:"Тип материала",sortable:"",width:"150"},{default:Object(l["withCtx"])(e=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.row.material.type),1)]),_:1}),Object(l["createVNode"])(j,{label:"Материал",sortable:""},{default:Object(l["withCtx"])(e=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.row.material.name),1)]),_:1}),Object(l["createVNode"])(j,{label:"Дата создания",sortable:"",width:"170"},{default:Object(l["withCtx"])(e=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(r.format_date(e.row.created_at)),1)]),_:1}),Object(l["createVNode"])(j,{label:"Цена за тонну",sortable:""},{default:Object(l["withCtx"])(e=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(r.format_price(e.row.price)),1)]),_:1}),Object(l["createVNode"])(j,{label:"Объем",sortable:""},{default:Object(l["withCtx"])(e=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(r.format_volume(e.row.volume)),1)]),_:1}),Object(l["createVNode"])(j,{label:"Итого",sortable:""},{default:Object(l["withCtx"])(e=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(r.format_price(e.row.total)),1)]),_:1})]),_:1},8,["data","row-class-name","onCellClick"])),[[_,i.loading]])])):(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",Ic,"Ни выбран не один фильтр. Пожалуйста, выберите фильтр"))])),[[_,i.loading]]),Object(l["createVNode"])(d),i.total_summary.total||i.total_summary.volume?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",Ec,[Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createBlock"])(O,{data:[i.total_summary],"empty-text":"Данных нет",style:{width:"100%"}},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(j,{prop:"id",width:"80"}),Object(l["createVNode"])(j,{width:"190"}),Object(l["createVNode"])(j),Object(l["createVNode"])(j,{width:"200"}),Object(l["createVNode"])(j),Object(l["createVNode"])(j,{label:"Объем"},{default:Object(l["withCtx"])(e=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(r.format_volume(e.row.volume)),1)]),_:1}),Object(l["createVNode"])(j,{label:"Итого"},{default:Object(l["withCtx"])(e=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(r.format_price(e.row.total)),1)]),_:1})]),_:1},8,["data"])),[[_,i.loading]])])):Object(l["createCommentVNode"])("",!0)])])}const Dc=e=>(Object(l["pushScopeId"])("data-v-010f81b0"),e=e(),Object(l["popScopeId"])(),e),Tc=Object(l["createTextVNode"])("Добавить новый фильтр"),Uc={class:"main_block"},Fc={key:0,id:"container"},Ac={class:"wrapper"},Lc={key:0},qc={class:"card_block"},$c=Dc(()=>Object(l["createElementVNode"])("br",null,null,-1)),zc=Dc(()=>Object(l["createElementVNode"])("br",null,null,-1)),Pc=Dc(()=>Object(l["createElementVNode"])("br",null,null,-1)),Hc=Dc(()=>Object(l["createElementVNode"])("br",null,null,-1)),Rc={class:"dialog-footer"},Jc=Object(l["createTextVNode"])("Отмена"),Yc=Object(l["createTextVNode"])(" Сохранить ");function Wc(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("el-button"),c=Object(l["resolveComponent"])("el-input"),s=Object(l["resolveComponent"])("el-divider"),d=Object(l["resolveComponent"])("el-option"),b=Object(l["resolveComponent"])("el-select"),u=Object(l["resolveComponent"])("font-awesome-icon"),m=Object(l["resolveComponent"])("el-date-picker"),p=Object(l["resolveComponent"])("el-card"),j=Object(l["resolveComponent"])("el-dialog");return Object(l["openBlock"])(),Object(l["createElementBlock"])(l["Fragment"],null,[Object(l["createVNode"])(n,{onClick:t[0]||(t[0]=e=>i.dialogVisible=!0)},{default:Object(l["withCtx"])(()=>[Tc]),_:1}),Object(l["createVNode"])(j,{modelValue:i.dialogVisible,"onUpdate:modelValue":t[3]||(t[3]=e=>i.dialogVisible=e),fullscreen:"",title:"Настройка представления"},{footer:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",Rc,[Object(l["createVNode"])(n,{onClick:t[2]||(t[2]=e=>i.dialogVisible=!1)},{default:Object(l["withCtx"])(()=>[Jc]),_:1}),Object(l["createVNode"])(n,{type:"primary",onClick:r.createFilter},{default:Object(l["withCtx"])(()=>[Yc]),_:1},8,["onClick"])])]),default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("div",Uc,[Object(l["createVNode"])(c,{modelValue:i.filter_name,"onUpdate:modelValue":t[1]||(t[1]=e=>i.filter_name=e),"validate-event":!0,maxlength:"100",placeholder:"Введите имя фильтра","show-word-limit":""},null,8,["modelValue"]),Object(l["createVNode"])(s),i.filters_block?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",Fc,[Object(l["createElementVNode"])("div",Ac,[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(i.filters_block,e=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",{key:e.id,class:Object(l["normalizeClass"])(["first"===e.position?"mt-block":"","wrapper"])},["first"!==e.position?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",Lc,[Object(l["createVNode"])(b,{modelValue:e.unity,"onUpdate:modelValue":t=>e.unity=t,class:"unity"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(i.unity,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])])):Object(l["createCommentVNode"])("",!0),Object(l["createVNode"])(p,{class:"card",shadow:"hover"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{disabled:1===i.filters_block.length,class:"remove",plain:"",type:"danger",onClick:t=>r.remove_filters_block(e.id)},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{icon:"trash-restore"})]),_:2},1032,["disabled","onClick"]),Object(l["createElementVNode"])("div",qc,[Object(l["createVNode"])(b,{modelValue:e.field,"onUpdate:modelValue":t=>e.field=t,placeholder:"Выберите поле"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(i.filtered_fields,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"]),$c,zc,Object(l["createVNode"])(b,{modelValue:e.operation,"onUpdate:modelValue":t=>e.operation=t,placeholder:"Выберите действие"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(i.operations,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"]),Pc,Hc,"selector"===r.check_field_type(e.field)&&"legal_entity"===e.field?(Object(l["openBlock"])(),Object(l["createBlock"])(b,{key:0,modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,placeholder:i.label_filter},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(i.filters_data[e.field],e=>(Object(l["openBlock"])(),Object(l["createBlock"])(d,{key:e.id,label:`${e.legal_entities_type} ${e.name}`,value:e.id},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",null,Object(l["toDisplayString"])(e.legal_entities_type)+" "+Object(l["toDisplayString"])(e.name),1)]),_:2},1032,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])):"selector"===r.check_field_type(e.field)&&"legal_entity"!==e.field?(Object(l["openBlock"])(),Object(l["createBlock"])(b,{key:1,modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,placeholder:i.label_filter},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(i.filters_data[e.field],e=>(Object(l["openBlock"])(),Object(l["createBlock"])(d,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])):"datepicker"===r.check_field_type(e.field)?(Object(l["openBlock"])(),Object(l["createBlock"])(m,{key:2,modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,shortcuts:i.shortcuts,format:"DD.MM.YYYY HH:mm:ss",placeholder:"Выберите дату и время",type:"datetime"},null,8,["modelValue","onUpdate:modelValue","shortcuts"])):(Object(l["openBlock"])(),Object(l["createBlock"])(c,{key:3,modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,placeholder:"Значение"},null,8,["modelValue","onUpdate:modelValue"]))])]),_:2},1024)],2))),128)),Object(l["createVNode"])(n,{circle:"",class:"add",type:"success",onClick:r.add},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(u,{icon:"plus"})]),_:1},8,["onClick"])])])):Object(l["createCommentVNode"])("",!0)])]),_:1},8,["modelValue"])],64)}var Kc=a("2ef0"),Zc=a.n(Kc),Gc=a("4995"),Xc={props:{filters_data_new:{require:!0,type:Object}},data(){return{isReady:!1,dialogVisible:!1,filter_name:"",unity:[{label:"И",value:"and"},{label:"ИЛИ",value:"or"}],filters_block:[{id:Math.random(),field:"",operation:"",value:"",position:"first",unity:"and"}],old_filters_block:[],filters_data:{confirm_history_operation:[]},label_filter:"",shortcuts:[{text:"Сегодня",value:new Date},{text:"Вчера",value:()=>{const e=new Date;return e.setTime(e.getTime()-864e5),e}}],filtered_fields:[{label:"Поставщик",value:"vendor"},{label:"Объект",value:"object"},{label:"Юридическое лицо",value:"legal_entity"},{label:"Материал",value:"material"},{label:"Тип материала",value:"material_type"},{label:"Стоимость",value:"price"},{label:"Итоговая стоимость",value:"total"},{label:"Объем",value:"volume"},{label:"Дата от",value:"date_from"},{label:"Дата до",value:"date_to"},{label:"Подтвержденные операции",value:"confirm_history_operation"}],operations:[{value:"equal",label:"Равно"},{value:"not_equal",label:"Не равно"},{value:"over",label:"Больше"},{value:"over_or_equal",label:"Больше или равно"},{value:"less",label:"Меньше"},{value:"less_or_equal",label:"Меньше или равно"}],confirmation_data:[{name:"Данные подтверждены",id:1},{name:"Данные не подтверждены",id:0}]}},methods:{...Object(I["b"])(["getAllVendors","getAllObjects","getAllLegalEntities","getAllMaterials","getAllMaterialTypes","saveFilter"]),add(){this.filters_block.push({id:Math.random(),field:"",operation:"",value:"",position:"",unity:"and"})},remove_filters_block(e){for(let a in this.filters_block){var t;if(this.filters_block[a].id===e&&"first"===this.filters_block[a].position)this.filters_block[a].position="removed",null!==(t=this.filters_block[Number(a)+1])&&void 0!==t&&t.id&&(this.filters_block[Number(a)+1].position="first")}this.filters_block=this.filters_block.filter(t=>t.id!==e)},check_field_type(e){return["vendor","object","legal_entity","material","material_type","confirm_history_operation"].includes(e)?"selector":["price","total","volume"].includes(e)?"input":["date_from","date_to"].includes(e)?"datepicker":void 0},setValue:function(){this.old_filters_block=Zc.a.cloneDeep(this.filters_block)},createFilter:async function(){let e=[];if(""===this.filter_name?e.push("label"):e=e.filter(e=>"label"!==e),this.filters_block.map(t=>{""===t.field||""===t.value||""===t.operation?e.push(t.id):e=e.filter(e=>e!==t.id)}),0===e.length){if(0!==this.filters_block.length){const e={...this.filters_block};for(let a in e)String(e[a]["field"]).startsWith("date_")&&(e[a]["value"]=Math.floor(new Date(e[a]["value"]).getTime()/1e3)),["price","total","volume"].includes(e[a]["field"])&&(e[a]["value"]=w(parseFloat(e[a]["value"].replace(",","."))));const t=await this.saveFilter({token:localStorage.getItem("crm_token"),name:this.filter_name,filters:e});t&&(this.dialogVisible=!1,this.filter_name="",this.filters_block=[{id:Math.random(),field:"",operation:"",value:"",position:"first",unity:"and"}],this.old_filters_block=[])}}else Gc["a"].error("Пожалуйста, заполните все поля")}},mounted(){this.setValue(),this.filters_data={...this.filters_data,...this.filters_data_new}},watch:{filters_block:{async handler(e){const t=this;let a=e.filter((function(e,a){return Object.keys(e).some((function(l){var o,i;return e[l]!==(null===(o=t.old_filters_block)||void 0===o||null===(i=o[a])||void 0===i?void 0:i[l])}))}))[0];"vendor"===(null===a||void 0===a?void 0:a.field)&&(this.label_filter="Выберите поставщика"),"object"===(null===a||void 0===a?void 0:a.field)&&(this.label_filter="Выберите объект"),"legal_entity"===(null===a||void 0===a?void 0:a.field)&&(this.label_filter="Выберите юридическое лицо"),"material"===(null===a||void 0===a?void 0:a.field)&&(this.label_filter="Выберите материал"),"material_type"===(null===a||void 0===a?void 0:a.field)&&(this.label_filter="Выберите тип материала"),"confirm_history_operation"===(null===a||void 0===a?void 0:a.field)&&0===this.filters_data.confirm_history_operation.length&&(this.filters_data.confirm_history_operation=this.confirmation_data,this.label_filter="Выберите подтверждение"),t.setValue()},deep:!0}}};a("ac53");const Qc=T()(Xc,[["render",Wc],["__scopeId","data-v-010f81b0"]]);var es=Qc;const ts=e=>(Object(l["pushScopeId"])("data-v-41865291"),e=e(),Object(l["popScopeId"])(),e),as={class:"main_block"},ls={id:"container"},os={class:"wrapper"},is={key:0},rs={class:"card_block"},ns=ts(()=>Object(l["createElementVNode"])("br",null,null,-1)),cs=ts(()=>Object(l["createElementVNode"])("br",null,null,-1)),ss=ts(()=>Object(l["createElementVNode"])("br",null,null,-1)),ds=ts(()=>Object(l["createElementVNode"])("br",null,null,-1)),bs={class:"dialog-footer"},us=Object(l["createTextVNode"])("Отмена"),ms=Object(l["createTextVNode"])(" Сохранить ");function ps(e,t,a,o,i,r){const n=Object(l["resolveComponent"])("font-awesome-icon"),c=Object(l["resolveComponent"])("el-button"),s=Object(l["resolveComponent"])("el-input"),d=Object(l["resolveComponent"])("el-divider"),b=Object(l["resolveComponent"])("el-option"),u=Object(l["resolveComponent"])("el-select"),m=Object(l["resolveComponent"])("el-date-picker"),p=Object(l["resolveComponent"])("el-card"),j=Object(l["resolveComponent"])("el-dialog");return Object(l["openBlock"])(),Object(l["createElementBlock"])(l["Fragment"],null,[Object(l["createVNode"])(c,{circle:"",class:"mr-10",plain:"",type:"primary",onClick:t[0]||(t[0]=Object(l["withModifiers"])(e=>i.dialogVisible=!0,["stop","prevent"]))},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{icon:"edit"})]),_:1}),Object(l["createVNode"])(j,{modelValue:i.dialogVisible,"onUpdate:modelValue":t[3]||(t[3]=e=>i.dialogVisible=e),fullscreen:"",title:"Настройка представления"},{footer:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",bs,[Object(l["createVNode"])(c,{onClick:t[2]||(t[2]=e=>i.dialogVisible=!1)},{default:Object(l["withCtx"])(()=>[us]),_:1}),Object(l["createVNode"])(c,{type:"primary",onClick:r.updateFilterMethod},{default:Object(l["withCtx"])(()=>[ms]),_:1},8,["onClick"])])]),default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("div",as,[Object(l["createVNode"])(s,{modelValue:i.filter_name,"onUpdate:modelValue":t[1]||(t[1]=e=>i.filter_name=e),"validate-event":!0,maxlength:"100",placeholder:"Введите имя фильтра","show-word-limit":""},null,8,["modelValue"]),Object(l["createVNode"])(d),Object(l["createElementVNode"])("div",ls,[Object(l["createElementVNode"])("div",os,[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(i.filters_block,e=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",{key:e.id,class:Object(l["normalizeClass"])(["first"===e.position?"mt-block":"","wrapper"])},["first"!==e.position?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",is,[Object(l["createVNode"])(u,{modelValue:e.unity,"onUpdate:modelValue":t=>e.unity=t,class:"unity"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(i.unity,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(b,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])])):Object(l["createCommentVNode"])("",!0),Object(l["createVNode"])(p,{class:"card",shadow:"hover"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(c,{disabled:1===i.filters_block.length,class:"remove",plain:"",type:"danger",onClick:t=>r.remove_filters_block(e.id)},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{icon:"trash-restore"})]),_:2},1032,["disabled","onClick"]),Object(l["createElementVNode"])("div",rs,[Object(l["createVNode"])(u,{modelValue:e.field,"onUpdate:modelValue":t=>e.field=t,placeholder:"Выберите поле"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(i.filtered_fields,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(b,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"]),ns,cs,Object(l["createVNode"])(u,{modelValue:e.operation,"onUpdate:modelValue":t=>e.operation=t,placeholder:"Выберите действие"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(i.operations,e=>(Object(l["openBlock"])(),Object(l["createBlock"])(b,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"]),ss,ds,"selector"===r.check_field_type(e.field)?(Object(l["openBlock"])(),Object(l["createBlock"])(u,{key:0,modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,placeholder:i.label_filter},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(i.filters_data[e.field],e=>(Object(l["openBlock"])(),Object(l["createBlock"])(b,{key:e.id,label:e.full_name,value:e.id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])):"datepicker"===r.check_field_type(e.field)?(Object(l["openBlock"])(),Object(l["createBlock"])(m,{key:1,modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,shortcuts:i.shortcuts,format:"DD.MM.YYYY HH:mm:ss",placeholder:"Выберите дату и время",type:"datetime"},null,8,["modelValue","onUpdate:modelValue","shortcuts"])):(Object(l["openBlock"])(),Object(l["createBlock"])(s,{key:2,modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,placeholder:"Значение"},null,8,["modelValue","onUpdate:modelValue"]))])]),_:2},1024)],2))),128)),Object(l["createVNode"])(c,{circle:"",class:"add",type:"success",onClick:r.add},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(n,{icon:"plus"})]),_:1},8,["onClick"])])])])]),_:1},8,["modelValue"])],64)}var js={props:{data:{require:!0,type:Object},filters_data_edit:{require:!0,type:Object}},data(){return{dialogVisible:!1,filter_name:"",unity:[{label:"И",value:"and"},{label:"ИЛИ",value:"or"}],filters_block:[{id:Math.random(),field:"",operation:"",value:"",position:"first",unity:"and"}],old_filters_block:[],filters_data:{confirm_history_operation:[]},label_filter:"",shortcuts:[{text:"Сегодня",value:new Date},{text:"Вчера",value:()=>{const e=new Date;return e.setTime(e.getTime()-864e5),e}}],filtered_fields:[{label:"Поставщик",value:"vendor"},{label:"Объект",value:"object"},{label:"Юридическое лицо",value:"legal_entity"},{label:"Материал",value:"material"},{label:"Тип материала",value:"material_type"},{label:"Стоимость",value:"price"},{label:"Итоговая стоимость",value:"total"},{label:"Объем",value:"volume"},{label:"Дата от",value:"date_from"},{label:"Дата до",value:"date_to"},{label:"Подтвержденные операции",value:"confirm_history_operation"}],operations:[{value:"equal",label:"Равно"},{value:"not_equal",label:"Не равно"},{value:"over",label:"Больше"},{value:"over_or_equal",label:"Больше или равно"},{value:"less",label:"Меньше"},{value:"less_or_equal",label:"Меньше или равно"}],confirmation_data:[{name:"Данные подтверждены",id:1},{name:"Данные не подтверждены",id:0}]}},methods:{...Object(I["b"])(["getAllVendors","getAllObjects","getAllLegalEntities","getAllMaterials","getAllMaterialTypes","updateFilter"]),add(){this.filters_block.push({id:Math.random(),field:"",operation:"",value:"",position:"",unity:"and"})},remove_filters_block(e){for(let a in this.filters_block){var t;if(this.filters_block[a].id===e&&"first"===this.filters_block[a].position)this.filters_block[a].position="removed",null!==(t=this.filters_block[Number(a)+1])&&void 0!==t&&t.id&&(this.filters_block[Number(a)+1].position="first")}this.filters_block=this.filters_block.filter(t=>t.id!==e)},check_field_type(e){return["vendor","object","legal_entity","material","material_type","confirm_history_operation"].includes(e)?"selector":["price","total","volume"].includes(e)?"input":["date_from","date_to"].includes(e)?"datepicker":void 0},setValue:function(){this.old_filters_block=Zc.a.cloneDeep(this.filters_block)},updateFilterMethod:async function(){let e=[];if(""===this.filter_name?e.push("label"):e=e.filter(e=>"label"!==e),this.filters_block.map(t=>{""===t.field||""===t.value||""===t.operation?e.push(t.id):e=e.filter(e=>e!==t.id)}),0===e.length){if(0!==this.filters_block.length){const e={...this.filters_block};for(let a in e)String(e[a]["field"]).startsWith("date_")&&(e[a]["value"]=Math.floor(new Date(e[a]["value"]).getTime()/1e3)),["price","total","volume"].includes(e[a]["field"])&&(e[a]["value"]=w(parseFloat(e[a]["value"].replace(",","."))));const t=await this.updateFilter({token:localStorage.getItem("crm_token"),name:this.filter_name,filters:JSON.stringify(e),id:this.data.id});t&&(this.dialogVisible=!1,this.filter_name="",this.filters_block=[{id:Math.random(),field:"",operation:"",value:"",position:"first",unity:"and"}],this.old_filters_block=[],this.filters_data={confirm_history_operation:[]})}}else Gc["a"].error("Пожалуйста, заполните все поля")}},mounted(){this.setValue(),this.filter_name=this.data.name;const e=JSON.parse(JSON.stringify(this.data.filters));for(let t in e)String(e[t]["field"]).startsWith("date_")&&(e[t]["value"]=String(new Date(1e3*e[t]["value"])));this.filters_block=e,this.filters_data={...this.filters_data,...this.filters_data_edit}},watch:{filters_block:{async handler(e){const t=this;let a=e.filter((function(e,a){return Object.keys(e).some((function(l){var o,i;return e[l]!==(null===(o=t.old_filters_block)||void 0===o||null===(i=o[a])||void 0===i?void 0:i[l])}))}))[0];"vendor"===(null===a||void 0===a?void 0:a.field)&&(this.label_filter="Выберите поставщика"),"object"===(null===a||void 0===a?void 0:a.field)&&(this.label_filter="Выберите объект"),"legal_entity"===(null===a||void 0===a?void 0:a.field)&&(this.label_filter="Выберите юридическое лицо"),"material"===(null===a||void 0===a?void 0:a.field)&&(this.label_filter="Выберите материал"),"material_type"===(null===a||void 0===a?void 0:a.field)&&(this.label_filter="Выберите тип материала"),"confirm_history_operation"===(null===a||void 0===a?void 0:a.field)&&0===this.filters_data.confirm_history_operation.length&&(this.filters_data.confirm_history_operation=this.confirmation_data,this.label_filter="Выберите подтверждение"),t.setValue()},deep:!0},data(e){this.filter_name=e.name;const t=JSON.parse(JSON.stringify(e.filters));for(let a in t)String(t[a]["field"]).startsWith("date_")&&(t[a]["value"]=String(new Date(1e3*t[a]["value"])));this.filters_block=t,this.filters_data={...this.filters_data,...this.filters_data_edit}}}};a("d254");const Os=T()(js,[["render",ps],["__scopeId","data-v-41865291"]]);var hs=Os;Ln.a.vfs=$n.a.pdfMake.vfs;var _s={components:{EditFilters:hs,Filters:es},data(){return{filters:[],filtered_data:[],current_filter:0,loading:!1,loadingFilters:!1,printObj:{id:"print_advanced_vendors",popTitle:"ABLE CRM"},filters_data:{vendor:[],object:[],legal_entity:[],material:[],material_type:[]},total_summary:{total:0,volume:0}}},methods:{...Object(I["b"])(["getFilters","getAdvancedReport","deleteFilter","getAllVendors","getAllObjects","getAllLegalEntities","getAllMaterials","getAllMaterialTypes"]),remove_filter:async function(e){await this.deleteFilter({token:localStorage.getItem("crm_token"),id:e}),this.current_filter===e&&(this.filtered_data=[],this.total_summary={total:0,volume:0})},get_filter:async function(e){this.loading=!0,this.current_filter=e;const t=this.filters.filter(t=>t.id===e)[0]["filters"],a=await this.getAdvancedReport({token:localStorage.getItem("crm_token"),filters:t});this.total_summary={total:0,volume:0},a?this.filtered_data=a:this.loading=!1,this.filtered_data.forEach(e=>{this.total_summary.total+=e.total,this.total_summary.volume+=e.volume}),this.loading=!1},get_filters:async function(){this.loadingFilters=!0,this.loading=!0,this.filters=await this.getFilters(localStorage.getItem("crm_token")),this.loading=!1,this.loadingFilters=!1},confirmed_data({row:e}){return 0===e.confirmed_data?"danger_docs":""},click_expand:function(e){const t=k(`//tr[contains(@class, "el-table__row")]//div[text() = "${e.id}"]/../..//div[@class="cell"]/div[contains(@class, "el-table__expand-icon")]`);let a=t.iterateNext();while(a)a.click(),a=t.iterateNext()},format_price:function(e){return y(e)},format_date:function(e){return N(e)},format_volume:function(e){return V(e)},word_decimal:function(e){return C(e)},createPDF(){let e=[];this.filtered_data.forEach(t=>{e.push([t.id,t.vendor.name,t.object.name,t.material.type,t.material.name,this.format_price(t.price),this.format_volume(t.volume),this.format_price(t.total),this.format_date(t.created_at),0===t.confirmed_data?"Данные не подтверждены":"Данные подтверждены",null===t.file.link?"Документ не загружен":t.file.link,t.comment])});const t={pageSize:"A4",pageOrientation:"landscape",defaultStyle:{fontSize:10},content:[{text:"Create by ABLE CRM"},{text:" "},{text:" "},{table:{headerRows:1,widths:["auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto","auto"],body:[["ID","Поставщик","Объект","Тип материала","Материал","Стоимость","Объем","Итого","Дата создания","Подтверждение","Документы","Комментарий"],...e]}},{text:" "},{text:"Сумарный объем: "+this.format_volume(this.total_summary.volume)},{text:" "},{text:"Сумарная стоимость: "+this.format_price(this.total_summary.total)}]};Ln.a.createPdf(t).download(this.get_pdf_name)}},async mounted(){await this.get_filters(),this.loadingFilters=!0;let e={},t=await this.getAllVendors({token:localStorage.getItem("crm_token")});e.vendor=t.vendors,t=await this.getAllObjects({token:localStorage.getItem("crm_token")}),e.object=t.objects,t=await this.getAllLegalEntities({token:localStorage.getItem("crm_token")}),e.legal_entity=t.legal_entities,t=await this.getAllMaterials({token:localStorage.getItem("crm_token")}),e.material=t.materials,t=await this.getAllMaterialTypes({token:localStorage.getItem("crm_token")}),e.material_type=t.types,this.filters_data=e,this.loadingFilters=!1},computed:{...Object(I["c"])(["getIsNewFilter"]),get_excel_name(){const e=(new Date).getTime()/1e3;return`Расширенная выгрузка от ${N(e)}.xls`},get_pdf_name(){const e=(new Date).getTime()/1e3;return`Расширенная выгрузка от ${N(e)}.pdf`},excel_fields(){return{ID:"id","Поставщик":"vendor","Объект":"object","Тип материала":"material_type","Материал":"material","Стоимость":"price","Объем":"volume","Итого":"total","Дата создания":"created_at","Подтверждение":"confirmed_data","Документы":"document","Комментарий":"comment"}},formated_date(){let e=[];return this.filtered_data.forEach(t=>{e.push({id:t.id,vendor:t.vendor.name,object:t.object.name,material_type:t.material.type,material:t.material.name,price:this.format_price(t.price),volume:this.format_volume(t.volume),total:this.format_price(t.total),created_at:this.format_date(t.created_at),confirmed_data:0===t.confirmed_data?"Данные не подтверждены":"Данные подтверждены",document:null===t.file.link?"Документ не загружен":t.file.link,comment:t.comment})}),e.push({}),e.push({}),e.push({id:"Сумарный объем: "+this.format_volume(this.total_summary.volume)}),e.push({}),e.push({id:"Сумарная стоимость: "+this.format_price(this.total_summary.total)}),e}},watch:{getIsNewFilter:function(){this.get_filters()}}};a("18e6");const gs=T()(_s,[["render",Mc],["__scopeId","data-v-488a3904"]]);var fs=gs,vs={components:{Advanced:fs,Base:Hn}};const ys=T()(vs,[["render",Vn]]);var Vs=ys,ws={props:{title:{type:String,require:!0}},components:{Main:oe,Reports:Vs},beforeMount(){document.title=this.title}};a("5289");const ks=T()(ws,[["render",yn],["__scopeId","data-v-7e04ba83"]]);var Cs=ks;const Ns=e=>e+" | Able CRM",xs=[{path:"/",name:"login",component:_e,props:{title:Ns("Авторизация")}},{path:"/dashboard",name:"dashboard",component:Ze,props:{title:Ns("Dashboard")}},{path:"/history",name:"history",component:gn,props:{title:Ns("История операций")}},{path:"/vendors",name:"vendors",component:St,props:{title:Ns("Поставщики")}},{path:"/objects",name:"objects",component:Bo,props:{title:Ns("Объекты")}},{path:"/payments",name:"payments",component:ra,props:{title:Ns("Оплата")}},{path:"/materials",name:"materials",component:Zl,props:{title:Ns("Материалы")}},{path:"/material_types",name:"material_types",component:ti,props:{title:Ns("Типы материалов")}},{path:"/legal_entities",name:"legal_entities",component:Ei,props:{title:Ns("Юридические лица")}},{path:"/reports",name:"reports",component:Cs,props:{title:Ns("Отчеты")}},{path:"/settings",name:"settings",component:Ja,props:{title:Ns("Настройки приложения")}},{path:"/user_settings",name:"user_settings",component:gl,props:{title:Ns("Настройки пользователя")}}],Bs=Object(be["a"])({history:Object(be["b"])(),routes:xs});var Ss=Bs;const Is=async e=>await h.a.get(`http://89.22.225.131:8020/api/users/get-info?token=${e}&user_id=${localStorage.getItem("user_id")}`).then(e=>{var t,a;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.data)&&(localStorage.setItem("user_data",JSON.stringify(null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.data)),!0)}).catch(e=>{var t;return v("Функционал пользователя",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1),Es=async e=>await h.a.put("http://89.22.225.131:8020/api/users/update-info",{id:e.id,login:e.login,email:e.email,token:e.token,password:e.password,user_id:Number(localStorage.getItem("user_id"))}).then(e=>{var t;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.data)&&(v("Функционал пользователя","Данные успешно обновленны","success"),!0)}).catch(e=>{var t;return v("Функционал пользователя",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1),Ms=async e=>await h.a.put("http://89.22.225.131:8020/api/users/change-password",{id:e.id,password:e.password,token:e.token,user_id:Number(localStorage.getItem("user_id"))}).then(e=>{var t;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.message)&&(v("Функционал пользователя",e.data.message,"success"),!0)}).catch(e=>{var t;return v("Функционал пользователя",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1),Ds=async e=>{const t=new g.a;return t.append("id",e.id),t.append("token",e.token),t.append("avatar",e.avatar),t.append("user_id",Number(localStorage.getItem("user_id"))),await h.a.post("http://89.22.225.131:8020/api/files/upload-avatar",t).then(async t=>{var a,l;return!(null===t||void 0===t||null===(a=t.data)||void 0===a||null===(l=a.data)||void 0===l||!l.avatar)&&(v("Функционал пользователя","Аватар успешно загружен","success"),await Is(e.token),!0)}).catch(e=>{var t;return v("Функционал пользователя",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1)},Ts=async e=>{var t,a;return await h.a.get(`http://89.22.225.131:8020/api/users/get-all?token=${e.token}&limit=${null!==(t=e.limit)&&void 0!==t?t:0}&offset=${null!==(a=e.offset)&&void 0!==a?a:0}&user_id=${localStorage.getItem("user_id")}`).then(e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data}).catch(e=>{var t;return v("Функционал пользователя",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1)},Us=async e=>{const t=new g.a;return t.append("token",e.token),t.append("login",e.login),t.append("email",e.email),t.append("password",e.password),t.append("user_id",Number(localStorage.getItem("user_id"))),await h.a.post("http://89.22.225.131:8020/api/users/create",t).then(e=>{var t;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.data)&&(v("Создание пользоваля","Пользователь успешно создан","success"),!0)}).catch(e=>{var t;return v("Создание пользоваля",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1)},Fs=async e=>await h.a.delete("http://89.22.225.131:8020/api/users/delete",{data:{token:e.token,id:e.id,user_id:Number(localStorage.getItem("user_id"))}}).then(e=>{var t,a;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.message)&&(v("Удаление пользователя",null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message,"success"),!0)}).catch(e=>{var t;return v("Удаление пользователя",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1);var As,Ls,qs={state:{isAuth:Boolean(localStorage.getItem("crm_token"))},mutations:{setIsAuth(e,t){e.isAuth=t}},actions:{setIsAuth({commit:e},t){e("setIsAuth",t)},async login({dispatch:e},t){const a=await B({login:t.login,password:t.password});var l,o;return!!a&&(await Is(localStorage.getItem("crm_token")),e("setLogin",null===(l=JSON.parse(localStorage.getItem("user_data")))||void 0===l?void 0:l.login),e("setIsAuth",!0),e("setAvatar","http://89.22.225.131:8020"+(null===(o=JSON.parse(localStorage.getItem("user_data")))||void 0===o?void 0:o.avatar)),!0)}},getters:{getIsAuth:e=>e.isAuth}},$s={state:{indexMenu:"1",activeSettings:Boolean("0"===localStorage.getItem("currentMenu")),activeUserSettings:Boolean("999"===localStorage.getItem("currentMenu"))},mutations:{setIndexMenu(e,t){e.indexMenu=t},setActiveSettings(e,t){e.activeSettings=t},setActiveUserSettings(e,t){e.activeUserSettings=t}},actions:{setIndexMenu({commit:e},t){e("setIndexMenu",t)},setActiveSettings({commit:e},t){e("setActiveSettings",t)},setActiveUserSettings({commit:e},t){e("setActiveUserSettings",t)}},getters:{getIndexMenu:e=>e.indexMenu,getActiveSettings:e=>e.activeSettings,getActiveUserSettings:e=>e.activeUserSettings}},zs={state:{login:null!==(As=null===(Ls=JSON.parse(localStorage.getItem("user_data")))||void 0===Ls?void 0:Ls.login)&&void 0!==As?As:"user",isCreateUser:0},mutations:{setLogin(e,t){e.login=t},setIsCreateUser(e,t){e.isCreateUser=t}},actions:{setLogin({commit:e},t){e("setLogin",t)},setIsCreateUser({commit:e},t){e("setIsCreateUser",t)},async update_info({dispatch:e},t){const a=await Es({login:t.login,email:t.email,id:t.id,token:t.token,password:t.password});var l;return!!a&&(await Is(localStorage.getItem("crm_token")),e("setLogin",null===(l=JSON.parse(localStorage.getItem("user_data")))||void 0===l?void 0:l.login),!0)},async change_password({},e){const t=await Ms({password:e.password,id:e.id,token:e.token});return!!t},async get_all({},e){return await Ts(e)},async create({dispatch:e},t){const a=await Us({token:t.token,login:t.login,email:t.email,password:t.password});return!!a&&(e("setIsCreateUser",Math.random()),!0)},async delete({dispatch:e},t){const a=await Fs({token:t.token,id:t.id});return!!a&&(e("setIsCreateUser",Math.random()),!0)}},getters:{getLogin:e=>e.login,getIsCreateUser:e=>e.isCreateUser}};const Ps=async e=>await h.a.get(`http://89.22.225.131:8020/api/time/get-timezones?token=${e}&user_id=${localStorage.getItem("user_id")}`).then(e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data}).catch(e=>(console.error(e),!1)).finally(()=>!1),Hs=async e=>await h.a.get(`http://89.22.225.131:8020/api/time/get-timezone?token=${e.token}&timezone_name=${e.timezone_name}&user_id=${localStorage.getItem("user_id")}`).then(e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data}).catch(e=>(console.error(e),!1)).finally(()=>!1),Rs=async e=>{const t=new g.a;return t.append("token",e.token),t.append("timezone_id",e.timezone_id),t.append("user_id",Number(localStorage.getItem("user_id"))),await h.a.post("http://89.22.225.131:8020/api/time/set-timezone",t).then(e=>{var t,a;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.message)&&(v("Настройка времени",null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message,"success"),!0)}).catch(e=>{var t;return v("Настройка времени",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1)};var Js,Ys,Ws={state:{timezone:null===(Js=JSON.parse(localStorage.getItem("user_data")))||void 0===Js?void 0:Js.timezone},mutations:{setTimezone(e,t){e.timezone=t}},actions:{setTimezone({commit:e},t){e("setTimezone",t)},async getTimezones({},e){return await Ps(e)},async setUserTimezone({dispatch:e},t){const a=await Rs(t);var l;a&&(await Is(localStorage.getItem("crm_token")),e("setTimezone",null===(l=JSON.parse(localStorage.getItem("user_data")))||void 0===l?void 0:l.timezone))},async getTimezone({},e){return await Hs(e)}},getters:{getTimezone:e=>e.isAuth}},Ks={state:{avatar:"http://89.22.225.131:8020"+(null===(Ys=JSON.parse(localStorage.getItem("user_data")))||void 0===Ys?void 0:Ys.avatar)||null},mutations:{setAvatar(e,t){e.avatar=t}},actions:{setAvatar({commit:e},t){e("setAvatar",t)},async upload_avatar({dispatch:e},t){const a=await Ds({avatar:t.avatar,id:t.id,token:t.token});var l;return!!a&&(e("setAvatar","http://89.22.225.131:8020"+(null===(l=JSON.parse(localStorage.getItem("user_data")))||void 0===l?void 0:l.avatar)),!0)}},getters:{getAvatar:e=>e.avatar}};const Zs=async e=>{var t,a;return await h.a.get(`http://89.22.225.131:8020/api/material-types/get-all?token=${e.token}&limit=${null!==(t=e.limit)&&void 0!==t?t:0}&offset=${null!==(a=e.offset)&&void 0!==a?a:0}&user_id=${localStorage.getItem("user_id")}`).then(e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data}).catch(e=>(console.error(e),!1)).finally(()=>!1)},Gs=async e=>{const t=new g.a;return t.append("token",e.token),t.append("name",e.name),t.append("units_measurement_volume_id",e.units_measurement_volume_id),t.append("user_id",Number(localStorage.getItem("user_id"))),await h.a.post("http://89.22.225.131:8020/api/material-types/create",t).then(e=>{var t,a;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.message)&&(v("Тип материала",null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message,"success"),!0)}).catch(e=>{var t;return v("Тип материала",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1)},Xs=async e=>await h.a.put("http://89.22.225.131:8020/api/material-types/update",{id:e.id,name:e.name,token:e.token,units_measurement_volume_id:e.units_measurement_volume_id,user_id:Number(localStorage.getItem("user_id"))}).then(e=>{var t;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.data)&&(v("Тип материала","Тип материала успешно обновлен","success"),!0)}).catch(e=>{var t;return v("Тип материала",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1);var Qs={state:{isNewMaterialType:0},mutations:{setIsNewMaterialType(e,t){e.isNewMaterialType=t}},actions:{setIsNewMaterialType({commit:e},t){e("setIsNewMaterialType",t)},async getAllMaterialTypes({},e){return await Zs(e)},async saveMaterialType({dispatch:e},t){const a=await Gs(t);return!!a&&(e("setIsNewMaterialType",Math.random()),a)},async updateMaterialType({dispatch:e},t){const a=await Xs(t);return!!a&&(e("setIsNewMaterialType",Math.random()),a)}},getters:{getIsNewMaterialType(e){return e.isNewMaterialType}}};const ed=async e=>{var t,a;return await h.a.get(`http://89.22.225.131:8020/api/materials/get-all?token=${e.token}&limit=${null!==(t=e.limit)&&void 0!==t?t:0}&offset=${null!==(a=e.offset)&&void 0!==a?a:0}&user_id=${localStorage.getItem("user_id")}`).then(e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data}).catch(e=>(console.error(e),!1)).finally(()=>!1)},td=async e=>{const t=new g.a;return t.append("token",e.token),t.append("name",e.name),t.append("type_id",e.type_id),t.append("user_id",Number(localStorage.getItem("user_id"))),await h.a.post("http://89.22.225.131:8020/api/materials/create",t).then(e=>{var t,a;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.message)&&(v("Материал",null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message,"success"),!0)}).catch(e=>{var t;return v("Материал",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1)},ad=async e=>await h.a.put("http://89.22.225.131:8020/api/materials/update",{id:e.id,name:e.name,token:e.token,type_id:e.type_id,user_id:localStorage.getItem("user_id")}).then(e=>{var t;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.data)&&(v("Материал","Материал успешно обновлен","success"),!0)}).catch(e=>{var t;return v("Материал",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1),ld=async e=>await h.a.get(`http://89.22.225.131:8020/api/materials/search?token=${e.token}&query=${e.query}&user_id=${localStorage.getItem("user_id")}`).then(e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data}).catch(e=>{var t;return v("Материал",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1);var od={state:{isNewMaterial:0,isSearchMaterial:0,search_word:""},mutations:{setIsNewMaterial(e,t){e.isNewMaterial=t},setIsSearchMaterial(e,t){e.isSearchMaterial=t},setSearchWordMaterial(e,t){e.search_word=t}},actions:{setIsNewMaterial({commit:e},t){e("setIsNewMaterial",t)},setIsSearchMaterial({commit:e},t){e("setIsSearchMaterial",t)},setSearchWordMaterial({commit:e},t){e("setSearchWordMaterial",t)},async getAllMaterials({},e){return await ed(e)},async searchMaterial({},e){return await ld(e)},async saveMaterial({dispatch:e},t){const a=await td(t);return!!a&&(e("setIsNewMaterial",Math.random()),a)},async updateMaterial({dispatch:e},t){const a=await ad(t);return!!a&&(e("setIsNewMaterial",Math.random()),a)}},getters:{getIsNewMaterial(e){return e.isNewMaterial},getIsSearchMaterial(e){return e.isSearchMaterial},getSearchWordMaterial(e){return e.search_word}}};const id=async e=>await h.a.get(`http://89.22.225.131:8020/api/legal-entities-types/get-all?token=${e}&user_id=${localStorage.getItem("user_id")}`).then(e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data}).catch(e=>(console.error(e),!1)).finally(()=>!1);var rd={actions:{async getAllLegalEntitiesTypes({},e){return await id(e)}}};const nd=async e=>{var t,a,l;return await h.a.get(`http://89.22.225.131:8020/api/legal-entities/get-all?token=${e.token}&limit=${null!==(t=e.limit)&&void 0!==t?t:0}&offset=${null!==(a=e.offset)&&void 0!==a?a:0}&archive=${null!==(l=e.archive)&&void 0!==l?l:0}&user_id=${localStorage.getItem("user_id")}`).then(e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data}).catch(e=>(console.error(e),!1)).finally(()=>!1)},cd=async e=>{const t=new g.a;return t.append("token",e.token),t.append("name",e.name),t.append("legal_entities_type_id",e.legal_entities_type_id),t.append("user_id",Number(localStorage.getItem("user_id"))),await h.a.post("http://89.22.225.131:8020/api/legal-entities/create",t).then(e=>{var t,a;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.message)&&(v("Юридические лица",null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message,"success"),!0)}).catch(e=>{var t;return v("Юридические лица",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1)},sd=async e=>await h.a.put("http://89.22.225.131:8020/api/legal-entities/update",{id:e.id,name:e.name,token:e.token,legal_entities_type_id:e.legal_entities_type_id,user_id:Number(localStorage.getItem("user_id"))}).then(e=>{var t;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.data)&&(v("Юридические лица","Организация успешно обновлена","success"),!0)}).catch(e=>{var t;return v("Юридические лица",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1),dd=async e=>await h.a.delete("http://89.22.225.131:8020/api/legal-entities/delete",{data:{token:e.token,id:e.id,user_id:Number(localStorage.getItem("user_id"))}}).then(e=>{var t,a;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.message)&&(v("Юридические лица",null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message,"success"),!0)}).catch(e=>{var t;return v("Юридические лица",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1),bd=async e=>await h.a.put("http://89.22.225.131:8020/api/legal-entities/restore",{token:e.token,id:e.id,user_id:Number(localStorage.getItem("user_id"))}).then(e=>{var t,a;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.message)&&(v("Юридические лица",null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message,"success"),!0)}).catch(e=>{var t;return v("Юридические лица",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1);var ud={state:{isLegalEntities:0},mutations:{setIsLegalEntities(e,t){e.isLegalEntities=t}},actions:{async getAllLegalEntities({},e){return await nd(e)},setIsLegalEntities({commit:e},t){e("setIsLegalEntities",t)},async saveLegalEntities({dispatch:e},t){const a=await cd(t);return!!a&&(e("setIsLegalEntities",Math.random()),a)},async updateLegalEntities({dispatch:e},t){const a=await sd(t);return!!a&&(e("setIsLegalEntities",Math.random()),a)},async deleteLegalEntity({dispatch:e},t){const a=await dd({token:t.token,id:t.id});return!!a&&(e("setIsLegalEntities",Math.random()),!0)},async restoreLegalEntity({dispatch:e},t){const a=await bd({token:t.token,id:t.id});return!!a&&(e("setIsLegalEntities",Math.random()),!0)}},getters:{getIsLegalEntities(e){return e.isLegalEntities}}};const md=async e=>{var t;return await h.a.get(`http://89.22.225.131:8020/api/icons/get-all?token=${e.token}&limit=48&offset=${null!==(t=e.offset)&&void 0!==t?t:0}&user_id=${localStorage.getItem("user_id")}`).then(e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data}).catch(e=>(console.error(e),!1)).finally(()=>!1)};var pd={state:{icon:{id:0,prefix:"",name:""}},mutations:{setIcon(e,t){e.icon={id:t.id,prefix:t.prefix,name:t.name}}},actions:{setIcon({commit:e},t){e("setIcon",t)},async getAllIcons({},e){return await md(e)}},getters:{getIcon(e){return e.icon}}};const jd=async e=>{var t,a,l;return await h.a.get(`http://89.22.225.131:8020/api/vendors/get-all?token=${e.token}&limit=${null!==(t=e.limit)&&void 0!==t?t:0}&offset=${null!==(a=e.offset)&&void 0!==a?a:0}&archive=${null!==(l=e.archive)&&void 0!==l?l:0}&user_id=${localStorage.getItem("user_id")}`).then(e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data}).catch(e=>(console.error(e),!1)).finally(()=>!1)},Od=async e=>{const t=new g.a;return t.append("token",e.token),t.append("name",e.name),t.append("icon_id",e.icon_id),t.append("user_id",Number(localStorage.getItem("user_id"))),await h.a.post("http://89.22.225.131:8020/api/vendors/create",t).then(e=>{var t,a;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.message)&&(v("Поставщики",null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message,"success"),!0)}).catch(e=>{var t;return v("Поставщики",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1)},hd=async e=>await h.a.put("http://89.22.225.131:8020/api/vendors/update",{id:e.id,name:e.name,token:e.token,icon_id:e.icon_id,user_id:Number(localStorage.getItem("user_id"))}).then(e=>{var t;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.data)&&(v("Поставщики","Поставщик успешно обновлен","success"),!0)}).catch(e=>{var t;return v("Поставщики",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1),_d=async e=>await h.a.delete("http://89.22.225.131:8020/api/vendors/delete",{data:{token:e.token,id:e.id,user_id:Number(localStorage.getItem("user_id"))}}).then(e=>{var t,a;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.message)&&(v("Постащики",null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message,"success"),!0)}).catch(e=>{var t;return v("Постащики",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1),gd=async e=>await h.a.put("http://89.22.225.131:8020/api/vendors/restore",{token:e.token,id:e.id,user_id:Number(localStorage.getItem("user_id"))}).then(e=>{var t,a;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.message)&&(v("Постащики",null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message,"success"),!0)}).catch(e=>{var t;return v("Постащики",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1);var fd={state:{isNewVendor:0},mutations:{setIsNewVendor(e,t){e.isNewVendor=t}},actions:{setIsNewVendor({commit:e},t){e("setIsNewVendor",t)},async getAllVendors({},e){return await jd(e)},async saveVendor({dispatch:e},t){const a=await Od(t);return!!a&&(e("setIsNewVendor",Math.random()),a)},async updateVendor({dispatch:e},t){const a=await hd(t);return!!a&&(e("setIsNewVendor",Math.random()),a)},async deleteVendor({dispatch:e},t){const a=await _d({token:t.token,id:t.id});return!!a&&(e("setIsNewVendor",Math.random()),!0)},async restoreVendor({dispatch:e},t){const a=await gd({token:t.token,id:t.id});return!!a&&(e("setIsNewVendor",Math.random()),!0)}},getters:{getIsNewVendor(e){return e.isNewVendor}}};const vd=async e=>{var t,a,l;return await h.a.get(`http://89.22.225.131:8020/api/objects/get-all?token=${e.token}&limit=${null!==(t=e.limit)&&void 0!==t?t:0}&offset=${null!==(a=e.offset)&&void 0!==a?a:0}&archive=${null!==(l=e.archive)&&void 0!==l?l:0}&user_id=${localStorage.getItem("user_id")}`).then(e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data}).catch(e=>(console.error(e),!1)).finally(()=>!1)},yd=async e=>{const t=new g.a;return t.append("token",e.token),t.append("name",e.name),t.append("user_id",Number(localStorage.getItem("user_id"))),await h.a.post("http://89.22.225.131:8020/api/objects/create",t).then(e=>{var t,a;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.message)&&(v("Объекты",null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message,"success"),!0)}).catch(e=>{var t;return v("Объекты",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1)},Vd=async e=>await h.a.put("http://89.22.225.131:8020/api/objects/update",{id:e.id,name:e.name,token:e.token,user_id:Number(localStorage.getItem("user_id"))}).then(e=>{var t;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.data)&&(v("Объекты","Объект успешно обновлен","success"),!0)}).catch(e=>{var t;return v("Объекты",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1),wd=async e=>await h.a.delete("http://89.22.225.131:8020/api/objects/delete",{data:{token:e.token,id:e.id,user_id:Number(localStorage.getItem("user_id"))}}).then(e=>{var t,a;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.message)&&(v("Объекты",null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message,"success"),!0)}).catch(e=>{var t;return v("Объекты",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1),kd=async e=>await h.a.put("http://89.22.225.131:8020/api/objects/restore",{token:e.token,id:e.id,user_id:Number(localStorage.getItem("user_id"))}).then(e=>{var t,a;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.message)&&(v("Объекты",null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message,"success"),!0)}).catch(e=>{var t;return v("Объекты",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1),Cd=async e=>await h.a.get(`http://89.22.225.131:8020/api/objects/search?token=${e.token}&query=${e.query}&user_id=${localStorage.getItem("user_id")}`).then(e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data}).catch(e=>{var t;return v("Объекты",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1);var Nd={state:{isNewObject:0,isSearchObject:0,search_word:""},mutations:{setIsNewObject(e,t){e.isNewObject=t},setIsSearchObject(e,t){e.isSearchObject=t},setSearchWordObject(e,t){e.search_word=t}},actions:{setIsNewObject({commit:e},t){e("setIsNewObject",t)},setIsSearchObject({commit:e},t){e("setIsSearchObject",t)},setSearchWordObject({commit:e},t){e("setSearchWordObject",t)},async getAllObjects({},e){return await vd(e)},async searchObject({},e){return await Cd(e)},async saveObject({dispatch:e},t){const a=await yd(t);return!!a&&(e("setIsNewObject",Math.random()),a)},async updateObject({dispatch:e},t){const a=await Vd(t);return!!a&&(e("setIsNewObject",Math.random()),a)},async deleteObject({dispatch:e},t){const a=await wd({token:t.token,id:t.id});return!!a&&(e("setIsNewObject",Math.random()),!0)},async restoreObject({dispatch:e},t){const a=await kd({token:t.token,id:t.id});return!!a&&(e("setIsNewObject",Math.random()),!0)}},getters:{getIsNewObject(e){return e.isNewObject},getIsSearchObject(e){return e.isSearchObject},getSearchWordObject(e){return e.search_word}}};const xd=async e=>{let t={};for(let a in e.offset)t[a]=e.offset[a];return await h.a.get(`http://89.22.225.131:8020/api/payments/get-all?token=${e.token}&limit=10&offset=${JSON.stringify(t)}&user_id=${localStorage.getItem("user_id")}`).then(e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data}).catch(e=>(console.error(e),!1)).finally(()=>!1)},Bd=async e=>{const t=new g.a;return t.append("token",e.token),t.append("vendor_id",e.vendor_id),t.append("legal_entity_id",e.legal_entity_id),t.append("material_type_id",e.material_type_id),t.append("amount",e.amount),t.append("created_at",e.created_at),t.append("operation_type",e.operation_type),t.append("user_id",localStorage.getItem("user_id")),await h.a.post("http://89.22.225.131:8020/api/payments/create",t).then(e=>{var t,a;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.message)&&(v("Платеж",null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message,"success"),!0)}).catch(e=>{var t;return v("Платеж",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1)},Sd=async e=>await h.a.put("http://89.22.225.131:8020/api/payments/update",{id:e.id,vendor_id:e.vendor_id,token:e.token,legal_entity_id:e.legal_entity_id,material_type_id:e.material_type_id,amount:e.amount,operation_type:e.operation_type,created_at:e.created_at,user_id:localStorage.getItem("user_id")}).then(e=>{var t;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.data)&&(v("Платеж","Платеж успешно обновлен","success"),!0)}).catch(e=>{var t;return v("Платеж",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1),Id=async e=>await h.a.delete("http://89.22.225.131:8020/api/payments/delete",{data:{token:e.token,id:e.id,user_id:localStorage.getItem("user_id")}}).then(e=>{var t,a;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.message)&&(v("Платеж",null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message,"success"),!0)}).catch(e=>{var t;return v("Платеж",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1);var Ed={state:{isNewPayments:0,legalEntityId:""},mutations:{setIsNewPayment(e,t){e.isNewPayments=t},setLegalEntityId(e,t){e.legalEntityId=t}},actions:{setIsNewPayment({commit:e},t){e("setIsNewPayment",t)},setLegalEntityId({commit:e},t){e("setLegalEntityId",t)},async getAllPayments({},e){return await xd(e)},async savePayment({dispatch:e},t){const a=await Bd(t);return!!a&&(e("setIsNewPayment",Math.random()),a)},async updatePayment({dispatch:e},t){const a=await Sd(t);return!!a&&(e("setIsNewPayment",Math.random()),a)},async deletePayment({dispatch:e},t){const a=await Id({token:t.token,id:t.id});return!!a&&(e("setIsNewPayment",Math.random()),!0)}},getters:{getIsNewPayment(e){return e.isNewPayments},getLegalEntityId(e){return e.legalEntityId}}};const Md=async e=>{var t;return await h.a.get(`http://89.22.225.131:8020/api/history-operation/get-all-operations-by-material?token=${e.token}&vendor_id=${e.vendor_id}&object_id=${e.object_id}&material_id=${e.material_id}&limit=5&offset=${null!==(t=e.offset)&&void 0!==t?t:0}&user_id=${localStorage.getItem("user_id")}`).then(e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data}).catch(e=>(console.error(e),!1)).finally(()=>!1)},Dd=async e=>await h.a.get(`http://89.22.225.131:8020/api/history-operation/get-objects-by-vendor?token=${e.token}&vendor_id=${e.vendor_id}&user_id=${localStorage.getItem("user_id")}`).then(e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data}).catch(e=>(console.error(e),!1)).finally(()=>!1),Td=async e=>await h.a.get(`http://89.22.225.131:8020/api/history-operation/get-material-by-object?token=${e.token}&vendor_id=${e.vendor_id}&object_id=${e.object_id}&user_id=${localStorage.getItem("user_id")}`).then(e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data}).catch(e=>(console.error(e),!1)).finally(()=>!1),Ud=async e=>{const t=new g.a;return t.append("token",e.token),t.append("user_id",Number(localStorage.getItem("user_id"))),t.append("vendor_id",e.vendor_id),t.append("material_id",e.material_id),t.append("legal_entity_id",e.legal_entity_id),t.append("object_id",e.object_id),t.append("volume",e.volume),t.append("price",e.price),t.append("total",e.total),t.append("comment",e.comment),t.append("created_at",e.created_at),t.append("is_debt",e.is_debt),t.append("confirmed_data",e.confirmed_data),t.append("file",e.file),await h.a.post("http://89.22.225.131:8020/api/history-operation/create",t).then(e=>{var t,a;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.message)&&(v("История операций",null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message,"success"),!0)}).catch(e=>{var t;return v("История операций",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1)},Fd=async e=>{const t=new g.a;return t.append("token",e.token),t.append("user_id",Number(localStorage.getItem("user_id"))),t.append("vendor_id",e.vendor_id),t.append("material_id",e.material_id),t.append("legal_entity_id",e.legal_entity_id),t.append("object_id",e.object_id),t.append("volume",e.volume),t.append("price",e.price),t.append("total",e.total),t.append("comment",e.comment),t.append("created_at",e.created_at),t.append("confirmed_data",e.confirmed_data),e.file&&t.append("file",e.file),t.append("id",e.id),await h.a.post("http://89.22.225.131:8020/api/history-operation/update",t).then(e=>{var t;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.message)&&(v("История операций","Операция успешно обновлена","success"),!0)}).catch(e=>{var t;return v("История операций",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1)},Ad=async e=>await h.a.delete("http://89.22.225.131:8020/api/history-operation/delete",{data:{token:e.token,id:e.id,user_id:Number(localStorage.getItem("user_id"))}}).then(e=>{var t,a;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.message)&&(v("История операций",null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message,"success"),!0)}).catch(e=>{var t;return v("История операций",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1);var Ld={state:{isNewHistoryOperation:0},mutations:{setIsNewHistoryOperation(e,t){e.isNewHistoryOperation=t}},actions:{async getAllHistoryOperation({},e){return await Md(e)},async getAllObjectsByVendorHistoryOperation({},e){return await Dd(e)},async getAllMaterialsByObjectsHistoryOperation({},e){return await Td(e)},setIsNewHistoryOperation({commit:e},t){e("setIsNewHistoryOperation",t)},async saveHistoryOperation({dispatch:e},t){const a=await Ud(t);return!!a&&(e("setIsNewHistoryOperation",Math.random()),a)},async updateHistoryOperation({dispatch:e},t){const a=await Fd(t);return!!a&&(e("setIsNewHistoryOperation",Math.random()),a)},async deleteHistoryOperation({dispatch:e},t){const a=await Ad({token:t.token,id:t.id});return!!a&&(e("setIsNewHistoryOperation",Math.random()),!0)}},getters:{getIsNewHistoryOperation(e){return e.isNewHistoryOperation}}};const qd=async e=>await h.a.get(`http://89.22.225.131:8020/api/units-measurement-volume/get-all?token=${e}&user_id=${localStorage.getItem("user_id")}`).then(e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data}).catch(e=>(console.error(e),!1)).finally(()=>!1);var $d={actions:{async getAllUnitsMeasurementVolume({},e){return await qd(e)}}};const zd=async e=>await h.a.get(`http://89.22.225.131:8020/api/settings/get-debt?token=${e.token}&user_id=${localStorage.getItem("user_id")}`).then(e=>{var t,a;return null===e||void 0===e||null===(t=e.data)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.debt}).catch(e=>(console.error(e),!1)).finally(()=>!1),Pd=async e=>{const t=new g.a;return t.append("token",e.token),t.append("active",e.active),t.append("user_id",Number(localStorage.getItem("user_id"))),await h.a.post("http://89.22.225.131:8020/api/settings/set-debt",t).then(e=>{var t,a;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.message)&&(v("Тип материала",null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message,"success"),!0)}).catch(e=>{var t;return v("Тип материала",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1)};var Hd={actions:{async getDebt({},e){return await zd(e)},async saveDebt({},e){const t=await Pd(e);return t||!1}}};const Rd=async e=>await h.a.get(`http://89.22.225.131:8020/api/dashboard/get-data?token=${e.token}&user_id=${localStorage.getItem("user_id")}&period=${e.period}&date_from=${e.date_from}&date_to=${e.date_to}`).then(e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data}).catch(e=>(console.error(e),!1)).finally(()=>!1);var Jd={state:{period:"30",isUpdated:0,isUpdatedDate:0,date_from:0,date_to:Math.floor((new Date).getTime()/1e3)},mutations:{setPeriod(e,t){e.period=t},setIsUpdated(e,t){e.isUpdated=t},setIsUpdatedDate(e,t){e.isUpdatedDate=t},setDateFrom(e,t){e.date_from=t},setDateTo(e,t){e.date_to=t}},actions:{setPeriod({commit:e},t){e("setPeriod",t)},setIsUpdated({commit:e},t){e("setIsUpdated",t)},setIsUpdatedDate({commit:e},t){e("setIsUpdatedDate",t)},setDateFrom({commit:e},t){e("setDateFrom",t)},setDateTo({commit:e},t){e("setDateTo",t)},async getDataDashboard({},e){return await Rd(e)}},getters:{getPeriod:e=>e.period,getIsUpdated:e=>e.isUpdated,getIsUpdatedDate:e=>e.isUpdatedDate,getDateFrom:e=>e.date_from,getDateTo:e=>e.date_to}};const Yd=async e=>await h.a.get(`http://89.22.225.131:8020/api/report/get-base?token=${e}&user_id=${localStorage.getItem("user_id")}`).then(e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data}).catch(e=>(console.error(e),!1)).finally(()=>!1),Wd=async e=>{const t=new g.a;return t.append("token",e.token),t.append("user_id",Number(localStorage.getItem("user_id"))),t.append("filters",JSON.stringify(e.filters)),await h.a.post("http://89.22.225.131:8020/api/report/get-advanced",t).then(e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data}).catch(e=>{var t;return v("Расширенный отчет",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1)},Kd=async e=>{const t=new g.a;return t.append("token",e.token),t.append("user_id",Number(localStorage.getItem("user_id"))),t.append("name",e.name),t.append("filters",JSON.stringify(e.filters)),await h.a.post("http://89.22.225.131:8020/api/report/create-filter",t).then(e=>{var t,a;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.message)&&(v("Расширенный отчет",null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message,"success"),!0)}).catch(e=>{var t;return v("Расширенный отчет",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1)},Zd=async e=>await h.a.get(`http://89.22.225.131:8020/api/report/get-filters?token=${e}&user_id=${localStorage.getItem("user_id")}`).then(e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data}).catch(e=>(console.error(e),!1)).finally(()=>!1),Gd=async e=>await h.a.delete("http://89.22.225.131:8020/api/report/delete-filter",{data:{token:e.token,id:e.id,user_id:Number(localStorage.getItem("user_id"))}}).then(e=>{var t,a;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.message)&&(v("Расширенный отчет",null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message,"success"),!0)}).catch(e=>{var t;return v("Расширенный отчет",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1),Xd=async e=>await h.a.put("http://89.22.225.131:8020/api/report/update-filter",{token:e.token,user_id:Number(localStorage.getItem("user_id")),name:e.name,filters:e.filters,id:e.id}).then(e=>{var t,a;return!(null===e||void 0===e||null===(t=e.data)||void 0===t||!t.message)&&(v("Расширенный отчет",null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message,"success"),!0)}).catch(e=>{var t;return v("Расширенный отчет",null===(t=e.response.data)||void 0===t?void 0:t.message,"error"),console.error(e),!1}).finally(()=>!1);var Qd={state:{isNewFilter:0},mutations:{setIsNewFilter(e,t){e.isNewFilter=t}},actions:{setIsNewFilter({commit:e},t){e("setIsNewFilter",t)},async getBaseReport({},e){return await Yd(e)},async getAdvancedReport({},e){return await Wd(e)},async saveFilter({dispatch:e},t){const a=await Kd(t);return!!a&&(e("setIsNewFilter",Math.random()),a)},async getFilters({},e){return await Zd(e)},async deleteFilter({dispatch:e},t){const a=await Gd({token:t.token,id:t.id});return!!a&&(e("setIsNewFilter",Math.random()),!0)},async updateFilter({dispatch:e},t){const a=await Xd(t);return!!a&&(e("setIsNewFilter",Math.random()),a)}},getters:{getIsNewFilter(e){return e.isNewFilter}}},eb=Object(I["a"])({modules:{auth:qs,menu:$s,users:zs,time:Ws,files:Ks,material_types:Qs,materials:od,legal_entities_types:rd,legal_entities:ud,icons:pd,vendors:fd,objects:Nd,payments:Ed,history_operation:Ld,units_measurement_volume:$d,settings:Hd,dashboard:Jd,report:Qd}}),tb=a("1250"),ab=(a("7437"),a("ecee")),lb=a("c074"),ob=a("f2d1"),ib=a("b702"),rb=a("ad3d"),nb=a("d2f8"),cb=a("bf15"),sb=a("1c95");ab["c"].add(lb["a"],ob["a"],ib["a"]),Object(l["createApp"])(de).use(Ss).use(eb).use(tb["a"],{locale:nb["a"]}).use(cb["a"]).use(sb["a"]).component("font-awesome-icon",rb["a"]).mount("#app")},"5a07":function(e,t,a){},"5bc4":function(e,t,a){"use strict";a("116e")},"61d2":function(e,t,a){},"65da":function(e,t,a){},7231:function(e,t,a){"use strict";a("e50b")},7637:function(e,t,a){"use strict";a("0465")},7907:function(e,t,a){"use strict";a("a0b4")},7969:function(e,t,a){"use strict";a("2da7")},"79a7":function(e,t,a){"use strict";a("d5a2")},"79ee":function(e,t,a){},"7b59":function(e,t,a){"use strict";a("19d8")},"7d0f":function(e,t,a){"use strict";a("ce32")},"7ff6":function(e,t,a){},8192:function(e,t,a){},8513:function(e,t,a){"use strict";a("0896")},8831:function(e,t,a){},"89f6":function(e,t,a){"use strict";a("db5a")},"8eb2":function(e,t,a){},"8fbb":function(e,t,a){},"90a0":function(e,t,a){"use strict";a("8fbb")},"90b4":function(e,t,a){},"914b":function(e,t,a){},"92d8":function(e,t,a){"use strict";a("0349")},"9a70":function(e,t,a){},a0b4:function(e,t,a){},ab11:function(e,t,a){},ac53:function(e,t,a){"use strict";a("61d2")},aea9:function(e,t,a){},af31:function(e,t,a){},b633:function(e,t,a){},b81e:function(e,t,a){"use strict";a("8831")},bda2:function(e,t,a){},bdb4:function(e,t,a){},c424:function(e,t,a){},c461:function(e,t,a){"use strict";a("af31")},c47c:function(e,t,a){},c5a0:function(e,t,a){},c7e0:function(e,t,a){"use strict";a("46a3")},c946:function(e,t,a){"use strict";a("ffbc")},ce32:function(e,t,a){},cee9:function(e,t,a){"use strict";a("c424")},d14b:function(e,t,a){"use strict";a("8eb2")},d24c:function(e,t,a){"use strict";a("90b4")},d254:function(e,t,a){"use strict";a("79ee")},d3b0:function(e,t,a){"use strict";a("1333")},d407:function(e,t,a){},d5a2:function(e,t,a){},db5a:function(e,t,a){},e50b:function(e,t,a){},eaf3:function(e,t,a){"use strict";a("204a")},eb71:function(e,t,a){"use strict";a("3a71")},edd1:function(e,t,a){"use strict";a("5a07")},efca:function(e,t,a){},f1f4:function(e,t,a){},f73f:function(e,t,a){"use strict";a("aea9")},fa01:function(e,t,a){"use strict";a("9a70")},fd0e:function(e,t,a){},ffbc:function(e,t,a){}});
//# sourceMappingURL=app.22c1d337.js.map